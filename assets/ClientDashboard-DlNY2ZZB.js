import{r as p,j as e}from"./react-FJB7Hj_2.js";import{g as B,a as D}from"./firebase-CiybzbB3.js";import{y as H,z as M,D as P,G as R,H as $,B as q}from"./@firebase-D5dUFubL.js";import{d as k}from"./index-C1w-7Ivh.js";import{L as E}from"./react-router-dom-udQfSOCw.js";import{a as V}from"./react-router-DF4cN2Hx.js";import{m as d}from"./framer-motion-Bo7GrDk8.js";import{e as O,v as U,H as F,y as w,w as G,I as J,a as _,J as K}from"./lucide-react-BYK_Rxhn.js";import"./papaparse-BHXrM2Hc.js";import"./tslib-BGVaTf34.js";import"./idb-BXWtuYvb.js";import"./react-dom-BrtcLnxQ.js";import"./scheduler-DYLXRpC5.js";import"./@remix-run-CjG9tKj3.js";import"./motion-dom-C8PdgYBP.js";import"./motion-utils-DBsP9okC.js";const Q=()=>e.jsx("div",{className:"min-h-screen flex justify-center items-center relative",children:e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-cyan-400"})}),j=({title:t,value:r,subtext:o,icon:c,variants:l})=>e.jsxs(d.div,{variants:l,className:"bg-zinc-950/60 backdrop-blur-xl rounded-2xl gradient-border p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-300",children:t}),e.jsx("div",{className:"text-cyan-300",children:c})]}),e.jsx("p",{className:"text-3xl font-bold text-slate-50 mt-2",children:r}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:o})]}),u=({to:t,title:r,description:o,icon:c,variants:l})=>e.jsx(d.div,{variants:l,children:e.jsxs(E,{to:t,className:"group bg-zinc-900/70 hover:bg-zinc-800/90 border border-white/10 rounded-lg p-4 flex items-center gap-4 transition-all duration-300",children:[e.jsx("div",{className:"bg-zinc-800 group-hover:bg-cyan-500 text-cyan-400 group-hover:text-white p-3 rounded-lg transition-colors duration-300",children:c}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-slate-200",children:r}),e.jsx("p",{className:"text-sm text-slate-400",children:o})]}),e.jsx(K,{className:"text-slate-500 group-hover:text-white transition-colors duration-300"})]})}),pe=()=>{const[t,r]=p.useState(null),[o,c]=p.useState(null),[l,S]=p.useState(!0),m=V(),g=B(),x=g.currentUser;p.useEffect(()=>{if(x){const i=async()=>{const n=H(k,"clients",x.uid),h=await M(n);h.exists()?r(h.data()):(await D(g),m("/client-login")),S(!1)},a=()=>{const n=P(k,`clients/${x.uid}/checks`),h=R(n,$("createdAt","desc"));return q(h,T=>{var C,y;const A=(y=(C=T.docs.map(z=>({id:z.id,...z.data()}))[0])==null?void 0:C.createdAt)==null?void 0:y.toDate();c(A||null)})};return i(),a()}else m("/client-login")},[x,m]);const L=()=>{D(g).then(()=>{sessionStorage.removeItem("app_role"),m("/client-login")})};if(l)return e.jsx(Q,{});if(!t)return e.jsx("p",{className:"text-center text-red-400 p-8",children:"Errore nel caricamento dei dati."});let f="N/D",b="Non impostata";if(t.scadenza&&t.scadenza.toDate){const i=t.scadenza.toDate(),a=new Date;i.setHours(23,59,59,999),a.setHours(0,0,0,0);const n=i-a;f=Math.max(0,Math.ceil(n/(1e3*60*60*24))),b=i.toLocaleDateString("it-IT")}let v="Nessun check registrato",N="Carica il tuo primo check!";if(o){const i=new Date;i.setHours(0,0,0,0);const a=new Date(o);a.setDate(a.getDate()+7);const n=Math.max(0,Math.ceil((a-i)/(1e3*60*60*24)));v=n===0?"Oggi":`${n} giorni`,N=`Prossimo check suggerito: ${a.toLocaleDateString("it-IT")}`}const I={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},s={hidden:{y:20,opacity:0},visible:{y:0,opacity:1}};return e.jsx("div",{className:"min-h-screen text-slate-200 p-4 sm:p-8 relative",children:e.jsxs(d.div,{initial:"hidden",animate:"visible",variants:I,children:[e.jsxs(d.header,{variants:s,className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl sm:text-4xl font-bold text-slate-50",children:["Ciao, ",t.name,"!"]}),e.jsx("p",{className:"text-slate-300",children:"Benvenuto nella tua area personale."})]}),e.jsxs("button",{onClick:L,className:"flex items-center gap-2 px-3 py-2 bg-red-600/80 hover:bg-red-600 text-white text-sm font-semibold rounded-lg transition-colors",children:[e.jsx(O,{size:16}),e.jsx("span",{children:"Logout"})]})]}),e.jsxs("main",{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6 mb-8",children:[e.jsx(j,{title:"Scadenza Percorso",value:`${f} giorni`,subtext:`Scade il: ${b}`,icon:e.jsx(U,{size:24}),variants:s}),e.jsx(j,{title:"Tipo Percorso",value:t.planType?t.planType.charAt(0).toUpperCase()+t.planType.slice(1):"Non specificato",subtext:"Il tuo piano attuale",icon:e.jsx(F,{size:24}),variants:s}),e.jsx(j,{title:"Prossimo Check",value:v,subtext:N,icon:e.jsx(w,{size:24}),variants:s})]}),e.jsxs(d.div,{variants:s,className:"bg-zinc-950/60 backdrop-blur-xl rounded-2xl gradient-border p-6",children:[e.jsx("h3",{className:"text-2xl font-bold mb-4 text-white",children:"Cosa vuoi fare?"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(u,{to:"/client/anamnesi",title:"La mia Anamnesi",description:"Visualizza o aggiorna i tuoi dati",icon:e.jsx(G,{size:22}),variants:s}),e.jsx(u,{to:"/client/checks",title:"I miei Check",description:"Carica i tuoi progressi periodici",icon:e.jsx(w,{size:22}),variants:s}),e.jsx(u,{to:"/client/payments",title:"I miei Pagamenti",description:"Visualizza lo storico dei pagamenti",icon:e.jsx(J,{size:22}),variants:s}),e.jsx(u,{to:"/client/chat",title:"Chat con il Coach",description:"Invia un messaggio diretto",icon:e.jsx(_,{size:22}),variants:s})]})]})]})]})})};export{pe as default};
