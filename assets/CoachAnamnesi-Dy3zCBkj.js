import{r as o,j as e}from"./react-FJB7Hj_2.js";import{G as y,H as N,I as A,B as w,z}from"./@firebase-D5dUFubL.js";import{d as j}from"./index-C1w-7Ivh.js";import{a as E}from"./react-router-DF4cN2Hx.js";import{m as l,A as I}from"./framer-motion-Bo7GrDk8.js";import{F as v,A as C}from"./lucide-react-BYK_Rxhn.js";import"./papaparse-BHXrM2Hc.js";import"./idb-BXWtuYvb.js";import"./react-dom-BrtcLnxQ.js";import"./scheduler-DYLXRpC5.js";import"./react-router-dom-udQfSOCw.js";import"./@remix-run-CjG9tKj3.js";import"./firebase-CiybzbB3.js";import"./tslib-BGVaTf34.js";import"./motion-dom-C8PdgYBP.js";import"./motion-utils-DBsP9okC.js";const L=()=>e.jsx("div",{className:"min-h-screen flex justify-center items-center relative",children:e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-cyan-400"})}),S=({item:s,navigate:a,variants:c})=>{var n;return e.jsxs(l.div,{variants:c,className:"p-3 rounded-lg bg-slate-500/5 hover:bg-slate-500/10 transition-colors",onClick:()=>a(`/admin/anamnesi/${s.clientId}`),children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-sm font-semibold text-slate-200",children:s.clientName}),e.jsxs("span",{className:"px-2.5 py-1 text-xs font-medium rounded-full bg-blue-900/80 text-blue-300 border border-blue-500/30",children:["Inviata il ",(n=s.date)==null?void 0:n.toDate().toLocaleDateString("it-IT")]})]}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:s.description})]})};function K(){const s=E(),[a,c]=o.useState([]),[n,m]=o.useState(!0),[h,f]=o.useState(null);o.useEffect(()=>{const t=y(A(j,"anamnesi"),N("submittedAt","desc")),i=w(t,async x=>{try{const r=[];for(const p of x.docs){const u=p.ref.parent.parent.id,b=await z(p(j,"clients",u));r.push({type:"new_anamnesi",clientId:u,clientName:b.exists()&&b.data().name||"Cliente",description:"Ha compilato l'anamnesi iniziale",date:p.data().submittedAt})}c(r.slice(0,5)),m(!1)}catch(r){console.error("Errore nel fetch anamnesi:",r),f("Errore nel caricamento delle anamnesi."),m(!1)}},x=>{console.error("Errore snapshot anamnesi:",x),f("Errore nel caricamento delle anamnesi."),m(!1)});return()=>i()},[]);const g={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},d={hidden:{y:20,opacity:0},visible:{y:0,opacity:1}};return h?e.jsx("div",{className:"min-h-screen bg-zinc-950 text-red-400 flex justify-center items-center",children:h}):n?e.jsx(L,{}):e.jsx("div",{className:"min-h-screen text-slate-200 p-4 sm:p-8 relative",children:e.jsxs(l.div,{initial:"hidden",animate:"visible",variants:g,children:[e.jsxs(l.header,{variants:d,className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-8",children:[e.jsxs("h1",{className:"text-3xl sm:text-4xl font-bold text-slate-50 flex items-center gap-2",children:[e.jsx(v,{size:28})," Anamnesi Inviate"]}),e.jsxs("button",{onClick:()=>s("/coach-dashboard"),className:"flex items-center gap-2 px-3 py-2 bg-zinc-800 hover:bg-zinc-700 text-slate-300 text-sm font-semibold rounded-lg transition-colors",children:[e.jsx(C,{size:16}),e.jsx("span",{children:"Torna alla Dashboard"})]})]}),e.jsxs(l.div,{variants:d,className:"bg-zinc-950/60 backdrop-blur-xl p-4 sm:p-6 rounded-xl gradient-border",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2 text-slate-200",children:[e.jsx(v,{size:20})," Ultime Anamnesi"]}),e.jsx("div",{className:"space-y-3 max-h-[90vh] overflow-y-auto pr-2",children:e.jsx(I,{children:a.length>0?a.map(t=>{var i;return e.jsx(S,{item:t,navigate:s,variants:d},`${t.type}-${t.clientId}-${(i=t.date)==null?void 0:i.seconds}`)}):e.jsx("p",{className:"text-slate-400 text-center p-4",children:"Nessuna anamnesi recente."})})})]})]})})}export{K as default};
