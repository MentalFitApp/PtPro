import{E as Z,h as B,r as c,W as u,V as j,T as f,j as e,q as x,v as G,Z as R,aI as F,aq as W,F as Y,e as $,f as H}from"./.pnpm-C04Ba0Xq.js";import{a as S,d as p}from"./index-DdCoIfwr.js";function X(){const{date:o}=Z(),m=B(),[g,k]=c.useState([]),[C,D]=c.useState([]),[T,E]=c.useState([]),[P,U]=c.useState(!0),[N,z]=c.useState("");if(c.useEffect(()=>{if(!S.currentUser){m("/login");return}(async()=>{try{const r=$(p,"roles","admins"),a=await H(r);if(!a.exists()||!a.data().uids.includes(S.currentUser.uid)){m("/collaboratori");return}}catch(r){console.error("Errore verifica ruolo admin:",r),m("/collaboratori")}})();const s=u(j(p,"collaboratori")),i=f(s,r=>{const a=r.docs.map(l=>({id:l.id,...l.data()}));k(a)},r=>{console.error("Errore snapshot collaboratori:",r),z("Errore nel recupero dei collaboratori: "+r.message)}),b=u(j(p,"settingReports")),I=f(b,r=>{const a=r.docs.map(l=>({id:l.id,...l.data()}));D(a)}),q=u(j(p,"salesReports")),Q=f(q,r=>{const a=r.docs.map(l=>({id:l.id,...l.data()}));E(a)});return U(!1),()=>{i(),I(),Q()}},[m,o]),P)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-rose-500"})});if(N)return e.jsx("div",{className:"min-h-screen flex items-center justify-center text-red-500",children:e.jsx("p",{children:N})});const[A,L,O]=o.split("-").map(Number),M=new Date(A,L-1,O),V=new Intl.DateTimeFormat("it-IT",{weekday:"long",year:"numeric",month:"long",day:"numeric"}).format(M),h=new Date,y=[h.getFullYear(),String(h.getMonth()+1).padStart(2,"0"),String(h.getDate()).padStart(2,"0")].join("-"),v=g.map(t=>{var i;const s=(i=t.dailyReports)==null?void 0:i.find(b=>b.date===o);return s?{id:t.id,name:t.name||t.email.split("@")[0],role:t.role||"N/D",photoURL:t.photoURL||"/default-avatar.png",gender:t.gender||"M",report:s}:null}).filter(Boolean).sort((t,s)=>t.name.localeCompare(s.name)),d=C.find(t=>t.date===o),n=T.find(t=>t.date===o),w=t=>{if(!t)return"Sconosciuto";const s=g.find(i=>i.id===t);return s?s.name||s.email.split("@")[0]:"Sconosciuto"};return e.jsxs(x.div,{initial:{opacity:0},animate:{opacity:1},className:"p-4 sm:p-6 max-w-7xl mx-auto",children:[e.jsxs(x.header,{className:"flex justify-between items-center mb-8",children:[e.jsxs("h1",{className:"text-3xl font-bold text-slate-50 flex items-center gap-3",children:[e.jsx(G,{size:32})," Report del ",V]}),e.jsx("button",{onClick:()=>m("/collaboratori"),className:"px-6 py-3 bg-rose-600 hover:bg-rose-700 text-white rounded-xl transition-all font-medium",children:"Torna ai Collaboratori"})]}),e.jsxs(x.div,{className:"space-y-8",children:[d&&e.jsxs(x.div,{initial:{opacity:0,y:40},animate:{opacity:1,y:0},className:"glass-card p-8 bg-gradient-to-br from-cyan-900/40 to-blue-900/40 border border-cyan-500/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-2xl font-bold text-cyan-300 flex items-center gap-3",children:[e.jsx(R,{size:28})," Report Setting"]}),e.jsxs("div",{className:"text-sm text-cyan-200",children:["Compilato da: ",e.jsx("span",{className:"font-bold",children:w(d.uid)})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-5 text-center",children:[e.jsxs("div",{className:"p-5 bg-slate-800/60 rounded-xl border border-cyan-500/30",children:[e.jsx("p",{className:"text-cyan-400 font-medium text-sm",children:"Follow-ups"}),e.jsx("p",{className:"text-3xl font-bold text-white mt-2",children:d.followUpsFatti||0})]}),e.jsxs("div",{className:"p-5 bg-slate-800/60 rounded-xl border border-cyan-500/30",children:[e.jsx("p",{className:"text-cyan-400 font-medium text-sm",children:"Dialed"}),e.jsx("p",{className:"text-3xl font-bold text-white mt-2",children:d.dialedFatti||0})]}),e.jsxs("div",{className:"p-5 bg-green-900/30 rounded-xl border border-green-500/40",children:[e.jsx("p",{className:"text-green-400 font-medium text-sm",children:"Risposte"}),e.jsx("p",{className:"text-3xl font-bold text-white mt-2",children:d.dialedRisposte||0})]}),e.jsxs("div",{className:"p-5 bg-rose-900/30 rounded-xl border border-rose-500/40",children:[e.jsx("p",{className:"text-rose-400 font-medium text-sm",children:"Prenotate"}),e.jsx("p",{className:"text-3xl font-bold text-white mt-2",children:d.chiamatePrenotate||0})]})]})]}),n&&e.jsxs(x.div,{initial:{opacity:0,y:40},animate:{opacity:1,y:0},className:"glass-card p-8 bg-gradient-to-br from-rose-900/40 to-purple-900/40 border border-rose-500/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-2xl font-bold text-rose-300 flex items-center gap-3",children:[e.jsx(F,{size:28})," Report Vendita"]}),e.jsxs("div",{className:"text-sm text-rose-200",children:["Compilato da: ",e.jsx("span",{className:"font-bold",children:w(n.uid)})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-5 text-center",children:[e.jsxs("div",{className:"p-5 bg-slate-800/60 rounded-xl border border-rose-500/30",children:[e.jsx("p",{className:"text-rose-400 font-medium text-sm",children:"Call Fissate"}),e.jsx("p",{className:"text-3xl font-bold text-white mt-2",children:n.chiamateFissate||0})]}),e.jsxs("div",{className:"p-5 bg-slate-800/60 rounded-xl border border-rose-500/30",children:[e.jsx("p",{className:"text-rose-400 font-medium text-sm",children:"Call Fatte"}),e.jsx("p",{className:"text-3xl font-bold text-white mt-2",children:n.chiamateFatte||0})]}),e.jsxs("div",{className:"p-5 bg-yellow-900/30 rounded-xl border border-yellow-500/40",children:[e.jsx("p",{className:"text-yellow-400 font-medium text-sm",children:"Offer"}),e.jsx("p",{className:"text-3xl font-bold text-white mt-2",children:n.offersFatte||0})]}),e.jsxs("div",{className:"p-5 bg-green-900/30 rounded-xl border border-green-500/40",children:[e.jsx("p",{className:"text-green-400 font-medium text-sm",children:"Chiuse"}),e.jsx("p",{className:"text-3xl font-bold text-white mt-2",children:n.chiuse||0})]}),e.jsxs("div",{className:"p-5 bg-purple-900/30 rounded-xl border border-purple-500/40",children:[e.jsx("p",{className:"text-purple-400 font-medium text-sm",children:"Cash"}),e.jsxs("p",{className:"text-3xl font-bold text-white mt-2",children:["€",n.cash||0]})]})]})]}),v.length===0?e.jsxs("div",{className:"glass-card p-12 text-center",children:[e.jsx(W,{size:80,className:"mx-auto text-yellow-500 mb-6 opacity-80"}),e.jsx("p",{className:"text-slate-300 text-xl font-medium",children:o<y?"Nessun report inviato per questa data passata.":"Nessun report inviato per oggi."}),o<y&&e.jsx("p",{className:"text-red-400 text-2xl font-bold mt-4",children:"GIORNATA SENZA REPORT"})]}):v.map((t,s)=>e.jsxs(x.div,{initial:{opacity:0,y:40},animate:{opacity:1,y:0},transition:{delay:s*.1},className:"glass-card p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8 pb-6 border-b border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("img",{src:t.photoURL,alt:t.name,className:"w-16 h-16 rounded-full border-2 border-rose-500 object-cover"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-200",children:t.name}),e.jsx("p",{className:"text-slate-400 text-lg",children:t.role})]})]}),e.jsx("div",{className:`px-6 py-3 rounded-full text-lg font-bold ${t.report.tracker?"bg-gradient-to-r from-green-600 to-emerald-600 text-white":"bg-gradient-to-r from-yellow-600 to-orange-600 text-white"}`,children:t.report.tracker?"COMPLETO":"PARZIALE"})]}),t.report.tracker&&e.jsxs("div",{className:"p-8 bg-gradient-to-br from-zinc-900/90 to-zinc-800/90 rounded-2xl border border-purple-500/30",children:[e.jsxs("h3",{className:"text-2xl font-bold text-purple-400 flex items-center gap-3 mb-6",children:[t.role==="Marketing"&&e.jsx(Y,{size:28}),t.role==="Vendita"&&e.jsx(F,{size:28}),t.role==="Setter"&&e.jsx(R,{size:28}),"Tracker DMS (",t.role,")"]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-5",children:[t.role==="Setter"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-5 bg-slate-800/60 rounded-xl border border-cyan-500/30 text-center",children:[e.jsx("p",{className:"text-cyan-400 font-medium text-sm",children:"Outreach Totale"}),e.jsx("p",{className:"text-3xl font-bold text-white mt-2",children:t.report.tracker.outreachTotale||0})]}),e.jsxs("div",{className:"p-5 bg-slate-800/60 rounded-xl border border-cyan-500/30 text-center",children:[e.jsx("p",{className:"text-cyan-400 font-medium text-sm",children:"Follow-Ups Totali"}),e.jsx("p",{className:"text-3xl font-bold text-white mt-2",children:t.report.tracker.followUpsTotali||0})]}),e.jsxs("div",{className:"p-5 bg-green-900/30 rounded-xl border border-green-500/40 text-center",children:[e.jsx("p",{className:"text-green-400 font-medium text-sm",children:"Risposte"}),e.jsx("p",{className:"text-3xl font-bold text-white mt-2",children:t.report.tracker.risposte||0})]}),e.jsxs("div",{className:"p-5 bg-rose-900/30 rounded-xl border border-rose-500/40 text-center",children:[e.jsx("p",{className:"text-rose-400 font-medium text-sm",children:"Call Prenotate"}),e.jsx("p",{className:"text-3xl font-bold text-white mt-2",children:t.report.tracker.callPrenotate||0})]})]}),t.role==="Marketing"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-6 bg-rose-900/40 rounded-xl border border-rose-500/50 text-center col-span-2",children:[e.jsx("p",{className:"text-rose-400 font-semibold text-lg",children:"Views 24h"}),e.jsx("p",{className:"text-5xl font-bold text-white mt-3",children:t.report.tracker.volumeViews24h||0})]}),e.jsxs("div",{className:"p-6 bg-green-900/40 rounded-xl border border-green-500/50 text-center col-span-2",children:[e.jsx("p",{className:"text-green-400 font-semibold text-lg",children:"Leads 24h"}),e.jsx("p",{className:"text-5xl font-bold text-white mt-3",children:t.report.tracker.volumeLeads24h||0})]})]}),t.role==="Vendita"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-5 bg-cyan-900/40 rounded-xl border border-cyan-500/50 text-center",children:[e.jsx("p",{className:"text-cyan-400 font-semibold",children:"Call Prenotate"}),e.jsx("p",{className:"text-3xl font-bold text-white mt-2",children:t.report.tracker.callPrenotate||0})]}),e.jsxs("div",{className:"p-5 bg-green-900/40 rounded-xl border border-green-500/50 text-center",children:[e.jsx("p",{className:"text-green-400 font-semibold",children:"Call Fatte"}),e.jsx("p",{className:"text-3xl font-bold text-white mt-2",children:t.report.tracker.callFatte||0})]}),e.jsxs("div",{className:"p-5 bg-yellow-900/40 rounded-xl border border-yellow-500/50 text-center",children:[e.jsx("p",{className:"text-yellow-400 font-semibold",children:"Offer Fatte"}),e.jsx("p",{className:"text-3xl font-bold text-white mt-2",children:t.report.tracker.offerFatte||0})]}),e.jsxs("div",{className:"p-5 bg-rose-900/40 rounded-xl border border-rose-500/50 text-center",children:[e.jsx("p",{className:"text-rose-400 font-semibold",children:"Chiuse"}),e.jsx("p",{className:"text-3xl font-bold text-white mt-2",children:t.report.tracker.chiuse||0})]}),e.jsxs("div",{className:"p-5 bg-purple-900/40 rounded-xl border border-purple-500/50 text-center col-span-2",children:[e.jsx("p",{className:"text-purple-400 font-semibold text-lg",children:"Cash"}),e.jsxs("p",{className:"text-4xl font-bold text-white mt-2",children:["€",t.report.tracker.cash||0]})]})]})]})]})]},t.id))]})]})}export{X as default};
