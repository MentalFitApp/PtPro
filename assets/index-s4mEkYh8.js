const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MainLayout-P5sbeMDp.js","assets/react-CrXOBDSJ.js","assets/core-js-ChGsxLo2.js","assets/react-router-BxpCmtJ-.js","assets/@remix-run-CjG9tKj3.js","assets/framer-motion-BAPjnw1b.js","assets/motion-dom-C8PdgYBP.js","assets/motion-utils-DBsP9okC.js","assets/lucide-react-OWEKwkjs.js","assets/ClientLayout-7T0p8bQs.js","assets/GuidaLayout-ClZhG-wP.js","assets/Login-BnbUByyL.js","assets/firebase-CCo3Hvf0.js","assets/@firebase-Dy5qmm0I.js","assets/idb-Bn1DMRyg.js","assets/tslib-BGVaTf34.js","assets/react-dom-BpmKF3Ga.js","assets/scheduler-DYLXRpC5.js","assets/react-router-dom-9rcY47vU.js","assets/jspdf-7Jyqi_bl.js","assets/@babel-Cvov1XSu.js","assets/fflate-XZmX483V.js","assets/fast-png-CUrN0NP5.js","assets/iobuffer-DZ1zOcUT.js","assets/pako-B9FS3IR_.js","assets/Dashboard-XO6fBaca.js","assets/react-chartjs-2-DgEolIMQ.js","assets/chart.js-m_wzuIQ6.js","assets/@kurkle-D8fDXNIl.js","assets/Clients-D5jWl4pR.js","assets/papaparse-rLJvb3Z-.js","assets/date-fns-K6w5eF5u.js","assets/ClientDetail-C3Kz3RRU.js","assets/EditClient-_YZZw3nO.js","assets/react-hook-form-yCRcHKQw.js","assets/Updates-n63OytUa.js","assets/AdminChat-DWODRluQ.js","assets/ClientLogin-DzR5SmQt.js","assets/FirstAccess-OKImgO_E.js","assets/ClientDashboard-BlhcTuph.js","assets/ClientAnamnesi-Bu-s1y4M.js","assets/uuid-CtRu48qb.js","assets/ClientChecks-D4ULAZSg.js","assets/react-calendar-fvZi8T_s.js","assets/clsx-B-dksMZM.js","assets/get-user-locale-CTD1oYsn.js","assets/memoize-BZNdjcd3.js","assets/mimic-function-BIlJVoeO.js","assets/@wojtekmaj-CaFejNaN.js","assets/react-calendar-DDKpoaqD.css","assets/ClientPayments-CXFyAlua.js","assets/ClientChat-BCVarOlj.js","assets/ForgotPassword-5LZ8wFS1.js","assets/AdminAnamnesi-CpnBkYSZ.js","assets/CoachDashboard-D9iu3G78.js","assets/CoachAnamnesi-DgLzL4EO.js","assets/CoachUpdates-CrXTq4Hn.js","assets/CoachClients-DRYyEiQY.js","assets/CoachChat-C2XDvOuF.js","assets/CoachClientDetail-B8t8EEWZ.js","assets/GuidaMentalFit-D1iZKz7X.js","assets/html2canvas-CBrSDip1.js","assets/BusinessHistory-D5nDBrMR.js","assets/Collaboratori-CV3c92On.js","assets/CollaboratoreLogin-Cz6p05Vn.js","assets/CollaboratoreDashboard-BynxTJt1.js","assets/CollaboratoreDetail-tBLvj4Es.js","assets/CalendarReport-Bj-bjezz.js","assets/NewClient-DQjorYP9.js","assets/Dipendenti--bFF-2UH.js","assets/GuideCapture-EJgCPik-.js","assets/GuideManager-CLnPQ8Ow.js","assets/Statistiche-oaaKUBhk.js","assets/CalendarPage-ClXmHuJI.js"])))=>i.map(i=>d[i]);
import{R as s,r as D,j as e}from"./react-CrXOBDSJ.js";import{c as W}from"./react-dom-BpmKF3Ga.js";import{H as G}from"./react-router-dom-9rcY47vU.js";import{_ as o}from"./jspdf-7Jyqi_bl.js";import{g as H,o as M}from"./firebase-CCo3Hvf0.js";import{v as F,w as B,x as K,y as b,z as y,A as X,B as U}from"./@firebase-Dy5qmm0I.js";import{a as k,b as q,d as J,e as t,f as u}from"./react-router-BxpCmtJ-.js";import"./core-js-ChGsxLo2.js";import"./scheduler-DYLXRpC5.js";import"./@remix-run-CjG9tKj3.js";import"./@babel-Cvov1XSu.js";import"./fflate-XZmX483V.js";import"./fast-png-CUrN0NP5.js";import"./iobuffer-DZ1zOcUT.js";import"./pako-B9FS3IR_.js";import"./tslib-BGVaTf34.js";import"./idb-Bn1DMRyg.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))c(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const _ of a.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&c(_)}).observe(document,{childList:!0,subtree:!0});function l(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function c(n){if(n.ep)return;n.ep=!0;const a=l(n);fetch(n.href,a)}})();const Q={apiKey:"AIzaSyDU4GmH6xLhrEd2jSkyATXJOasIyEfisXY",authDomain:"biondo-fitness-coach.firebaseapp.com",projectId:"biondo-fitness-coach",storageBucket:"biondo-fitness-coach.firebasestorage.app",messagingSenderId:"1086406111438",appId:"1:1086406111438:web:1c8c3d9e49f1ffdb77609f",measurementId:"G-869HQ5KGVX"},C=F(Q),Y=H(C),A=B(C),$e=K(C),et=async i=>{try{const r=b(A,"clients",i),l=await y(r);if(!l.exists())return;const c=l.data().scadenza,n=Z(c);await X(r,{statoPercorso:n})}catch(r){console.error("Errore in updateStatoPercorso:",r)}},Z=i=>{if(!i)return"N/D";const r=$(i);if(!r)return"N/D";const l=new Date;l.setHours(0,0,0,0),r.setHours(0,0,0,0);const c=Math.ceil((r-l)/(1e3*60*60*24));return c<0?"Scaduto":c<=7?"In scadenza":"Attivo"},$=i=>{if(!i)return null;if(typeof(i==null?void 0:i.toDate)=="function")return i.toDate();if(i instanceof Date)return i;if(typeof i=="string")try{const r=new Date(i);return isNaN(r.getTime())?null:r}catch{return null}if(typeof i=="number"){const r=new Date(i);return isNaN(r.getTime())?null:r}return null},R=s.lazy(()=>o(()=>import("./MainLayout-P5sbeMDp.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),ee=s.lazy(()=>o(()=>import("./ClientLayout-7T0p8bQs.js"),__vite__mapDeps([9,1,2,3,4]))),te=s.lazy(()=>o(()=>import("./GuidaLayout-ClZhG-wP.js"),__vite__mapDeps([10,1,2,3,4]))),ae=s.lazy(()=>o(()=>import("./Login-BnbUByyL.js"),__vite__mapDeps([11,1,2,12,13,14,15,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24]))),se=s.lazy(()=>o(()=>import("./Dashboard-XO6fBaca.js"),__vite__mapDeps([25,1,2,13,14,12,15,26,27,28,3,4,8,5,6,7,16,17,18,19,20,21,22,23,24]))),oe=s.lazy(()=>o(()=>import("./Clients-D5jWl4pR.js"),__vite__mapDeps([29,1,2,13,14,12,15,30,3,4,31,20,8,5,6,7,16,17,18,19,21,22,23,24]))),ie=s.lazy(()=>o(()=>import("./ClientDetail-C3Kz3RRU.js"),__vite__mapDeps([32,1,2,13,14,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24,12,15]))),re=s.lazy(()=>o(()=>import("./EditClient-_YZZw3nO.js"),__vite__mapDeps([33,1,2,34,13,14,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24,12,15]))),ne=s.lazy(()=>o(()=>import("./Updates-n63OytUa.js"),__vite__mapDeps([35,1,2,13,14,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24,12,15]))),le=s.lazy(()=>o(()=>import("./AdminChat-DWODRluQ.js"),__vite__mapDeps([36,1,2,12,13,14,15,8,5,6,7,16,17,18,3,4,19,20,21,22,23,24])));s.lazy(()=>o(()=>import("./ClientLogin-DzR5SmQt.js"),__vite__mapDeps([37,1,2,18,16,17,3,4,12,13,14,15,5,6,7,8,19,20,21,22,23,24])));const O=s.lazy(()=>o(()=>import("./FirstAccess-OKImgO_E.js"),__vite__mapDeps([38,1,2,12,13,14,15,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24]))),ce=s.lazy(()=>o(()=>import("./ClientDashboard-BlhcTuph.js"),__vite__mapDeps([39,1,2,12,13,14,15,18,16,17,3,4,8,5,6,7,19,20,21,22,23,24]))),de=s.lazy(()=>o(()=>import("./ClientAnamnesi-Bu-s1y4M.js"),__vite__mapDeps([40,1,2,34,12,13,14,15,3,4,8,5,6,7,41,16,17,18,19,20,21,22,23,24]))),V=s.lazy(()=>o(()=>import("./ClientChecks-D4ULAZSg.js"),__vite__mapDeps([42,1,2,12,13,14,15,43,44,45,46,47,48,49,3,4,8,5,6,7,41,16,17,18,19,20,21,22,23,24]))),me=s.lazy(()=>o(()=>import("./ClientPayments-CXFyAlua.js"),__vite__mapDeps([50,1,2,12,13,14,15,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24]))),pe=s.lazy(()=>o(()=>import("./ClientChat-BCVarOlj.js"),__vite__mapDeps([51,1,2,12,13,14,15,3,4,8,5,6,7,16,17,18,19,20,21,22,23,24]))),ue=s.lazy(()=>o(()=>import("./ForgotPassword-5LZ8wFS1.js"),__vite__mapDeps([52,1,2,12,13,14,15,18,16,17,3,4,5,6,7,8]))),_e=s.lazy(()=>o(()=>import("./AdminAnamnesi-CpnBkYSZ.js"),__vite__mapDeps([53,1,2,13,14,3,4,8,5,6,7,16,17,18,19,20,21,22,23,24,12,15]))),he=s.lazy(()=>o(()=>import("./CoachDashboard-D9iu3G78.js"),__vite__mapDeps([54,1,2,13,14,12,15,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24]))),fe=s.lazy(()=>o(()=>import("./CoachAnamnesi-DgLzL4EO.js"),__vite__mapDeps([55,1,2,13,14,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24,12,15]))),xe=s.lazy(()=>o(()=>import("./CoachUpdates-CrXTq4Hn.js"),__vite__mapDeps([56,1,2,13,14,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24,12,15]))),je=s.lazy(()=>o(()=>import("./CoachClients-DRYyEiQY.js"),__vite__mapDeps([57,1,2,13,14,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24,12,15]))),ge=s.lazy(()=>o(()=>import("./CoachChat-C2XDvOuF.js"),__vite__mapDeps([58,1,2,12,13,14,15,3,4,8,5,6,7,16,17,18,19,20,21,22,23,24]))),Ee=s.lazy(()=>o(()=>import("./CoachClientDetail-B8t8EEWZ.js"),__vite__mapDeps([59,1,2,13,14,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24,12,15]))),De=s.lazy(()=>o(()=>import("./GuidaMentalFit-D1iZKz7X.js"),__vite__mapDeps([60,1,2,61,19,20,21,22,23,24]))),be=s.lazy(()=>o(()=>import("./BusinessHistory-D5nDBrMR.js"),__vite__mapDeps([62,1,2,13,14,3,4,8,5,6,7,16,17,18,19,20,21,22,23,24,12,15]))),ye=s.lazy(()=>o(()=>import("./Collaboratori-CV3c92On.js"),__vite__mapDeps([63,1,2,13,14,12,15,5,6,7,3,4,8,16,17,18,19,20,21,22,23,24])));s.lazy(()=>o(()=>import("./CollaboratoreLogin-Cz6p05Vn.js"),__vite__mapDeps([64,1,2,12,13,14,15,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24])));const Ae=s.lazy(()=>o(()=>import("./CollaboratoreDashboard-BynxTJt1.js"),__vite__mapDeps([65,1,2,13,14,12,15,27,28,26,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24]))),Ie=s.lazy(()=>o(()=>import("./CollaboratoreDetail-tBLvj4Es.js"),__vite__mapDeps([66,1,2,13,14,12,15,27,28,26,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24]))),Le=s.lazy(()=>o(()=>import("./CalendarReport-Bj-bjezz.js"),__vite__mapDeps([67,1,2,13,14,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24,12,15]))),ve=s.lazy(()=>o(()=>import("./NewClient-DQjorYP9.js"),__vite__mapDeps([68,1,2,34,12,13,14,15,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24]))),Pe=s.lazy(()=>o(()=>import("./Dipendenti--bFF-2UH.js"),__vite__mapDeps([69,1,2,13,14,31,20,8,5,6,7,16,17,18,3,4,19,21,22,23,24,12,15]))),Re=s.lazy(()=>o(()=>import("./GuideCapture-EJgCPik-.js"),__vite__mapDeps([70,1,2,13,14,5,6,7,3,4,8,16,17,18,19,20,21,22,23,24,12,15]))),Ce=s.lazy(()=>o(()=>import("./GuideManager-CLnPQ8Ow.js"),__vite__mapDeps([71,1,2,13,14,8,5,6,7,16,17,18,3,4,19,20,21,22,23,24,12,15]))),ze=s.lazy(()=>o(()=>import("./Statistiche-oaaKUBhk.js"),__vite__mapDeps([72,1,2,13,14,27,28,3,4,8,16,17,18,19,20,21,22,23,24,12,15]))),T=s.lazy(()=>o(()=>import("./CalendarPage-ClXmHuJI.js"),__vite__mapDeps([73,1,2,13,14,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24,12,15]))),Oe=()=>e.jsx("div",{className:"flex justify-center items-center h-screen w-full bg-slate-900",children:e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-rose-500"})}),Ve=()=>e.jsxs("div",{className:"flex flex-col justify-center items-center min-h-screen bg-slate-900 text-slate-200",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-rose-500"}),e.jsx("p",{className:"mt-4 text-sm",children:"Verifica autenticazione..."})]});function Te(){const[i,r]=D.useState({isLoading:!0,user:null,isClient:!1,isCoach:!1,isAdmin:!1,isCollaboratore:!1,error:null}),[l,c]=D.useState(null),n=k(),a=q();return D.useEffect(()=>{try{localStorage.setItem("last_path",a.pathname||"/")}catch{}},[a.pathname]),D.useEffect(()=>{if(a.pathname==="/guida"||a.pathname.startsWith("/guida/")){r(m=>({...m,isLoading:!1}));return}let _=!0;const S=M(Y,async m=>{if(_){if(sessionStorage.getItem("creating_collaboratore")==="true"){sessionStorage.removeItem("creating_collaboratore");return}try{if(m){const f=b(A,"clients",m.uid),I=b(A,"roles","admins"),p=b(A,"roles","coaches"),w=b(A,"collaboratori",m.uid),z=await y(w).catch(()=>({exists:()=>!1,data:()=>({})})),x=z.exists();let j=!1,g=!1,E=!1,v,P,L;x||([v,P,L]=await Promise.all([y(I).catch(()=>({exists:()=>!1,data:()=>({uids:[]})})),y(p).catch(()=>({exists:()=>!1,data:()=>({uids:[]})})),y(f).catch(()=>({exists:()=>!1,data:()=>({})}))]),j=v.exists()&&v.data().uids.includes(m.uid),g=P.exists()&&P.data().uids.includes(m.uid),E=L.exists()&&L.data().isClient===!0),!x&&(g||j)&&E&&await U(f).catch(()=>{});let h=null,d=null;j?(h="admin",d="/"):g?(h="coach",d="/coach"):E?(h="client",d=L.data().firstLogin?"/client/first-access":"/client/dashboard"):x?(h="collaboratore",d=z.data().firstLogin?"/collaboratore/first-access":"/collaboratore/dashboard"):(h=null,d="/login"),sessionStorage.setItem("app_role",h||""),!(j&&(a.pathname==="/"||a.pathname==="/clients"||a.pathname==="/new-client"||a.pathname.startsWith("/client/")||a.pathname.startsWith("/edit/")||a.pathname==="/updates"||a.pathname==="/chat"||a.pathname==="/collaboratori"||a.pathname.startsWith("/collaboratore/")||a.pathname.startsWith("/calendar-report/")||a.pathname==="/business-history"||a.pathname==="/guide-manager"||a.pathname==="/admin/dipendenti"||a.pathname==="/statistiche")||g&&(a.pathname==="/coach"||a.pathname==="/coach/clients"||a.pathname.startsWith("/coach/client/")||a.pathname==="/coach/anamnesi"||a.pathname==="/coach/updates"||a.pathname==="/coach/chat"||a.pathname.startsWith("/coach/client/"))||E&&a.pathname.startsWith("/client/")||x&&a.pathname.startsWith("/collaboratore/"))&&a.pathname!==d&&l!==d&&(c(d),n(d,{replace:!0})),r({isLoading:!1,user:m,isClient:E,isCoach:g,isAdmin:j,isCollaboratore:x,error:null})}else if(sessionStorage.removeItem("app_role"),r({isLoading:!1,user:null,isClient:!1,isCoach:!1,isAdmin:!1,isCollaboratore:!1,error:null}),!["/login","/client-login","/collaboratore-login","/client/forgot-password","/guida","/guida/:guideId"].some(p=>a.pathname===p||a.pathname.startsWith("/guida/"))){const p="/login";l!==p&&(c(p),n(p,{replace:!0}))}}catch(f){console.error("Errore verifica ruolo:",f),r(I=>({...I,isLoading:!1,error:"Errore autenticazione."})),l!=="/login"&&(c("/login"),n("/login",{replace:!0}))}}});return()=>{_=!1,S()}},[a.pathname,n,l]),i.isLoading?e.jsx(Ve,{}):i.error?e.jsx("div",{className:"text-red-500 text-center p-4",children:i.error}):e.jsx(D.Suspense,{fallback:e.jsx(Oe,{}),children:e.jsxs(J,{children:[e.jsxs(t,{element:e.jsx(te,{}),children:[e.jsx(t,{path:"/guida",element:e.jsx(De,{})}),e.jsx(t,{path:"/guida/:guideId",element:e.jsx(Re,{})})]}),e.jsx(t,{path:"/login",element:e.jsx(ae,{})}),e.jsx(t,{path:"/client-login",element:e.jsx(u,{to:"/login",replace:!0})}),e.jsx(t,{path:"/collaboratore-login",element:e.jsx(u,{to:"/login",replace:!0})}),e.jsx(t,{path:"/client/forgot-password",element:e.jsx(ue,{})}),e.jsxs(t,{element:i.isAdmin?e.jsx(R,{}):e.jsx(u,{to:"/login",replace:!0}),children:[e.jsx(t,{path:"/",element:e.jsx(se,{})}),e.jsx(t,{path:"/clients",element:e.jsx(oe,{})}),e.jsx(t,{path:"/new-client",element:e.jsx(ve,{})}),e.jsx(t,{path:"/client/:clientId",element:e.jsx(ie,{})}),e.jsx(t,{path:"/edit/:id",element:e.jsx(re,{})}),e.jsx(t,{path:"/updates",element:e.jsx(ne,{})}),e.jsx(t,{path:"/chat",element:e.jsx(le,{})}),e.jsx(t,{path:"/client/:id/anamnesi",element:e.jsx(_e,{})}),e.jsx(t,{path:"/collaboratori",element:e.jsx(ye,{})}),e.jsx(t,{path:"/collaboratore-detail",element:e.jsx(Ie,{})}),e.jsx(t,{path:"/calendar",element:e.jsx(T,{})}),e.jsx(t,{path:"/calendar-report/:date",element:e.jsx(Le,{})}),e.jsx(t,{path:"/business-history",element:e.jsx(be,{})}),e.jsx(t,{path:"/guide-manager",element:e.jsx(Ce,{})}),e.jsx(t,{path:"/admin/dipendenti",element:e.jsx(Pe,{})}),e.jsx(t,{path:"/statistiche",element:e.jsx(ze,{})})]}),e.jsxs(t,{element:i.isCoach?e.jsx(R,{}):e.jsx(u,{to:"/login",replace:!0}),children:[e.jsx(t,{path:"/coach",element:e.jsx(he,{})}),e.jsx(t,{path:"/coach/clients",element:e.jsx(je,{})}),e.jsx(t,{path:"/coach/client/:id",element:e.jsx(Ee,{})}),e.jsx(t,{path:"/coach/anamnesi",element:e.jsx(fe,{})}),e.jsx(t,{path:"/coach/updates",element:e.jsx(xe,{})}),e.jsx(t,{path:"/coach/chat",element:e.jsx(ge,{})}),e.jsx(t,{path:"/coach/client/:clientId/checks",element:e.jsx(V,{})})]}),e.jsxs(t,{element:i.isClient?e.jsx(ee,{}):e.jsx(u,{to:"/login",replace:!0}),children:[e.jsx(t,{path:"/client/first-access",element:e.jsx(O,{})}),e.jsx(t,{path:"/client/dashboard",element:e.jsx(ce,{})}),e.jsx(t,{path:"/client/anamnesi",element:e.jsx(de,{})}),e.jsx(t,{path:"/client/checks",element:e.jsx(V,{})}),e.jsx(t,{path:"/client/payments",element:e.jsx(me,{})}),e.jsx(t,{path:"/client/chat",element:e.jsx(pe,{})})]}),e.jsxs(t,{element:i.isCollaboratore?e.jsx(R,{}):e.jsx(u,{to:"/login",replace:!0}),children:[e.jsx(t,{path:"/collaboratore/first-access",element:e.jsx(O,{})}),e.jsx(t,{path:"/collaboratore/dashboard",element:e.jsx(Ae,{})}),e.jsx(t,{path:"/collaboratore/calendar",element:e.jsx(T,{})})]}),e.jsx(t,{path:"*",element:e.jsx(u,{to:i.user?i.isAdmin?"/":i.isCoach?"/coach":i.isCollaboratore?"/collaboratore/dashboard":"/login":"/login",replace:!0})})]})})}W.createRoot(document.getElementById("root")).render(e.jsx(s.StrictMode,{children:e.jsx(G,{children:e.jsx(Te,{})})}));export{Y as a,Z as c,A as d,Q as f,$e as s,$ as t,et as u};
