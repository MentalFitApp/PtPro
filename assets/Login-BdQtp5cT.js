import{r as o,j as e}from"./react-FJB7Hj_2.js";import{s as z}from"./firebase-CiybzbB3.js";import"./@firebase-D5dUFubL.js";import{a as p}from"./index-C1w-7Ivh.js";import{a as k}from"./react-router-DF4cN2Hx.js";import{m as f}from"./framer-motion-Bo7GrDk8.js";import{b as A,c as E,d as I,K as P}from"./lucide-react-BYK_Rxhn.js";import"./papaparse-BHXrM2Hc.js";import"./tslib-BGVaTf34.js";import"./idb-BXWtuYvb.js";import"./react-dom-BrtcLnxQ.js";import"./scheduler-DYLXRpC5.js";import"./react-router-dom-udQfSOCw.js";import"./@remix-run-CjG9tKj3.js";import"./motion-dom-C8PdgYBP.js";import"./motion-utils-DBsP9okC.js";const w=()=>{const t=o.useRef(null),u=o.useRef(!1);return o.useEffect(()=>{if(u.current)return;let r=document.querySelector(".stars");if(r)t.current=r;else{r=document.createElement("div"),r.className="stars";const i=document.querySelector(".starry-background");if(i)i.appendChild(r);else{const s=document.createElement("div");s.className="starry-background",document.body.appendChild(s),s.appendChild(r)}t.current=r}for(let i=0;i<50;i++){const s=document.createElement("div");s.className="star",s.style.setProperty("--top-offset",`${Math.random()*100}vh`),s.style.setProperty("--fall-duration",`${8+Math.random()*6}s`),s.style.setProperty("--fall-delay",`${Math.random()*5}s`),s.style.setProperty("--star-width",`${1+Math.random()*2}px`),t.current.appendChild(s)}return u.current=!0,()=>{if(t.current)for(;t.current.firstChild;)t.current.removeChild(t.current.firstChild)}},[]),e.jsx("div",{className:"starry-background",children:e.jsx("div",{className:"stars"})})};function D(){const t=k(),[u,r]=o.useState(""),[i,s]=o.useState(""),[g,h]=o.useState(""),[l,x]=o.useState(!1),[c,N]=o.useState(!0),b=["QwWST9OVOlTOi5oheyCqfpXLOLg2","3j0AXIRa4XdHq1ywCl4UBxJNsku2","AeZKjJYu5zMZ4mvffaGiqCBb0cF2","l0RI8TzFjbNVoAdmcXNQkP9mWb12"];o.useEffect(()=>{const d=p.onAuthStateChanged(a=>{if(a){const n=a.uid;if(console.log("Utente autenticato all'avvio:",n),b.includes(n)){const m=n==="l0RI8TzFjbNVoAdmcXNQkP9mWb12";sessionStorage.setItem("app_role",m?"coach":"admin"),t(m?"/coach-dashboard":"/",{replace:!0})}else console.log("Utente non autorizzato:",n),p.signOut(),h("Solo amministratori e coach possono accedere a questa area.")}N(!1)});return()=>d()},[t]);const C=async d=>{if(d.preventDefault(),l||c){console.log("Submit bloccato: giÃ  in corso o autenticazione in corso");return}h(""),x(!0),console.log("Tentativo di login con email:",u);try{const n=(await z(p,u,i)).user.uid;if(console.log("Login riuscito, UID:",n),b.includes(n)){const m=n==="l0RI8TzFjbNVoAdmcXNQkP9mWb12";sessionStorage.setItem("app_role",m?"coach":"admin"),t(m?"/coach-dashboard":"/",{replace:!0})}else throw new Error("Solo amministratori e coach possono accedere a questa area.")}catch(a){console.error("Errore di login:",a.code,a.message),h(a.code==="auth/wrong-password"||a.code==="auth/user-not-found"?"Credenziali non valide. Riprova.":a.message),p.currentUser&&await p.signOut()}finally{x(!1)}},S=()=>{console.log("Navigazione a /client/forgot-password"),t("/client/forgot-password")},y="relative",j="w-full p-3 pl-10 bg-zinc-900/70 border border-white/10 rounded-lg outline-none focus:ring-2 focus:ring-rose-500 transition-all text-slate-200",v="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400";return c?e.jsxs("div",{className:"min-h-screen flex items-center justify-center p-4 sm:p-8",children:[e.jsx(w,{}),e.jsxs("div",{className:"flex flex-col justify-center items-center text-slate-200",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-rose-500"}),e.jsx("p",{className:"mt-4 text-sm",children:"Verifica autenticazione..."})]})]}):e.jsxs("div",{className:"min-h-screen flex items-center justify-center p-4 sm:p-8",children:[e.jsx(w,{}),e.jsxs(f.div,{className:"w-full max-w-md bg-zinc-950/60 backdrop-blur-xl rounded-2xl gradient-border p-8 space-y-8 shadow-2xl shadow-black/20",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5,ease:"easeInOut"},children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-3xl font-bold text-slate-50",children:"Area Admin/Coach"}),e.jsx("p",{className:"text-slate-400 mt-2",children:"Accedi per gestire i tuoi clienti."})]}),e.jsxs("form",{onSubmit:C,className:"space-y-6",children:[e.jsxs("div",{className:y,children:[e.jsx(A,{size:18,className:v}),e.jsx("input",{type:"email",value:u,onChange:d=>r(d.target.value),required:!0,placeholder:"Email",className:j,autoComplete:"email",disabled:l||c})]}),e.jsxs("div",{className:y,children:[e.jsx(E,{size:18,className:v}),e.jsx("input",{type:"password",value:i,onChange:d=>s(d.target.value),required:!0,placeholder:"Password",className:j,autoComplete:"current-password",disabled:l||c})]}),g&&e.jsx("p",{className:"text-red-500 text-sm text-center",children:g}),e.jsx("div",{children:e.jsxs(f.button,{type:"submit",disabled:l||c,className:"w-full flex items-center justify-center gap-2 px-4 py-3 font-bold text-white bg-rose-600 rounded-lg hover:bg-rose-700 transition-colors disabled:bg-rose-900 disabled:cursor-not-allowed",whileHover:{scale:l||c?1:1.02},whileTap:{scale:l||c?1:.98},transition:{duration:.2},children:[e.jsx(I,{size:18}),l?"Accesso in corso...":"Accedi"]})})]}),e.jsxs(f.button,{onClick:S,className:"w-full flex items-center justify-center gap-2 px-4 py-3 font-semibold text-slate-200 bg-rose-600/80 rounded-lg hover:bg-rose-700 transition-colors border border-rose-500/30",whileHover:{scale:1.02,y:-1},whileTap:{scale:.98},transition:{duration:.2},children:[e.jsx(P,{size:18}),"Recupera Password"]})]})]})}export{D as default};
