import{h as xe,r as o,V as I,ax as X,j as e,q as y,bI as Z,am as se,a8 as O,b8 as ae,al as Q,A as V,av as J,bA as ue,ay as he,aq as pe,a2 as be,a0 as le,aL as ne,bo as ie,au as re,C as oe,e as K,u as ce,aU as de,l as me,U as ge,z as fe,D as je}from"./.pnpm-C04Ba0Xq.js";import{d as T,t as F}from"./index-DdCoIfwr.js";const B={consegnata:"bg-emerald-900/30 border-emerald-600/50 text-emerald-300",scaduta:"bg-orange-900/30 border-orange-600/50 text-orange-300",mancante:"bg-red-900/30 border-red-600/50 text-red-300"},H={consegnata:e.jsx(be,{size:16}),scaduta:e.jsx(pe,{size:16}),mancante:e.jsx(he,{size:16})},q={consegnata:"Consegnata",scaduta:"Scaduta",mancante:"Mancante"},Ne=z=>{if(!z)return"mancante";const c=new Date;c.setHours(0,0,0,0);const w=new Date(z);w.setHours(0,0,0,0);const C=Math.ceil((w-c)/(1e3*60*60*24));return C<0||C<=7?"scaduta":"consegnata"},ve=({onBack:z,initialFilter:c})=>{var D,n,f,U;const w=xe(),[C,k]=o.useState([]),[$,L]=o.useState(!1),[g,P]=o.useState(""),[u,E]=o.useState(""),[a,h]=o.useState(c||"tutti"),[l,p]=o.useState(null);o.useEffect(()=>{A()},[]),o.useEffect(()=>{c&&h(c)},[c]);const A=async()=>{L(!0);try{const s=I(T,"clients"),r=(await X(s)).docs.map(b=>{const d=b.data();return{id:b.id,name:d.name||"N/D",email:d.email||"",phone:d.phone||"",createdAt:d.createdAt||d.startDate||null,schedaAllenamento:d.schedaAllenamento||{},schedaAlimentazione:d.schedaAlimentazione||{}}});k(r)}catch(s){console.error("Errore nel caricamento dei clienti:",s)}L(!1)},x=s=>!s||!s.scadenza?"mancante":Ne(F(s.scadenza)),i=s=>{if(!s)return null;const t=new Date;t.setHours(0,0,0,0);const r=new Date(F(s));return r.setHours(0,0,0,0),Math.ceil((r-t)/(1e3*60*60*24))},S=s=>{if(!s.createdAt)return!1;const t=F(s.createdAt);return t?Math.ceil((new Date-t)/(1e3*60*60*24))<=7&&x(s.schedaAllenamento)==="mancante"&&x(s.schedaAlimentazione)==="mancante":!1},M=(()=>{let s=C.filter(t=>{var j,N,_,G,W,Y;if(!(t.name.toLowerCase().includes(g.toLowerCase())||t.email.toLowerCase().includes(g.toLowerCase())))return!1;if(a==="nuovi")return S(t);if(a==="alimentazione_scade"){const v=i((j=t.schedaAlimentazione)==null?void 0:j.scadenza);return v!==null&&v>=0&&v<=7}else if(a==="allenamento_scade"){const v=i((N=t.schedaAllenamento)==null?void 0:N.scadenza);return v!==null&&v>=0&&v<=7}else if(a==="scaduti"){const v=i((_=t.schedaAllenamento)==null?void 0:_.scadenza),R=i((G=t.schedaAlimentazione)==null?void 0:G.scadenza);return v!==null&&v<0||R!==null&&R<0}if(!u)return!0;const b=x(t.schedaAllenamento),d=x(t.schedaAlimentazione);if(u==="attiva")return b==="consegnata"&&d==="consegnata";if(u==="scaduta")return b==="scaduta"||d==="scaduta";if(u==="in_scadenza"){const v=i((W=t.schedaAllenamento)==null?void 0:W.scadenza),R=i((Y=t.schedaAlimentazione)==null?void 0:Y.scadenza);return v!==null&&v>=0&&v<=7||R!==null&&R>=0&&R<=7}return!0});return a==="alimentazione_scade"?s.sort((t,r)=>{var j,N;const b=i((j=t.schedaAlimentazione)==null?void 0:j.scadenza)||999,d=i((N=r.schedaAlimentazione)==null?void 0:N.scadenza)||999;return b-d}):a==="allenamento_scade"?s.sort((t,r)=>{var j,N;const b=i((j=t.schedaAllenamento)==null?void 0:j.scadenza)||999,d=i((N=r.schedaAllenamento)==null?void 0:N.scadenza)||999;return b-d}):a==="scaduti"&&s.sort((t,r)=>{var j,N,_,G;const b=Math.min(i((j=t.schedaAllenamento)==null?void 0:j.scadenza)||999,i((N=t.schedaAlimentazione)==null?void 0:N.scadenza)||999),d=Math.min(i((_=r.schedaAllenamento)==null?void 0:_.scadenza)||999,i((G=r.schedaAlimentazione)==null?void 0:G.scadenza)||999);return b-d}),s})();return e.jsxs(y.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-6 max-w-full overflow-x-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:z,className:"text-slate-400 hover:text-slate-200 transition-colors",children:"← Torna indietro"}),e.jsx("h2",{className:"text-2xl font-bold text-slate-100",children:"Lista Clienti"})]}),e.jsx("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-4 mb-6",children:e.jsxs("div",{className:"flex gap-2 overflow-x-auto",children:[e.jsxs("button",{onClick:()=>h("tutti"),className:`px-4 py-2 rounded-lg font-medium transition-colors whitespace-nowrap flex items-center gap-2 ${a==="tutti"?"bg-rose-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:[e.jsx(Z,{size:16}),"Tutti"]}),e.jsxs("button",{onClick:()=>h("nuovi"),className:`px-4 py-2 rounded-lg font-medium transition-colors whitespace-nowrap flex items-center gap-2 ${a==="nuovi"?"bg-blue-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:[e.jsx(se,{size:16}),"Nuovi Clienti (7gg)"]}),e.jsxs("button",{onClick:()=>h("alimentazione_scade"),className:`px-4 py-2 rounded-lg font-medium transition-colors whitespace-nowrap flex items-center gap-2 ${a==="alimentazione_scade"?"bg-yellow-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:[e.jsx(O,{size:16}),"Alimentazione in Scadenza"]}),e.jsxs("button",{onClick:()=>h("allenamento_scade"),className:`px-4 py-2 rounded-lg font-medium transition-colors whitespace-nowrap flex items-center gap-2 ${a==="allenamento_scade"?"bg-yellow-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:[e.jsx(O,{size:16}),"Allenamento in Scadenza"]}),e.jsxs("button",{onClick:()=>h("scaduti"),className:`px-4 py-2 rounded-lg font-medium transition-colors whitespace-nowrap flex items-center gap-2 ${a==="scaduti"?"bg-red-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:[e.jsx(ae,{size:16}),"Scaduti"]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex flex-col sm:flex-row gap-4",children:e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400",size:18}),e.jsx("input",{type:"text",placeholder:"Cerca cliente per nome o email...",value:g,onChange:s=>P(s.target.value),className:"w-full pl-10 pr-4 py-2 bg-slate-800/50 border border-slate-700 rounded-lg text-slate-200 placeholder-slate-500 focus:outline-none focus:border-rose-500"})]})}),a==="tutti"&&e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("span",{className:"text-sm text-slate-400 flex items-center gap-2",children:[e.jsx(Z,{size:16}),"Filtri:"]}),e.jsx("button",{onClick:()=>E(""),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${u===""?"bg-rose-600 text-white":"bg-slate-800 text-slate-300 hover:bg-slate-700"}`,children:"Tutti"}),e.jsx("button",{onClick:()=>E("attiva"),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${u==="attiva"?"bg-emerald-600 text-white":"bg-slate-800 text-slate-300 hover:bg-slate-700"}`,children:"Attiva"}),e.jsx("button",{onClick:()=>E("scaduta"),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${u==="scaduta"?"bg-orange-600 text-white":"bg-slate-800 text-slate-300 hover:bg-slate-700"}`,children:"Scaduta"}),e.jsx("button",{onClick:()=>E("in_scadenza"),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${u==="in_scadenza"?"bg-yellow-600 text-white":"bg-slate-800 text-slate-300 hover:bg-slate-700"}`,children:"In Scadenza (7 giorni)"})]})]}),e.jsx("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg overflow-hidden",children:$?e.jsx("div",{className:"p-8 text-center text-slate-400",children:"Caricamento..."}):M.length===0?e.jsx("div",{className:"p-8 text-center text-slate-400",children:g||u?"Nessun cliente trovato":"Nessun cliente disponibile"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-slate-300",children:"Nome"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-slate-300",children:"Email"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-slate-300",children:"Telefono"}),e.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-slate-300",children:"Scheda Allenamento"}),e.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-slate-300",children:"Scheda Alimentazione"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-700",children:M.map(s=>{var b,d,j,N;const t=x(s.schedaAllenamento),r=x(s.schedaAlimentazione);return e.jsxs("tr",{className:"hover:bg-slate-800/50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("button",{onClick:()=>p(s),className:"text-slate-200 font-medium hover:text-rose-400 transition-colors underline decoration-slate-600 hover:decoration-rose-400",children:s.name})}),e.jsx("td",{className:"px-4 py-3 text-slate-400 text-sm",children:s.email||"-"}),e.jsx("td",{className:"px-4 py-3 text-slate-400 text-sm",children:s.phone||"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:()=>w(`/scheda-allenamento/${s.id}`),className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-medium border cursor-pointer hover:opacity-80 transition-opacity ${B[t]}`,children:[H[t],q[t],((b=s.schedaAllenamento)==null?void 0:b.scadenza)&&t!=="mancante"&&e.jsxs("span",{className:"ml-1 text-[10px] opacity-75",children:["(",(d=F(s.schedaAllenamento.scadenza))==null?void 0:d.toLocaleDateString("it-IT"),")"]})]})})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:()=>w(`/scheda-alimentazione/${s.id}`),className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-medium border cursor-pointer hover:opacity-80 transition-opacity ${B[r]}`,children:[H[r],q[r],((j=s.schedaAlimentazione)==null?void 0:j.scadenza)&&r!=="mancante"&&e.jsxs("span",{className:"ml-1 text-[10px] opacity-75",children:["(",(N=F(s.schedaAlimentazione.scadenza))==null?void 0:N.toLocaleDateString("it-IT"),")"]})]})})})]},s.id)})})]})})}),e.jsx(V,{children:l&&e.jsx(e.Fragment,{children:e.jsx(y.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>p(null),className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs(y.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},onClick:s=>s.stopPropagation(),className:"bg-slate-800 border border-slate-700 rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-slate-800 border-b border-slate-700 p-6 flex items-center justify-between",children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-100",children:"Informazioni Cliente"}),e.jsx("button",{onClick:()=>p(null),className:"p-2 hover:bg-slate-700 rounded-lg transition-colors text-slate-400 hover:text-slate-200",children:e.jsx(J,{size:20})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Nome:"}),e.jsx("span",{className:"text-slate-100 font-semibold",children:l.name})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Email:"}),e.jsx("span",{className:"text-slate-300",children:l.email||"N/D"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Telefono:"}),e.jsx("span",{className:"text-slate-300",children:l.phone||"N/D"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-lg font-semibold text-slate-200 border-b border-slate-700 pb-2",children:"Stato Schede"}),e.jsxs("div",{className:"bg-slate-900/50 border border-slate-700 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium text-slate-300",children:"Scheda Allenamento"}),e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1 rounded-lg text-xs font-medium border ${B[x(l.schedaAllenamento)]}`,children:[H[x(l.schedaAllenamento)],q[x(l.schedaAllenamento)]]})]}),((D=l.schedaAllenamento)==null?void 0:D.scadenza)&&e.jsxs("div",{className:"text-sm text-slate-400",children:[e.jsxs("div",{children:["Scadenza: ",(n=F(l.schedaAllenamento.scadenza))==null?void 0:n.toLocaleDateString("it-IT")]}),e.jsx("div",{className:"mt-1",children:(()=>{const s=i(l.schedaAllenamento.scadenza);return s<0?e.jsxs("span",{className:"text-red-400",children:["Scaduta da ",Math.abs(s)," giorni"]}):s<=7?e.jsxs("span",{className:"text-orange-400",children:["Scade tra ",s," giorni"]}):e.jsxs("span",{className:"text-emerald-400",children:["Scade tra ",s," giorni"]})})()})]})]}),e.jsxs("div",{className:"bg-slate-900/50 border border-slate-700 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium text-slate-300",children:"Scheda Alimentazione"}),e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1 rounded-lg text-xs font-medium border ${B[x(l.schedaAlimentazione)]}`,children:[H[x(l.schedaAlimentazione)],q[x(l.schedaAlimentazione)]]})]}),((f=l.schedaAlimentazione)==null?void 0:f.scadenza)&&e.jsxs("div",{className:"text-sm text-slate-400",children:[e.jsxs("div",{children:["Scadenza: ",(U=F(l.schedaAlimentazione.scadenza))==null?void 0:U.toLocaleDateString("it-IT")]}),e.jsx("div",{className:"mt-1",children:(()=>{const s=i(l.schedaAlimentazione.scadenza);return s<0?e.jsxs("span",{className:"text-red-400",children:["Scaduta da ",Math.abs(s)," giorni"]}):s<=7?e.jsxs("span",{className:"text-orange-400",children:["Scade tra ",s," giorni"]}):e.jsxs("span",{className:"text-emerald-400",children:["Scade tra ",s," giorni"]})})()})]})]})]}),e.jsxs("button",{onClick:()=>{p(null),w(`/client-detail/${l.id}`)},className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-rose-600 hover:bg-rose-700 text-white font-semibold rounded-lg transition-colors",children:[e.jsx(ue,{size:18}),"Visualizza Cliente"]})]})]})})})})]})},ye=["Antipasti","Primi","Secondi","Dolci","Pizze","Bevande","Carne","Condimenti","Formaggi","Frutta","Integratori","Latte","Pane","Pasta","Pesce","Salumi","Uova","Verdura"],ze=({onBack:z})=>{const[c,w]=o.useState(null),[C,k]=o.useState([]),[$,L]=o.useState(!1),[g,P]=o.useState(""),[u,E]=o.useState(!1),[a,h]=o.useState(null),[l,p]=o.useState({nome:"",kcal:"",proteine:"",carboidrati:"",grassi:""});o.useEffect(()=>{c&&A()},[c]);const A=async()=>{L(!0);try{const n=I(T,"alimenti",c,"items"),U=(await X(n)).docs.map(s=>({id:s.id,...s.data()}));k(U)}catch(n){console.error("Errore nel caricamento degli alimenti:",n)}L(!1)},x=async()=>{if(!l.nome||!l.kcal||!l.proteine||!l.carboidrati||!l.grassi){alert("Compila tutti i campi");return}try{const n=I(T,"alimenti",c,"items");await de(n,{nome:l.nome,kcal:parseFloat(l.kcal),proteine:parseFloat(l.proteine),carboidrati:parseFloat(l.carboidrati),grassi:parseFloat(l.grassi),createdAt:new Date}),m(),A()}catch(n){console.error("Errore nell'aggiunta dell'alimento:",n),alert("Errore nell'aggiunta dell'alimento")}},i=async()=>{if(!l.nome||!l.kcal||!l.proteine||!l.carboidrati||!l.grassi){alert("Compila tutti i campi");return}try{const n=K(T,"alimenti",c,"items",a.id);await ce(n,{nome:l.nome,kcal:parseFloat(l.kcal),proteine:parseFloat(l.proteine),carboidrati:parseFloat(l.carboidrati),grassi:parseFloat(l.grassi),updatedAt:new Date}),m(),A()}catch(n){console.error("Errore nell'aggiornamento dell'alimento:",n),alert("Errore nell'aggiornamento dell'alimento")}},S=async n=>{if(confirm("Sei sicuro di voler eliminare questo alimento?"))try{const f=K(T,"alimenti",c,"items",n);await me(f),A()}catch(f){console.error("Errore nell'eliminazione dell'alimento:",f),alert("Errore nell'eliminazione dell'alimento")}},m=()=>{p({nome:"",kcal:"",proteine:"",carboidrati:"",grassi:""}),E(!1),h(null)},M=n=>{h(n),p({nome:n.nome,kcal:n.kcal.toString(),proteine:n.proteine.toString(),carboidrati:n.carboidrati.toString(),grassi:n.grassi.toString()})},D=C.filter(n=>n.nome.toLowerCase().includes(g.toLowerCase()));return c?e.jsxs(y.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-6 max-w-full overflow-x-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:()=>{w(null),m()},className:"text-slate-400 hover:text-slate-200 transition-colors",children:"← Torna alle categorie"}),e.jsx("h2",{className:"text-2xl font-bold text-slate-100",children:c})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400",size:18}),e.jsx("input",{type:"text",placeholder:"Cerca alimento...",value:g,onChange:n=>P(n.target.value),className:"w-full pl-10 pr-4 py-2 bg-slate-800/50 border border-slate-700 rounded-lg text-slate-200 placeholder-slate-500 focus:outline-none focus:border-emerald-500"})]}),e.jsxs("button",{onClick:()=>E(!0),className:"px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg transition-colors flex items-center gap-2",children:[e.jsx(le,{size:18}),"Aggiungi Alimento"]})]}),e.jsx(V,{children:(u||a)&&e.jsxs(y.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-slate-800/50 border border-slate-700 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:a?"Modifica Alimento":"Nuovo Alimento"}),e.jsx("button",{onClick:m,className:"text-slate-400 hover:text-slate-200",children:e.jsx(J,{size:20})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Nome Alimento"}),e.jsx("input",{type:"text",value:l.nome,onChange:n=>p({...l,nome:n.target.value}),className:"w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:border-emerald-500",placeholder:"Es. Petto di pollo"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Kcal (per 100g)"}),e.jsx("input",{type:"number",step:"0.1",value:l.kcal,onChange:n=>p({...l,kcal:n.target.value}),className:"w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:border-emerald-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Proteine (g)"}),e.jsx("input",{type:"number",step:"0.1",value:l.proteine,onChange:n=>p({...l,proteine:n.target.value}),className:"w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:border-emerald-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Carboidrati (g)"}),e.jsx("input",{type:"number",step:"0.1",value:l.carboidrati,onChange:n=>p({...l,carboidrati:n.target.value}),className:"w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:border-emerald-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Grassi (g)"}),e.jsx("input",{type:"number",step:"0.1",value:l.grassi,onChange:n=>p({...l,grassi:n.target.value}),className:"w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:border-emerald-500"})]})]}),e.jsxs("div",{className:"mt-4 flex gap-3",children:[e.jsxs("button",{onClick:a?i:x,className:"px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg transition-colors flex items-center gap-2",children:[e.jsx(ne,{size:18}),a?"Salva Modifiche":"Aggiungi"]}),e.jsx("button",{onClick:m,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-slate-200 rounded-lg transition-colors",children:"Annulla"})]})]})}),e.jsx("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg overflow-hidden",children:$?e.jsx("div",{className:"p-8 text-center text-slate-400",children:"Caricamento..."}):D.length===0?e.jsx("div",{className:"p-8 text-center text-slate-400",children:g?"Nessun alimento trovato":"Nessun alimento in questa categoria"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-slate-300",children:"Nome"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-slate-300",children:"Kcal"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-slate-300",children:"Proteine"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-slate-300",children:"Carboidrati"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-slate-300",children:"Grassi"}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-slate-300",children:"Azioni"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-700",children:D.map(n=>e.jsxs("tr",{className:"hover:bg-slate-800/50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3 text-slate-200",children:n.nome}),e.jsx("td",{className:"px-4 py-3 text-slate-300",children:n.kcal}),e.jsxs("td",{className:"px-4 py-3 text-slate-300",children:[n.proteine,"g"]}),e.jsxs("td",{className:"px-4 py-3 text-slate-300",children:[n.carboidrati,"g"]}),e.jsxs("td",{className:"px-4 py-3 text-slate-300",children:[n.grassi,"g"]}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>M(n),className:"p-2 text-blue-400 hover:bg-blue-600/20 rounded-lg transition-colors",children:e.jsx(ie,{size:16})}),e.jsx("button",{onClick:()=>S(n.id),className:"p-2 text-red-400 hover:bg-red-600/20 rounded-lg transition-colors",children:e.jsx(re,{size:16})})]})})]},n.id))})]})})})]}):e.jsxs(y.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:z,className:"text-slate-400 hover:text-slate-200 transition-colors",children:"← Torna indietro"}),e.jsx("h2",{className:"text-2xl font-bold text-slate-100",children:"Lista Alimenti"})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:ye.map(n=>e.jsx(y.button,{onClick:()=>w(n),whileHover:{scale:1.05},whileTap:{scale:.95},className:"p-6 bg-emerald-900/10 border border-emerald-600/30 hover:bg-emerald-900/20 hover:border-emerald-500/50 rounded-lg transition-all group",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-100 font-medium",children:n}),e.jsx(oe,{size:18,className:"text-emerald-400 group-hover:translate-x-1 transition-transform"})]})},n))})]})},ee=["Bilanciere","Manubri","Macchina","Cavi","Corpo libero","Kettlebell","Bande elastiche","TRX","Palla medica","Swiss ball","Sbarra per trazioni","Panca"],te=["Petto","Schiena","Spalle","Bicipiti","Tricipiti","Gambe","Quadricipiti","Femorali","Polpacci","Glutei","Addominali","Core","Avambracci","Trapezio"],we=({onBack:z})=>{const[c,w]=o.useState([]),[C,k]=o.useState(!1),[$,L]=o.useState(""),[g,P]=o.useState(""),[u,E]=o.useState(""),[a,h]=o.useState(!1),[l,p]=o.useState(null),[A,x]=o.useState(!1),[i,S]=o.useState({nome:"",attrezzo:"",gruppoMuscolare:"",descrizione:"",videoUrl:""});o.useEffect(()=>{m()},[]);const m=async()=>{k(!0);try{const t=I(T,"esercizi"),b=(await X(t)).docs.map(d=>({id:d.id,...d.data()}));w(b)}catch(t){console.error("Errore nel caricamento degli esercizi:",t)}k(!1)},M=async()=>{if(!i.nome||!i.attrezzo||!i.gruppoMuscolare){alert("Compila i campi obbligatori (nome, attrezzo, gruppo muscolare)");return}try{const t=I(T,"esercizi");await de(t,{...i,createdAt:new Date}),f(),m()}catch(t){console.error("Errore nell'aggiunta dell'esercizio:",t),alert("Errore nell'aggiunta dell'esercizio")}},D=async()=>{if(!i.nome||!i.attrezzo||!i.gruppoMuscolare){alert("Compila i campi obbligatori (nome, attrezzo, gruppo muscolare)");return}try{const t=K(T,"esercizi",l.id);await ce(t,{...i,updatedAt:new Date}),f(),m()}catch(t){console.error("Errore nell'aggiornamento dell'esercizio:",t),alert("Errore nell'aggiornamento dell'esercizio")}},n=async t=>{if(confirm("Sei sicuro di voler eliminare questo esercizio?"))try{const r=K(T,"esercizi",t);await me(r),m()}catch(r){console.error("Errore nell'eliminazione dell'esercizio:",r),alert("Errore nell'eliminazione dell'esercizio")}},f=()=>{S({nome:"",attrezzo:"",gruppoMuscolare:"",descrizione:"",videoUrl:""}),h(!1),p(null)},U=t=>{p(t),S({nome:t.nome,attrezzo:t.attrezzo,gruppoMuscolare:t.gruppoMuscolare,descrizione:t.descrizione||"",videoUrl:t.videoUrl||""})},s=c.filter(t=>{const r=t.nome.toLowerCase().includes($.toLowerCase()),b=!g||t.attrezzo===g,d=!u||t.gruppoMuscolare===u;return r&&b&&d});return e.jsxs(y.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-6 max-w-full overflow-x-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:z,className:"text-slate-400 hover:text-slate-200 transition-colors",children:"← Torna indietro"}),e.jsx("h2",{className:"text-2xl font-bold text-slate-100",children:"Lista Esercizi"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400",size:18}),e.jsx("input",{type:"text",placeholder:"Cerca per nome esercizio...",value:$,onChange:t=>L(t.target.value),className:"w-full pl-10 pr-4 py-2 bg-slate-800/50 border border-slate-700 rounded-lg text-slate-200 placeholder-slate-500 focus:outline-none focus:border-blue-500"})]}),e.jsxs("button",{onClick:()=>x(!A),className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-slate-200 rounded-lg transition-colors flex items-center gap-2",children:[e.jsx(Z,{size:18}),"Filtri"]}),e.jsxs("button",{onClick:()=>h(!0),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors flex items-center gap-2",children:[e.jsx(le,{size:18}),"Aggiungi Esercizio"]})]}),e.jsx(V,{children:A&&e.jsxs(y.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"grid grid-cols-1 md:grid-cols-2 gap-4 bg-slate-800/50 border border-slate-700 rounded-lg p-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Filtra per Attrezzo"}),e.jsxs("select",{value:g,onChange:t=>P(t.target.value),className:"w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Tutti gli attrezzi"}),ee.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Filtra per Gruppo Muscolare"}),e.jsxs("select",{value:u,onChange:t=>E(t.target.value),className:"w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Tutti i gruppi"}),te.map(t=>e.jsx("option",{value:t,children:t},t))]})]})]})})]}),e.jsx(V,{children:(a||l)&&e.jsxs(y.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-slate-800/50 border border-slate-700 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:l?"Modifica Esercizio":"Nuovo Esercizio"}),e.jsx("button",{onClick:f,className:"text-slate-400 hover:text-slate-200",children:e.jsx(J,{size:20})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:["Nome Esercizio ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",value:i.nome,onChange:t=>S({...i,nome:t.target.value}),className:"w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:border-blue-500",placeholder:"Es. Panca piana con bilanciere"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:["Attrezzo ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("select",{value:i.attrezzo,onChange:t=>S({...i,attrezzo:t.target.value}),className:"w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Seleziona attrezzo"}),ee.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:["Gruppo Muscolare ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("select",{value:i.gruppoMuscolare,onChange:t=>S({...i,gruppoMuscolare:t.target.value}),className:"w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Seleziona gruppo"}),te.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Descrizione"}),e.jsx("textarea",{value:i.descrizione,onChange:t=>S({...i,descrizione:t.target.value}),rows:"3",className:"w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:border-blue-500",placeholder:"Descrizione dell'esercizio..."})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"URL Video (opzionale)"}),e.jsx("input",{type:"url",value:i.videoUrl,onChange:t=>S({...i,videoUrl:t.target.value}),className:"w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:border-blue-500",placeholder:"https://..."})]})]}),e.jsxs("div",{className:"mt-4 flex gap-3",children:[e.jsxs("button",{onClick:l?D:M,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors flex items-center gap-2",children:[e.jsx(ne,{size:18}),l?"Salva Modifiche":"Aggiungi"]}),e.jsx("button",{onClick:f,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-slate-200 rounded-lg transition-colors",children:"Annulla"})]})]})}),e.jsx("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg overflow-hidden",children:C?e.jsx("div",{className:"p-8 text-center text-slate-400",children:"Caricamento..."}):s.length===0?e.jsx("div",{className:"p-8 text-center text-slate-400",children:$||g||u?"Nessun esercizio trovato":"Nessun esercizio disponibile"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-slate-300",children:"Nome"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-slate-300",children:"Attrezzo"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-slate-300",children:"Gruppo Muscolare"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-slate-300",children:"Descrizione"}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-slate-300",children:"Azioni"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-700",children:s.map(t=>e.jsxs("tr",{className:"hover:bg-slate-800/50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3 text-slate-200 font-medium",children:t.nome}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"px-2 py-1 bg-blue-900/30 border border-blue-600/30 text-blue-300 rounded text-xs",children:t.attrezzo})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"px-2 py-1 bg-purple-900/30 border border-purple-600/30 text-purple-300 rounded text-xs",children:t.gruppoMuscolare})}),e.jsx("td",{className:"px-4 py-3 text-slate-400 text-sm max-w-xs truncate",children:t.descrizione||"-"}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>U(t),className:"p-2 text-blue-400 hover:bg-blue-600/20 rounded-lg transition-colors",children:e.jsx(ie,{size:16})}),e.jsx("button",{onClick:()=>n(t.id),className:"p-2 text-red-400 hover:bg-red-600/20 rounded-lg transition-colors",children:e.jsx(re,{size:16})})]})})]},t.id))})]})})})]})},Ce=()=>{const[z,c]=o.useState(null),[w,C]=o.useState(null),[k,$]=o.useState({nuovi:0,alimentazioneScade:0,allenamentoScade:0,scaduti:0});o.useEffect(()=>{L()},[]);const L=async()=>{try{const a=I(T,"clients"),h=await X(a);let l=0,p=0,A=0,x=0;const i=new Date;i.setHours(0,0,0,0),h.docs.forEach(S=>{var D,n,f,U,s;const m=S.data(),M=m.createdAt||m.startDate;if(M){const t=F(M);t&&Math.ceil((i-t)/864e5)<=7&&!((D=m.schedaAllenamento)!=null&&D.scadenza)&&!((n=m.schedaAlimentazione)!=null&&n.scadenza)&&l++}if((f=m.schedaAlimentazione)!=null&&f.scadenza){const t=new Date(F(m.schedaAlimentazione.scadenza));t.setHours(0,0,0,0);const r=Math.ceil((t-i)/(1e3*60*60*24));r>=0&&r<=7&&p++,r<0&&x++}if((U=m.schedaAllenamento)!=null&&U.scadenza){const t=new Date(F(m.schedaAllenamento.scadenza));t.setHours(0,0,0,0);const r=Math.ceil((t-i)/(1e3*60*60*24));r>=0&&r<=7&&A++,r<0&&!((s=m.schedaAlimentazione)!=null&&s.scadenza)&&x++}}),$({nuovi:l,alimentazioneScade:p,allenamentoScade:A,scaduti:x})}catch(a){console.error("Error loading client stats:",a)}},g=[{id:"clienti",title:"Lista Clienti",description:"Gestisci le schede di allenamento e alimentazione dei tuoi clienti",icon:e.jsx(ge,{size:32}),color:"rose"},{id:"alimenti",title:"Lista Alimenti",description:"Database completo di alimenti con valori nutrizionali",icon:e.jsx(fe,{size:32}),color:"emerald"},{id:"esercizi",title:"Lista Esercizi",description:"Catalogo esercizi con attrezzi e gruppi muscolari",icon:e.jsx(je,{size:32}),color:"blue"}],P=[{id:"nuovi",title:"Nuovi Clienti",count:k.nuovi,description:"Ultimi 7 giorni senza schede",icon:e.jsx(se,{size:24}),color:"blue",filter:"nuovi"},{id:"alimentazione-scade",title:"Alimentazione in Scadenza",count:k.alimentazioneScade,description:"Scadono entro 7 giorni",icon:e.jsx(O,{size:24}),color:"yellow",filter:"alimentazione_scade"},{id:"allenamento-scade",title:"Allenamento in Scadenza",count:k.allenamentoScade,description:"Scadono entro 7 giorni",icon:e.jsx(O,{size:24}),color:"yellow",filter:"allenamento_scade"},{id:"scaduti",title:"Schede Scadute",count:k.scaduti,description:"Richiedono rinnovo urgente",icon:e.jsx(ae,{size:24}),color:"red",filter:"scaduti"}],u=a=>{c(a)},E=a=>{C(a),c("clienti")};return e.jsx("div",{className:"min-h-screen p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs(y.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-8",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-slate-100 mb-2",children:"Alimentazione e Allenamento"}),e.jsx("p",{className:"text-slate-400",children:"Gestisci schede, alimenti ed esercizi in un'unica sezione"})]}),!z&&e.jsxs(e.Fragment,{children:[e.jsxs(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-100 mb-4",children:"Stato Clienti"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:P.map((a,h)=>e.jsxs(y.button,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:h*.05},onClick:()=>E(a.filter),className:`group relative p-6 rounded-xl border transition-all duration-300 hover:scale-105 text-left
                      ${a.color==="blue"?"bg-blue-900/10 border-blue-600/30 hover:bg-blue-900/20 hover:border-blue-500/50":""}
                      ${a.color==="yellow"?"bg-yellow-900/10 border-yellow-600/30 hover:bg-yellow-900/20 hover:border-yellow-500/50":""}
                      ${a.color==="red"?"bg-red-900/10 border-red-600/30 hover:bg-red-900/20 hover:border-red-500/50":""}
                    `,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{className:`
                        ${a.color==="blue"?"text-blue-400":""}
                        ${a.color==="yellow"?"text-yellow-400":""}
                        ${a.color==="red"?"text-red-400":""}
                      `,children:a.icon}),e.jsx("span",{className:`text-3xl font-bold
                        ${a.color==="blue"?"text-blue-300":""}
                        ${a.color==="yellow"?"text-yellow-300":""}
                        ${a.color==="red"?"text-red-300":""}
                      `,children:a.count})]}),e.jsx("h3",{className:"text-base font-bold text-slate-100 mb-1",children:a.title}),e.jsx("p",{className:"text-xs text-slate-400",children:a.description})]},a.id))})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:g.map((a,h)=>e.jsxs(y.button,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3+h*.1},onClick:()=>u(a.id),className:`group relative p-8 rounded-2xl border transition-all duration-300 hover:scale-105 text-left
                    ${a.color==="rose"?"bg-rose-900/10 border-rose-600/30 hover:bg-rose-900/20 hover:border-rose-500/50":""}
                    ${a.color==="emerald"?"bg-emerald-900/10 border-emerald-600/30 hover:bg-emerald-900/20 hover:border-emerald-500/50":""}
                    ${a.color==="blue"?"bg-blue-900/10 border-blue-600/30 hover:bg-blue-900/20 hover:border-blue-500/50":""}
                  `,children:[e.jsx("div",{className:`mb-4 
                    ${a.color==="rose"?"text-rose-400":""}
                    ${a.color==="emerald"?"text-emerald-400":""}
                    ${a.color==="blue"?"text-blue-400":""}
                  `,children:a.icon}),e.jsx("h3",{className:"text-xl font-bold text-slate-100 mb-2",children:a.title}),e.jsx("p",{className:"text-slate-400 text-sm mb-4",children:a.description}),e.jsxs("div",{className:`flex items-center text-sm font-medium group-hover:translate-x-1 transition-transform
                    \${section.color === 'rose' ? 'text-rose-400' : ''}
                    \${section.color === 'emerald' ? 'text-emerald-400' : ''}
                    \${section.color === 'blue' ? 'text-blue-400' : ''}
                  `,children:["Apri ",e.jsx(oe,{size:16,className:"ml-1"})]})]},a.id))})]}),z==="clienti"&&e.jsx(ve,{onBack:()=>{c(null),C(null)},initialFilter:w}),z==="alimenti"&&e.jsx(ze,{onBack:()=>c(null)}),z==="esercizi"&&e.jsx(we,{onBack:()=>c(null)})]})})};export{Ce as default};
