const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MainLayout-DRwUHLC6.js","assets/react-FJB7Hj_2.js","assets/papaparse-BHXrM2Hc.js","assets/react-router-DF4cN2Hx.js","assets/@remix-run-CjG9tKj3.js","assets/framer-motion-Bo7GrDk8.js","assets/motion-dom-C8PdgYBP.js","assets/motion-utils-DBsP9okC.js","assets/lucide-react-BYK_Rxhn.js","assets/ClientLayout-Dvm2EnWs.js","assets/Login-BdQtp5cT.js","assets/firebase-CiybzbB3.js","assets/@firebase-D5dUFubL.js","assets/idb-BXWtuYvb.js","assets/tslib-BGVaTf34.js","assets/react-dom-BrtcLnxQ.js","assets/scheduler-DYLXRpC5.js","assets/react-router-dom-udQfSOCw.js","assets/Dashboard-1q2HIv7q.js","assets/react-chartjs-2-OZwe24ob.js","assets/chart.js-aqGQq52y.js","assets/@kurkle-D8fDXNIl.js","assets/Clients-BdpQb91d.js","assets/NewClient-DYLQoB4E.js","assets/react-hook-form-CR94GzZN.js","assets/ClientDetail-DOBwv1-I.js","assets/EditClient-DtKKQbPj.js","assets/Updates-irRZHaFe.js","assets/AdminChat-BaAuydDF.js","assets/ClientLogin-Nymr-kYJ.js","assets/FirstAccess-C438FpvH.js","assets/ClientDashboard-DlNY2ZZB.js","assets/ClientAnamnesi-BoEffUzJ.js","assets/uuid-CtRu48qb.js","assets/ClientChecks-DgthZv6h.js","assets/react-calendar-Bb9WV09U.js","assets/clsx-B-dksMZM.js","assets/get-user-locale-CTD1oYsn.js","assets/memoize-BZNdjcd3.js","assets/mimic-function-BIlJVoeO.js","assets/@wojtekmaj-CaFejNaN.js","assets/react-calendar-DDKpoaqD.css","assets/ClientPayments-DlkV6O3I.js","assets/ClientChat-GugliKPt.js","assets/ForgotPassword-CHt6WQwE.js","assets/AdminAnamnesi-a2DpDI7V.js","assets/CoachDashboard-BFiGqlgp.js","assets/CoachAnamnesi-Dy3zCBkj.js","assets/CoachUpdates-D5GLhK-m.js","assets/CoachClients-DZYXrJsB.js","assets/CoachChat-DCQoGCPi.js","assets/CoachClientDetail-CdZltykR.js"])))=>i.map(i=>d[i]);
import{R as o,r as x,j as e}from"./react-FJB7Hj_2.js";import{c as L}from"./react-dom-BrtcLnxQ.js";import{H as R}from"./react-router-dom-udQfSOCw.js";import{g as D,o as b}from"./firebase-CiybzbB3.js";import{v as O,w as z,x as T,y as P,z as I,A as S}from"./@firebase-D5dUFubL.js";import{d as V,e as t,f,O as w}from"./react-router-DF4cN2Hx.js";import"./papaparse-BHXrM2Hc.js";import"./scheduler-DYLXRpC5.js";import"./@remix-run-CjG9tKj3.js";import"./tslib-BGVaTf34.js";import"./idb-BXWtuYvb.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))m(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const n of l.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&m(n)}).observe(document,{childList:!0,subtree:!0});function c(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function m(r){if(r.ep)return;r.ep=!0;const l=c(r);fetch(r.href,l)}})();const N="modulepreload",X=function(s){return"/PtPro/"+s},A={},i=function(a,c,m){let r=Promise.resolve();if(c&&c.length>0){document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),d=(n==null?void 0:n.nonce)||(n==null?void 0:n.getAttribute("nonce"));r=Promise.allSettled(c.map(_=>{if(_=X(_),_ in A)return;A[_]=!0;const p=_.endsWith(".css"),h=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${_}"]${h}`))return;const u=document.createElement("link");if(u.rel=p?"stylesheet":N,p||(u.as="script"),u.crossOrigin="",u.href=_,d&&u.setAttribute("nonce",d),document.head.appendChild(u),p)return new Promise((j,E)=>{u.addEventListener("load",j),u.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${_}`)))})}))}function l(n){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=n,window.dispatchEvent(d),!d.defaultPrevented)throw n}return r.then(n=>{for(const d of n||[])d.status==="rejected"&&l(d.reason);return a().catch(l)})},k={apiKey:"AIzaSyDU4GmH6xLhrEd2jSkyATXJOasIyEfisXY",authDomain:"biondo-fitness-coach.firebaseapp.com",projectId:"biondo-fitness-coach",storageBucket:"biondo-fitness-coach.appspot.com",messagingSenderId:"1086406111438",appId:"1:1086406111438:web:1c8c3d9e49f1ffdb77609f",measurementId:"G-869HQ5KGVX"},y=O(k),F=D(y),v=z(y);T(y);const Le=async s=>{const a=P(v,"clients",s),c=await I(a);if(!c.exists())return;const m=c.data().scadenza,r=q(m);await S(a,{statoPercorso:r})},q=s=>{if(!s)return"na";const a=new Date,c=B(s);if(!c)return"na";const m=Math.ceil((c-a)/(1e3*60*60*24));return m<0?"non_rinnovato":m<=7?"rinnovato":"attivo"},B=s=>{if(!s)return null;if(typeof(s==null?void 0:s.toDate)=="function")return s.toDate();const a=new Date(s);return isNaN(a)?null:a},C=o.lazy(()=>i(()=>import("./MainLayout-DRwUHLC6.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),G=o.lazy(()=>i(()=>import("./ClientLayout-Dvm2EnWs.js"),__vite__mapDeps([9,1,2,3,4]))),H=o.lazy(()=>i(()=>import("./Login-BdQtp5cT.js"),__vite__mapDeps([10,1,2,11,12,13,14,3,4,5,6,7,8,15,16,17]))),K=o.lazy(()=>i(()=>import("./Dashboard-1q2HIv7q.js"),__vite__mapDeps([18,1,2,12,13,11,14,19,20,21,3,4,5,6,7,8,15,16,17]))),Q=o.lazy(()=>i(()=>import("./Clients-BdpQb91d.js"),__vite__mapDeps([22,1,2,12,13,11,14,3,4,5,6,7,8,15,16,17]))),W=o.lazy(()=>i(()=>import("./NewClient-DYLQoB4E.js"),__vite__mapDeps([23,1,2,24,11,12,13,14,3,4,5,6,7,8,15,16,17]))),$=o.lazy(()=>i(()=>import("./ClientDetail-DOBwv1-I.js"),__vite__mapDeps([25,1,2,12,13,3,4,5,6,7,8,15,16,17,11,14]))),J=o.lazy(()=>i(()=>import("./EditClient-DtKKQbPj.js"),__vite__mapDeps([26,1,2,24,12,13,3,4,5,6,7,8,15,16,17,11,14]))),M=o.lazy(()=>i(()=>import("./Updates-irRZHaFe.js"),__vite__mapDeps([27,1,2,12,13,3,4,5,6,7,8,15,16,17,11,14]))),U=o.lazy(()=>i(()=>import("./AdminChat-BaAuydDF.js"),__vite__mapDeps([28,1,2,11,12,13,14,8,5,6,7,15,16,17,3,4]))),Y=o.lazy(()=>i(()=>import("./ClientLogin-Nymr-kYJ.js"),__vite__mapDeps([29,1,2,17,15,16,3,4,11,12,13,14,5,6,7,8]))),Z=o.lazy(()=>i(()=>import("./FirstAccess-C438FpvH.js"),__vite__mapDeps([30,1,2,11,12,13,14,3,4,5,6,7,8,15,16,17]))),ee=o.lazy(()=>i(()=>import("./ClientDashboard-DlNY2ZZB.js"),__vite__mapDeps([31,1,2,11,12,13,14,17,15,16,3,4,5,6,7,8]))),te=o.lazy(()=>i(()=>import("./ClientAnamnesi-BoEffUzJ.js"),__vite__mapDeps([32,1,2,24,11,12,13,14,3,4,8,5,6,7,33,15,16,17]))),se=o.lazy(()=>i(()=>import("./ClientChecks-DgthZv6h.js"),__vite__mapDeps([34,1,2,11,12,13,14,35,36,37,38,39,40,41,3,4,8,5,6,7,33,15,16,17]))),oe=o.lazy(()=>i(()=>import("./ClientPayments-DlkV6O3I.js"),__vite__mapDeps([42,1,2,11,12,13,14,3,4,5,6,7,8,15,16,17]))),ne=o.lazy(()=>i(()=>import("./ClientChat-GugliKPt.js"),__vite__mapDeps([43,1,2,11,12,13,14,3,4,8,5,6,7,15,16,17]))),ie=o.lazy(()=>i(()=>import("./ForgotPassword-CHt6WQwE.js"),__vite__mapDeps([44,1,2,11,12,13,14,17,15,16,3,4,5,6,7,8]))),re=o.lazy(()=>i(()=>import("./AdminAnamnesi-a2DpDI7V.js"),__vite__mapDeps([45,1,2,12,13,3,4,8,5,6,7,15,16,17,11,14]))),ae=o.lazy(()=>i(()=>import("./CoachDashboard-BFiGqlgp.js"),__vite__mapDeps([46,1,2,12,13,11,14,3,4,5,6,7,8,15,16,17]))),ce=o.lazy(()=>i(()=>import("./CoachAnamnesi-Dy3zCBkj.js"),__vite__mapDeps([47,1,2,12,13,3,4,5,6,7,8,15,16,17,11,14]))),le=o.lazy(()=>i(()=>import("./CoachUpdates-D5GLhK-m.js"),__vite__mapDeps([48,1,2,12,13,3,4,5,6,7,8,15,16,17,11,14]))),de=o.lazy(()=>i(()=>import("./CoachClients-DZYXrJsB.js"),__vite__mapDeps([49,1,2,12,13,3,4,5,6,7,8,15,16,17,11,14]))),ue=o.lazy(()=>i(()=>import("./CoachChat-DCQoGCPi.js"),__vite__mapDeps([50,1,2,11,12,13,14,3,4,8,5,6,7,15,16,17]))),me=o.lazy(()=>i(()=>import("./CoachClientDetail-CdZltykR.js"),__vite__mapDeps([51,1,2,12,13,3,4,5,6,7,8,15,16,17,11,14]))),_e=()=>e.jsx("div",{className:"flex justify-center items-center h-screen w-full bg-zinc-950",children:e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-rose-500"})}),pe=()=>e.jsxs("div",{className:"flex flex-col justify-center items-center min-h-screen bg-zinc-950 text-slate-200",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-rose-500"}),e.jsx("p",{className:"mt-4 text-sm",children:"Caricamento autenticazione..."})]}),g=({isAllowed:s,redirectPath:a,children:c})=>s?c||e.jsx(w,{}):(console.log("Accesso negato, reindirizzamento a:",a),e.jsx(f,{to:a,replace:!0}));function he(){const[s,a]=x.useState({isLoading:!0,user:null,isClient:!1,isCoach:!1}),[c,m]=x.useState(!1);return x.useEffect(()=>{let r=!0;const l=b(F,async n=>{if(!(!r||c)){if(m(!0),console.log("onAuthStateChanged:",n?`Utente autenticato: ${n.uid}`:"Nessun utente autenticato"),n){const d=sessionStorage.getItem("app_role"),_=P(v,"clients",n.uid);try{await new Promise(E=>setTimeout(E,500));const p=await I(_),h=p.exists()&&p.data().isClient===!0,u=n.uid==="l0RI8TzFjbNVoAdmcXNQkP9mWb12",j=["QwWST9OVOlTOi5oheyCqfpXLOLg2","3j0AXIRa4XdHq1ywCl4UBxJNsku2","AeZKjJYu5zMZ4mvffaGiqCBb0cF2"].includes(n.uid);console.log("Ruolo utente:",{isClient:h,isCoach:u,isAdmin:j,sessionRole:d}),d&&d!==(h?"client":u?"coach":"admin")&&(console.log("Conflitto ruolo, reset sessionStorage:",d),sessionStorage.removeItem("app_role")),u?sessionStorage.setItem("app_role","coach"):h?sessionStorage.setItem("app_role","client"):j&&sessionStorage.setItem("app_role","admin"),a({isLoading:!1,user:n,isClient:h,isCoach:u})}catch(p){console.error("Errore nel recupero del documento cliente:",p),a({isLoading:!1,user:n,isClient:!1,isCoach:n.uid==="l0RI8TzFjbNVoAdmcXNQkP9mWb12"})}}else sessionStorage.removeItem("app_role"),a({isLoading:!1,user:null,isClient:!1,isCoach:!1});m(!1)}});return()=>{r=!1,l()}},[c]),s.isLoading?e.jsx(pe,{}):e.jsx(R,{children:e.jsx(x.Suspense,{fallback:e.jsx(_e,{}),children:e.jsxs(V,{children:[e.jsx(t,{path:"/login",element:e.jsx(H,{})}),e.jsx(t,{path:"/client-login",element:e.jsx(Y,{})}),e.jsx(t,{path:"/client/forgot-password",element:e.jsx(ie,{})}),e.jsx(t,{element:e.jsx(g,{isAllowed:s.user&&!s.isClient&&!s.isCoach,redirectPath:"/login"}),children:e.jsxs(t,{element:e.jsx(C,{}),children:[e.jsx(t,{path:"/",element:e.jsx(K,{})}),e.jsx(t,{path:"/clients",element:e.jsx(Q,{})}),e.jsx(t,{path:"/new",element:e.jsx(W,{})}),e.jsx(t,{path:"/client/:clientId",element:e.jsx($,{})}),e.jsx(t,{path:"/edit/:clientId",element:e.jsx(J,{})}),e.jsx(t,{path:"/updates",element:e.jsx(M,{})}),e.jsx(t,{path:"/chat",element:e.jsx(U,{})}),e.jsx(t,{path:"/admin/anamnesi/:uid",element:e.jsx(re,{})})]})}),e.jsx(t,{element:e.jsx(g,{isAllowed:s.user&&s.isClient,redirectPath:"/client-login"}),children:e.jsxs(t,{element:e.jsx(G,{}),children:[e.jsx(t,{path:"/client/first-access",element:e.jsx(Z,{})}),e.jsx(t,{path:"/client/dashboard",element:e.jsx(ee,{})}),e.jsx(t,{path:"/client/anamnesi",element:e.jsx(te,{})}),e.jsx(t,{path:"/client/checks",element:e.jsx(se,{})}),e.jsx(t,{path:"/client/payments",element:e.jsx(oe,{})}),e.jsx(t,{path:"/client/chat",element:e.jsx(ne,{})})]})}),e.jsx(t,{element:e.jsx(g,{isAllowed:s.user&&s.isCoach,redirectPath:"/login"}),children:e.jsxs(t,{element:e.jsx(C,{}),children:[e.jsx(t,{path:"/coach-dashboard",element:e.jsx(ae,{})}),e.jsx(t,{path:"/coach/anamnesi",element:e.jsx(ce,{})}),e.jsx(t,{path:"/coach/updates",element:e.jsx(le,{})}),e.jsx(t,{path:"/coach/clients",element:e.jsx(de,{})}),e.jsx(t,{path:"/coach/chat",element:e.jsx(ue,{})}),e.jsx(t,{path:"/coach/client/:clientId",element:e.jsx(me,{})})]})}),e.jsx(t,{path:"*",element:s.user?s.isClient?e.jsx(f,{to:"/client/dashboard"}):s.isCoach?e.jsx(f,{to:"/coach-dashboard"}):e.jsx(f,{to:"/"}):e.jsx(f,{to:"/login"})})]})})})}L.createRoot(document.getElementById("root")).render(e.jsx(o.StrictMode,{children:e.jsx(he,{})}));export{F as a,q as c,v as d,k as f,B as t,Le as u};
