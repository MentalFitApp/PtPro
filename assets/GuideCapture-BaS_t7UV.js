import{j as e,r as o}from"./react-CrXOBDSJ.js";import{A as v,B as T,V as $,I as F,D as O}from"./@firebase-CuwLCerw.js";import{d as b}from"./index-CYfn4HI_.js";import{m as d}from"./framer-motion-BAPjnw1b.js";import{g as A,a as U}from"./react-router-BxpCmtJ-.js";import{a7 as N,j as k,a8 as z,a9 as C,aa as V,ab as B,x as _,G as W,e as q,h as H,C as J}from"./lucide-react-CCY59hBS.js";import"./core-js-ChGsxLo2.js";import"./idb-Bn1DMRyg.js";import"./react-dom-BpmKF3Ga.js";import"./scheduler-DYLXRpC5.js";import"./react-router-dom-9rcY47vU.js";import"./@remix-run-CjG9tKj3.js";import"./jspdf-7Jyqi_bl.js";import"./@babel-Cvov1XSu.js";import"./fflate-XZmX483V.js";import"./fast-png-CUrN0NP5.js";import"./iobuffer-DZ1zOcUT.js";import"./pako-B9FS3IR_.js";import"./firebase-Bp3EI6Ad.js";import"./tslib-BGVaTf34.js";import"./motion-dom-C8PdgYBP.js";import"./motion-utils-DBsP9okC.js";const K=()=>{const[n,u]=o.useState(!1);return o.useEffect(()=>{if(n)return;const s=document.createElement("div");s.className="stars",document.body.appendChild(s);for(let l=0;l<25;l++){const a=document.createElement("div");a.className="star";const c=l%5===0?1:l%3===0?2:3;a.style.setProperty("--star-width",`${c}px`),a.style.setProperty("--top-offset",`${Math.random()*100}vh`),a.style.setProperty("--fall-duration",`${10+Math.random()*10}s`),a.style.setProperty("--fall-delay",`${Math.random()*8}s`),l%5===0&&a.classList.add("gold"),s.appendChild(a)}u(!0)},[n]),null};function j({children:n}){return e.jsxs("div",{className:"relative min-h-screen w-full overflow-hidden",children:[e.jsx("div",{className:"starry-background"}),e.jsx(K,{}),e.jsx(d.div,{initial:{opacity:0,scale:.98},animate:{opacity:1,scale:1},transition:{duration:.4},className:"relative z-10 w-full max-w-2xl mx-auto p-4 pt-8",children:e.jsxs("div",{className:"relative p-2",children:[e.jsxs("div",{className:"absolute inset-0 rounded-xl overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 border-2 border-transparent rounded-xl animate-glow-line-1"}),e.jsx("div",{className:"absolute inset-0 border-2 border-transparent rounded-xl animate-glow-line-2"})]}),e.jsx("div",{className:"relative bg-slate-900/45 backdrop-blur-xl border border-white/10 rounded-xl p-8 shadow-2xl",children:n})]})})]})}function be(){const{guideId:n}=A(),u=U(),[s,l]=o.useState(null),[a,c]=o.useState({nome:"",telefono:"",email:"",instagram:""}),[m,w]=o.useState(!1),[D,S]=o.useState(!1),[p,f]=o.useState(null),[y,E]=o.useState(null);o.useEffect(()=>{(async()=>{try{const r=v(b,"guides",n),i=await T(r);i.exists()&&i.data().active?l({id:i.id,...i.data()}):u("/not-found")}catch(r){console.error("Errore caricamento guida:",r),u("/not-found")}})()},[n,u]);const M=async()=>{var t;if(!a.nome||!a.telefono||!a.email)return alert("Compila Nome, Telefono ed Email");w(!0);try{const i=(await $(F(b,"guideLeads"),{guideId:n,nome:a.nome.trim(),telefono:a.telefono.trim(),email:a.email.trim(),instagram:((t=a.instagram)==null?void 0:t.trim())||"",wantsPromo:!1,contactMethod:null,timestamp:new Date,dialed:!1,showUp:!1,chiuso:!1,importo:0})).id;E(i),s.postMessage||s.countdownDate?S(!0):g()}catch(r){console.error("Errore salvataggio lead:",r),alert("Errore salvataggio. Riprova.")}finally{w(!1)}},g=()=>{const t=s==null?void 0:s.redirectUrl;t&&/^https?:\/\//.test(t)?window.location.href=t:alert("Link non valido.")},I=async()=>{if(p===null)return alert("Scegli un'opzione");if(!y){console.warn("Lead ID mancante, procedo senza aggiornare"),g();return}try{await O(v(b,"guideLeads",y),{wantsPromo:p!=="no",contactMethod:p})}catch(t){console.error("Errore updateDoc (non bloccante):",t)}finally{g()}},L=({targetDate:t})=>{const[r,i]=o.useState("");return o.useEffect(()=>{if(!t)return;const x=setInterval(()=>{const h=new Date(t)-new Date;if(h<=0){i("SCADUTO"),clearInterval(x);return}const P=Math.floor(h/(1e3*60*60*24)),R=Math.floor(h%(1e3*60*60*24)/(1e3*60*60)),G=Math.floor(h%(1e3*60*60)/(1e3*60));i(`${P}g ${R}h ${G}m`)},1e3);return()=>clearInterval(x)},[t]),e.jsxs("div",{className:"flex items-center gap-2 text-amber-300 font-mono text-sm",children:[e.jsx(k,{size:16}),e.jsx("span",{className:"font-bold",children:r})]})};return s?D?e.jsx(j,{children:e.jsxs("div",{className:"max-w-lg mx-auto mt-8 space-y-6 px-4",children:[s.postMessage&&e.jsx(d.div,{initial:{opacity:0,y:15},animate:{opacity:1,y:0},className:"bg-gradient-to-r from-rose-600/20 to-purple-600/20 backdrop-blur-xl border border-rose-500/30 rounded-xl p-5 text-center shadow-xl",children:e.jsx("p",{className:"text-white text-sm leading-relaxed font-bold",children:s.postMessage})}),s.countdownDate&&new Date(s.countdownDate)>new Date&&e.jsxs(d.div,{initial:{opacity:0,y:15},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-gradient-to-r from-amber-600/20 to-orange-600/20 backdrop-blur-xl border border-amber-500/30 rounded-xl p-4 text-center shadow-lg",children:[e.jsxs("p",{className:"text-amber-300 text-xs font-bold flex items-center justify-center gap-1",children:[e.jsx(k,{size:14}),s.urgencyText||"Offerta a tempo limitato!"]}),e.jsx(L,{targetDate:s.countdownDate})]}),e.jsxs(d.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-white/10 backdrop-blur-xl border border-white/20 rounded-xl p-6 shadow-2xl",children:[e.jsxs("h3",{className:"text-xl font-bold text-emerald-400 text-center mb-3 flex items-center justify-center gap-2",children:[e.jsx(z,{size:20,className:"text-amber-300"}),"Offerta Esclusiva"]}),e.jsxs("p",{className:"text-white text-sm text-center mb-5 font-medium",children:["Vuoi ricevere ",e.jsx("strong",{className:"text-emerald-300",children:"maggiori informazioni"})," via:"]}),e.jsxs("div",{className:"space-y-3 mb-5",children:[e.jsxs("label",{className:"flex items-center gap-3 p-4 bg-gradient-to-r from-purple-600/20 to-pink-600/20 backdrop-blur-sm rounded-lg hover:from-purple-600/30 hover:to-pink-600/30 cursor-pointer transition-all border border-purple-500/30",children:[e.jsx("input",{type:"radio",name:"contact",checked:p==="instagram",onChange:()=>f("instagram"),className:"w-5 h-5 text-purple-500"}),e.jsx(C,{size:18,className:"text-purple-400"}),e.jsx("span",{className:"text-white text-sm font-medium",children:"Instagram"})]}),e.jsxs("label",{className:"flex items-center gap-3 p-4 bg-gradient-to-r from-green-600/20 to-emerald-600/20 backdrop-blur-sm rounded-lg hover:from-green-600/30 hover:to-emerald-600/30 cursor-pointer transition-all border border-green-500/30",children:[e.jsx("input",{type:"radio",name:"contact",checked:p==="whatsapp",onChange:()=>f("whatsapp"),className:"w-5 h-5 text-emerald-500"}),e.jsx(V,{size:18,className:"text-emerald-400"}),e.jsx("span",{className:"text-white text-sm font-medium",children:"WhatsApp"})]}),e.jsxs("label",{className:"flex items-center gap-3 p-4 bg-white/5 backdrop-blur-sm rounded-lg hover:bg-white/10 cursor-pointer transition-all border border-white/10",children:[e.jsx("input",{type:"radio",name:"contact",checked:p==="no",onChange:()=>f("no"),className:"w-5 h-5 text-red-400"}),e.jsx("span",{className:"text-white text-sm font-medium",children:"No, grazie"})]})]}),e.jsxs("button",{onClick:I,className:"w-full bg-gradient-to-r from-emerald-600 to-cyan-600 text-white font-bold py-3 rounded-lg hover:from-emerald-700 hover:to-cyan-700 transition-all flex items-center justify-center gap-2 shadow-lg",children:[e.jsx(z,{size:18}),"Vai alla Guida",e.jsx(B,{size:18})]})]})]})}):e.jsx(j,{children:e.jsxs("div",{className:"max-w-lg mx-auto mt-8 space-y-6 px-4",children:[e.jsx(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center",children:e.jsxs("h1",{className:"text-2xl md:text-3xl font-bold text-white leading-tight",children:["Ricevi la guida ",e.jsxs("span",{className:"text-cyan-400",children:["“",s.name,"”"]})]})}),e.jsxs(d.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.1},className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(_,{className:"absolute left-3 top-3.5 text-slate-300",size:18}),e.jsx("input",{type:"text",placeholder:"Nome *",value:a.nome,onChange:t=>c({...a,nome:t.target.value}),className:"w-full pl-10 pr-4 py-3 bg-white/5 border border-white/30 rounded-lg text-white placeholder-slate-300 focus:outline-none focus:border-cyan-400 transition-all font-medium",disabled:m})]}),e.jsxs("div",{className:"relative",children:[e.jsx(W,{className:"absolute left-3 top-3.5 text-slate-300",size:18}),e.jsx("input",{type:"tel",placeholder:"Telefono *",value:a.telefono,onChange:t=>c({...a,telefono:t.target.value}),className:"w-full pl-10 pr-4 py-3 bg-white/5 border border-white/30 rounded-lg text-white placeholder-slate-300 focus:outline-none focus:border-cyan-400 transition-all font-medium",disabled:m})]}),e.jsxs("div",{className:"relative",children:[e.jsx(q,{className:"absolute left-3 top-3.5 text-slate-300",size:18}),e.jsx("input",{type:"email",placeholder:"Email *",value:a.email,onChange:t=>c({...a,email:t.target.value}),className:"w-full pl-10 pr-4 py-3 bg-white/5 border border-white/30 rounded-lg text-white placeholder-slate-300 focus:outline-none focus:border-cyan-400 transition-all font-medium",disabled:m})]}),e.jsxs("div",{className:"relative",children:[e.jsx(C,{className:"absolute left-3 top-3.5 text-slate-300",size:18}),e.jsx("input",{type:"text",placeholder:"Instagram (opzionale)",value:a.instagram,onChange:t=>c({...a,instagram:t.target.value}),className:"w-full pl-10 pr-4 py-3 bg-white/5 border border-white/30 rounded-lg text-white placeholder-slate-300 focus:outline-none focus:border-cyan-400 transition-all font-medium",disabled:m})]}),e.jsx("button",{onClick:M,disabled:m,className:"w-full mt-5 bg-gradient-to-r from-emerald-600 to-cyan-600 text-white font-bold py-3 rounded-lg hover:from-emerald-700 hover:to-cyan-700 transition-all flex items-center justify-center gap-2 shadow-lg disabled:opacity-70",children:m?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"animate-spin",size:20}),"Salvataggio..."]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{size:20}),"Ricevi la Guida Ora"]})})]}),e.jsxs("div",{className:"space-y-4 mt-8",children:[e.jsx("h2",{className:"text-lg font-bold text-white text-center",children:"Ecco alcune trasformazioni ottenute da chi si è affidato al team MentalFit!"}),[{kg:"-27 kg",mesi:"9",link:"https://mauriziobiondopt.it/#testimonianza1"},{kg:"Fisico Nuovo",mesi:"6",link:"https://mauriziobiondopt.it/#testimonianza2"},{kg:"-10 kg",mesi:"5",link:"https://mauriziobiondopt.it/#testimonianza3"},{kg:"-26 kg",mesi:"8",link:"https://mauriziobiondopt.it/#testimonianza4"}].map((t,r)=>e.jsx(d.a,{href:t.link,target:"_blank",rel:"noopener noreferrer",onClick:i=>{window.open(t.link,"_blank")||(i.preventDefault(),alert("Popup bloccato. Copia il link: "+t.link))},initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:r*.1},className:"block bg-white/10 backdrop-blur-xl rounded-lg p-4 border border-white/20 hover:bg-white/15 transition-all group shadow-md cursor-pointer",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-cyan-400 font-bold text-lg",children:t.kg}),e.jsxs("p",{className:"text-white text-sm font-medium",children:["in ",t.mesi," mesi"]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-emerald-400 group-hover:text-emerald-300 text-xs font-medium",children:[e.jsx("span",{children:"Vedi trasformazione"}),e.jsx(J,{size:16})]})]})},r))]})]})}):e.jsx(j,{children:e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-white flex items-center gap-3",children:[e.jsx(N,{className:"animate-spin",size:24}),e.jsx("span",{className:"text-lg font-medium",children:"Caricamento guida..."})]})})})}export{be as default};
