const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MainLayout-BhUG4kRc.js","assets/react-CrXOBDSJ.js","assets/core-js-ChGsxLo2.js","assets/react-router-BxpCmtJ-.js","assets/@remix-run-CjG9tKj3.js","assets/framer-motion-BAPjnw1b.js","assets/motion-dom-C8PdgYBP.js","assets/motion-utils-DBsP9okC.js","assets/lucide-react-KKSnr5ly.js","assets/ClientLayout-7T0p8bQs.js","assets/GuidaLayout-ClZhG-wP.js","assets/Login-BC51O4YS.js","assets/firebase-CCo3Hvf0.js","assets/@firebase-Dy5qmm0I.js","assets/idb-Bn1DMRyg.js","assets/tslib-BGVaTf34.js","assets/react-dom-BpmKF3Ga.js","assets/scheduler-DYLXRpC5.js","assets/react-router-dom-9rcY47vU.js","assets/jspdf-7Jyqi_bl.js","assets/@babel-Cvov1XSu.js","assets/fflate-XZmX483V.js","assets/fast-png-CUrN0NP5.js","assets/iobuffer-DZ1zOcUT.js","assets/pako-B9FS3IR_.js","assets/Dashboard-PcgdvQf0.js","assets/react-chartjs-2-DgEolIMQ.js","assets/chart.js-m_wzuIQ6.js","assets/@kurkle-D8fDXNIl.js","assets/Clients-Rx52nLtN.js","assets/papaparse-rLJvb3Z-.js","assets/date-fns-K6w5eF5u.js","assets/ClientDetail-DQSUy63D.js","assets/EditClient-CazTH5DQ.js","assets/react-hook-form-yCRcHKQw.js","assets/Updates-XNo2sjRx.js","assets/AdminChat-DyFrRK8Z.js","assets/FirstAccess-mwr7Kms_.js","assets/ClientDashboard-B9Yxzxtt.js","assets/ClientAnamnesi-DyqeCLPH.js","assets/uuid-CtRu48qb.js","assets/ClientChecks-DUZLOXwt.js","assets/react-calendar-fvZi8T_s.js","assets/clsx-B-dksMZM.js","assets/get-user-locale-CTD1oYsn.js","assets/memoize-BZNdjcd3.js","assets/mimic-function-BIlJVoeO.js","assets/@wojtekmaj-CaFejNaN.js","assets/react-calendar-DDKpoaqD.css","assets/ClientPayments-UI4SznOe.js","assets/ClientChat-Cy0Gzk3o.js","assets/ForgotPassword-HDFVBXtt.js","assets/AdminAnamnesi-D514QGBn.js","assets/CoachDashboard-D8FjZp00.js","assets/CoachAnamnesi-CBYM8LSQ.js","assets/CoachUpdates-BqZ11CR8.js","assets/CoachClients-CcE1Hn5-.js","assets/CoachChat-CS99SWIx.js","assets/CoachClientDetail-Cx1UPm0N.js","assets/GuidaMentalFit-D1iZKz7X.js","assets/html2canvas-CBrSDip1.js","assets/BusinessHistory-CB7nWZtd.js","assets/Collaboratori-CKpmTclV.js","assets/CollaboratoreDashboard-UhHtEja6.js","assets/CollaboratoreDetail-RcMyEEDD.js","assets/CalendarReport-Dc53woG_.js","assets/NewClient-Dt6nS5k8.js","assets/Dipendenti-vIvX37Ul.js","assets/GuideCapture-DZjh63xr.js","assets/GuideManager-CFib0N-0.js","assets/Statistiche-B8_MHAXk.js","assets/CalendarPage-P_1S-1TK.js"])))=>i.map(i=>d[i]);
import{R as s,r as E,j as e}from"./react-CrXOBDSJ.js";import{c as W}from"./react-dom-BpmKF3Ga.js";import{H as G}from"./react-router-dom-9rcY47vU.js";import{_ as o}from"./jspdf-7Jyqi_bl.js";import{g as H,o as M}from"./firebase-CCo3Hvf0.js";import{v as F,w as B,x as K,y as b,z as y,A as X,B as U}from"./@firebase-Dy5qmm0I.js";import{a as k,b as q,d as J,e as a,f as D}from"./react-router-BxpCmtJ-.js";import"./core-js-ChGsxLo2.js";import"./scheduler-DYLXRpC5.js";import"./@remix-run-CjG9tKj3.js";import"./@babel-Cvov1XSu.js";import"./fflate-XZmX483V.js";import"./fast-png-CUrN0NP5.js";import"./iobuffer-DZ1zOcUT.js";import"./pako-B9FS3IR_.js";import"./tslib-BGVaTf34.js";import"./idb-Bn1DMRyg.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))c(n);new MutationObserver(n=>{for(const t of n)if(t.type==="childList")for(const p of t.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&c(p)}).observe(document,{childList:!0,subtree:!0});function l(n){const t={};return n.integrity&&(t.integrity=n.integrity),n.referrerPolicy&&(t.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?t.credentials="include":n.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function c(n){if(n.ep)return;n.ep=!0;const t=l(n);fetch(n.href,t)}})();const Q={apiKey:"AIzaSyDU4GmH6xLhrEd2jSkyATXJOasIyEfisXY",authDomain:"biondo-fitness-coach.firebaseapp.com",projectId:"biondo-fitness-coach",storageBucket:"biondo-fitness-coach.firebasestorage.app",messagingSenderId:"1086406111438",appId:"1:1086406111438:web:1c8c3d9e49f1ffdb77609f",measurementId:"G-869HQ5KGVX"},R=F(Q),Y=H(R),A=B(R),$e=K(R),et=async i=>{try{const r=b(A,"clients",i),l=await y(r);if(!l.exists())return;const c=l.data().scadenza,n=Z(c);await X(r,{statoPercorso:n})}catch(r){console.error("Errore in updateStatoPercorso:",r)}},Z=i=>{if(!i)return"N/D";const r=$(i);if(!r)return"N/D";const l=new Date;l.setHours(0,0,0,0),r.setHours(0,0,0,0);const c=Math.ceil((r-l)/(1e3*60*60*24));return c<0?"Scaduto":c<=7?"In scadenza":"Attivo"},$=i=>{if(!i)return null;if(typeof(i==null?void 0:i.toDate)=="function")return i.toDate();if(i instanceof Date)return i;if(typeof i=="string")try{const r=new Date(i);return isNaN(r.getTime())?null:r}catch{return null}if(typeof i=="number"){const r=new Date(i);return isNaN(r.getTime())?null:r}return null},C=s.lazy(()=>o(()=>import("./MainLayout-BhUG4kRc.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),ee=s.lazy(()=>o(()=>import("./ClientLayout-7T0p8bQs.js"),__vite__mapDeps([9,1,2,3,4]))),te=s.lazy(()=>o(()=>import("./GuidaLayout-ClZhG-wP.js"),__vite__mapDeps([10,1,2,3,4]))),ae=s.lazy(()=>o(()=>import("./Login-BC51O4YS.js"),__vite__mapDeps([11,1,2,12,13,14,15,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24]))),se=s.lazy(()=>o(()=>import("./Dashboard-PcgdvQf0.js"),__vite__mapDeps([25,1,2,13,14,12,15,26,27,28,3,4,8,5,6,7,16,17,18,19,20,21,22,23,24]))),oe=s.lazy(()=>o(()=>import("./Clients-Rx52nLtN.js"),__vite__mapDeps([29,1,2,13,14,12,15,30,3,4,31,20,8,5,6,7,16,17,18,19,21,22,23,24]))),ie=s.lazy(()=>o(()=>import("./ClientDetail-DQSUy63D.js"),__vite__mapDeps([32,1,2,13,14,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24,12,15]))),re=s.lazy(()=>o(()=>import("./EditClient-CazTH5DQ.js"),__vite__mapDeps([33,1,2,34,13,14,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24,12,15]))),ne=s.lazy(()=>o(()=>import("./Updates-XNo2sjRx.js"),__vite__mapDeps([35,1,2,13,14,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24,12,15]))),le=s.lazy(()=>o(()=>import("./AdminChat-DyFrRK8Z.js"),__vite__mapDeps([36,1,2,12,13,14,15,8,5,6,7,16,17,18,3,4,19,20,21,22,23,24]))),O=s.lazy(()=>o(()=>import("./FirstAccess-mwr7Kms_.js"),__vite__mapDeps([37,1,2,12,13,14,15,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24]))),ce=s.lazy(()=>o(()=>import("./ClientDashboard-B9Yxzxtt.js"),__vite__mapDeps([38,1,2,12,13,14,15,18,16,17,3,4,8,5,6,7,19,20,21,22,23,24]))),de=s.lazy(()=>o(()=>import("./ClientAnamnesi-DyqeCLPH.js"),__vite__mapDeps([39,1,2,34,12,13,14,15,3,4,8,5,6,7,40,16,17,18,19,20,21,22,23,24]))),V=s.lazy(()=>o(()=>import("./ClientChecks-DUZLOXwt.js"),__vite__mapDeps([41,1,2,12,13,14,15,42,43,44,45,46,47,48,3,4,8,5,6,7,40,16,17,18,19,20,21,22,23,24]))),me=s.lazy(()=>o(()=>import("./ClientPayments-UI4SznOe.js"),__vite__mapDeps([49,1,2,12,13,14,15,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24]))),ue=s.lazy(()=>o(()=>import("./ClientChat-Cy0Gzk3o.js"),__vite__mapDeps([50,1,2,12,13,14,15,3,4,8,5,6,7,16,17,18,19,20,21,22,23,24]))),pe=s.lazy(()=>o(()=>import("./ForgotPassword-HDFVBXtt.js"),__vite__mapDeps([51,1,2,12,13,14,15,18,16,17,3,4,5,6,7,8]))),_e=s.lazy(()=>o(()=>import("./AdminAnamnesi-D514QGBn.js"),__vite__mapDeps([52,1,2,13,14,3,4,8,5,6,7,16,17,18,19,20,21,22,23,24,12,15]))),he=s.lazy(()=>o(()=>import("./CoachDashboard-D8FjZp00.js"),__vite__mapDeps([53,1,2,13,14,12,15,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24]))),fe=s.lazy(()=>o(()=>import("./CoachAnamnesi-CBYM8LSQ.js"),__vite__mapDeps([54,1,2,13,14,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24,12,15]))),xe=s.lazy(()=>o(()=>import("./CoachUpdates-BqZ11CR8.js"),__vite__mapDeps([55,1,2,13,14,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24,12,15]))),je=s.lazy(()=>o(()=>import("./CoachClients-CcE1Hn5-.js"),__vite__mapDeps([56,1,2,13,14,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24,12,15]))),ge=s.lazy(()=>o(()=>import("./CoachChat-CS99SWIx.js"),__vite__mapDeps([57,1,2,12,13,14,15,3,4,8,5,6,7,16,17,18,19,20,21,22,23,24]))),Ee=s.lazy(()=>o(()=>import("./CoachClientDetail-Cx1UPm0N.js"),__vite__mapDeps([58,1,2,13,14,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24,12,15]))),De=s.lazy(()=>o(()=>import("./GuidaMentalFit-D1iZKz7X.js"),__vite__mapDeps([59,1,2,60,19,20,21,22,23,24]))),be=s.lazy(()=>o(()=>import("./BusinessHistory-CB7nWZtd.js"),__vite__mapDeps([61,1,2,13,14,3,4,8,5,6,7,16,17,18,19,20,21,22,23,24,12,15]))),ye=s.lazy(()=>o(()=>import("./Collaboratori-CKpmTclV.js"),__vite__mapDeps([62,1,2,13,14,12,15,5,6,7,3,4,8,16,17,18,19,20,21,22,23,24]))),Ae=s.lazy(()=>o(()=>import("./CollaboratoreDashboard-UhHtEja6.js"),__vite__mapDeps([63,1,2,13,14,12,15,27,28,26,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24]))),Ie=s.lazy(()=>o(()=>import("./CollaboratoreDetail-RcMyEEDD.js"),__vite__mapDeps([64,1,2,13,14,12,15,27,28,26,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24]))),Le=s.lazy(()=>o(()=>import("./CalendarReport-Dc53woG_.js"),__vite__mapDeps([65,1,2,13,14,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24,12,15]))),ve=s.lazy(()=>o(()=>import("./NewClient-Dt6nS5k8.js"),__vite__mapDeps([66,1,2,34,12,13,14,15,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24]))),Pe=s.lazy(()=>o(()=>import("./Dipendenti-vIvX37Ul.js"),__vite__mapDeps([67,1,2,13,14,31,20,8,5,6,7,16,17,18,3,4,19,21,22,23,24,12,15]))),Ce=s.lazy(()=>o(()=>import("./GuideCapture-DZjh63xr.js"),__vite__mapDeps([68,1,2,13,14,5,6,7,3,4,8,16,17,18,19,20,21,22,23,24,12,15]))),Re=s.lazy(()=>o(()=>import("./GuideManager-CFib0N-0.js"),__vite__mapDeps([69,1,2,13,14,8,5,6,7,16,17,18,3,4,19,20,21,22,23,24,12,15]))),ze=s.lazy(()=>o(()=>import("./Statistiche-B8_MHAXk.js"),__vite__mapDeps([70,1,2,13,14,27,28,3,4,8,16,17,18,19,20,21,22,23,24,12,15]))),T=s.lazy(()=>o(()=>import("./CalendarPage-P_1S-1TK.js"),__vite__mapDeps([71,1,2,13,14,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24,12,15]))),Oe=()=>e.jsx("div",{className:"flex justify-center items-center h-screen w-full bg-slate-900",children:e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-rose-500"})}),Ve=()=>e.jsxs("div",{className:"flex flex-col justify-center items-center min-h-screen bg-slate-900 text-slate-200",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-rose-500"}),e.jsx("p",{className:"mt-4 text-sm",children:"Verifica autenticazione..."})]});function Te(){const[i,r]=E.useState({isLoading:!0,user:null,isClient:!1,isCoach:!1,isAdmin:!1,isCollaboratore:!1,error:null}),[l,c]=E.useState(null),n=k(),t=q();return E.useEffect(()=>{try{localStorage.setItem("last_path",t.pathname||"/")}catch{}},[t.pathname]),E.useEffect(()=>{if(t.pathname==="/guida"||t.pathname.startsWith("/guida/")){r(m=>({...m,isLoading:!1}));return}let p=!0;const S=M(Y,async m=>{if(p){if(sessionStorage.getItem("creating_collaboratore")==="true"){sessionStorage.removeItem("creating_collaboratore");return}try{if(m){const h=b(A,"clients",m.uid),I=b(A,"roles","admins"),u=b(A,"roles","coaches"),w=b(A,"collaboratori",m.uid),z=await y(w).catch(()=>({exists:()=>!1,data:()=>({})})),f=z.exists();let x=!1,j=!1,g=!1,v,P,L;f||([v,P,L]=await Promise.all([y(I).catch(()=>({exists:()=>!1,data:()=>({uids:[]})})),y(u).catch(()=>({exists:()=>!1,data:()=>({uids:[]})})),y(h).catch(()=>({exists:()=>!1,data:()=>({})}))]),x=v.exists()&&v.data().uids.includes(m.uid),j=P.exists()&&P.data().uids.includes(m.uid),g=L.exists()&&L.data().isClient===!0),!f&&(j||x)&&g&&await U(h).catch(()=>{});let _=null,d=null;x?(_="admin",d="/"):j?(_="coach",d="/coach"):g?(_="client",d=L.data().firstLogin?"/client/first-access":"/client/dashboard"):f?(_="collaboratore",d=z.data().firstLogin?"/collaboratore/first-access":"/collaboratore/dashboard"):(_=null,d="/login"),sessionStorage.setItem("app_role",_||""),!(x&&(t.pathname==="/"||t.pathname==="/clients"||t.pathname==="/new-client"||t.pathname.startsWith("/client/")||t.pathname.startsWith("/edit/")||t.pathname==="/updates"||t.pathname==="/chat"||t.pathname==="/collaboratori"||t.pathname.startsWith("/collaboratore/")||t.pathname.startsWith("/calendar-report/")||t.pathname==="/business-history"||t.pathname==="/guide-manager"||t.pathname==="/admin/dipendenti"||t.pathname==="/statistiche")||j&&(t.pathname==="/coach"||t.pathname==="/coach/clients"||t.pathname.startsWith("/coach/client/")||t.pathname==="/coach/anamnesi"||t.pathname==="/coach/updates"||t.pathname==="/coach/chat"||t.pathname.startsWith("/coach/client/"))||g&&t.pathname.startsWith("/client/")||f&&t.pathname.startsWith("/collaboratore/"))&&t.pathname!==d&&l!==d&&(c(d),n(d,{replace:!0})),r({isLoading:!1,user:m,isClient:g,isCoach:j,isAdmin:x,isCollaboratore:f,error:null})}else if(sessionStorage.removeItem("app_role"),r({isLoading:!1,user:null,isClient:!1,isCoach:!1,isAdmin:!1,isCollaboratore:!1,error:null}),!["/login","/client/forgot-password","/guida","/guida/:guideId"].some(u=>t.pathname===u||t.pathname.startsWith("/guida/"))){const u="/login";l!==u&&(c(u),n(u,{replace:!0}))}}catch(h){console.error("Errore verifica ruolo:",h),r(I=>({...I,isLoading:!1,error:"Errore autenticazione."})),l!=="/login"&&(c("/login"),n("/login",{replace:!0}))}}});return()=>{p=!1,S()}},[t.pathname,n,l]),i.isLoading?e.jsx(Ve,{}):i.error?e.jsx("div",{className:"text-red-500 text-center p-4",children:i.error}):e.jsx(E.Suspense,{fallback:e.jsx(Oe,{}),children:e.jsxs(J,{children:[e.jsxs(a,{element:e.jsx(te,{}),children:[e.jsx(a,{path:"/guida",element:e.jsx(De,{})}),e.jsx(a,{path:"/guida/:guideId",element:e.jsx(Ce,{})})]}),e.jsx(a,{path:"/login",element:e.jsx(ae,{})}),e.jsx(a,{path:"/client/forgot-password",element:e.jsx(pe,{})}),e.jsxs(a,{element:i.isAdmin?e.jsx(C,{}):e.jsx(D,{to:"/login",replace:!0}),children:[e.jsx(a,{path:"/",element:e.jsx(se,{})}),e.jsx(a,{path:"/clients",element:e.jsx(oe,{})}),e.jsx(a,{path:"/new-client",element:e.jsx(ve,{})}),e.jsx(a,{path:"/client/:clientId",element:e.jsx(ie,{})}),e.jsx(a,{path:"/edit/:id",element:e.jsx(re,{})}),e.jsx(a,{path:"/updates",element:e.jsx(ne,{})}),e.jsx(a,{path:"/chat",element:e.jsx(le,{})}),e.jsx(a,{path:"/client/:id/anamnesi",element:e.jsx(_e,{})}),e.jsx(a,{path:"/collaboratori",element:e.jsx(ye,{})}),e.jsx(a,{path:"/collaboratore-detail",element:e.jsx(Ie,{})}),e.jsx(a,{path:"/calendar",element:e.jsx(T,{})}),e.jsx(a,{path:"/calendar-report/:date",element:e.jsx(Le,{})}),e.jsx(a,{path:"/business-history",element:e.jsx(be,{})}),e.jsx(a,{path:"/guide-manager",element:e.jsx(Re,{})}),e.jsx(a,{path:"/admin/dipendenti",element:e.jsx(Pe,{})}),e.jsx(a,{path:"/statistiche",element:e.jsx(ze,{})})]}),e.jsxs(a,{element:i.isCoach?e.jsx(C,{}):e.jsx(D,{to:"/login",replace:!0}),children:[e.jsx(a,{path:"/coach",element:e.jsx(he,{})}),e.jsx(a,{path:"/coach/clients",element:e.jsx(je,{})}),e.jsx(a,{path:"/coach/client/:id",element:e.jsx(Ee,{})}),e.jsx(a,{path:"/coach/anamnesi",element:e.jsx(fe,{})}),e.jsx(a,{path:"/coach/updates",element:e.jsx(xe,{})}),e.jsx(a,{path:"/coach/chat",element:e.jsx(ge,{})}),e.jsx(a,{path:"/coach/client/:clientId/checks",element:e.jsx(V,{})})]}),e.jsxs(a,{element:i.isClient?e.jsx(ee,{}):e.jsx(D,{to:"/login",replace:!0}),children:[e.jsx(a,{path:"/client/first-access",element:e.jsx(O,{})}),e.jsx(a,{path:"/client/dashboard",element:e.jsx(ce,{})}),e.jsx(a,{path:"/client/anamnesi",element:e.jsx(de,{})}),e.jsx(a,{path:"/client/checks",element:e.jsx(V,{})}),e.jsx(a,{path:"/client/payments",element:e.jsx(me,{})}),e.jsx(a,{path:"/client/chat",element:e.jsx(ue,{})})]}),e.jsxs(a,{element:i.isCollaboratore?e.jsx(C,{}):e.jsx(D,{to:"/login",replace:!0}),children:[e.jsx(a,{path:"/collaboratore/first-access",element:e.jsx(O,{})}),e.jsx(a,{path:"/collaboratore/dashboard",element:e.jsx(Ae,{})}),e.jsx(a,{path:"/collaboratore/calendar",element:e.jsx(T,{})})]}),e.jsx(a,{path:"*",element:e.jsx(D,{to:i.user?i.isAdmin?"/":i.isCoach?"/coach":i.isCollaboratore?"/collaboratore/dashboard":"/login":"/login",replace:!0})})]})})}W.createRoot(document.getElementById("root")).render(e.jsx(s.StrictMode,{children:e.jsx(G,{children:e.jsx(Te,{})})}));export{Y as a,Z as c,A as d,Q as f,$e as s,$ as t,et as u};
