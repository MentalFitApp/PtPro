var Se=Object.defineProperty;var Ce=(n,l,t)=>l in n?Se(n,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[l]=t;var le=(n,l,t)=>Ce(n,typeof l!="symbol"?l+"":l,t);import{E as ke,h as Re,r,e as v,T as E,W as ne,X as ie,V as re,j as e,q as S,aC as Ee,aD as Pe,a0 as Ie,aE as xe,au as Ae,aF as Te,I as Le,aG as Me,aH as Ue,aI as Fe,v as Oe,a1 as $e,aJ as oe,F as U,l as Be,u as P,R as Qe,av as B}from"./.pnpm-C04Ba0Xq.js";import{n as ce}from"./normalizePhotoURLs-D7k3b5VC.js";import{t as C,d as g,u as X}from"./index-DdCoIfwr.js";import{Q as qe}from"./QuickNotifyButton-C9ZkEGbZ.js";class Ze extends Qe.Component{constructor(){super(...arguments);le(this,"state",{hasError:!1,error:null})}static getDerivedStateFromError(t){return{hasError:!0,error:t}}render(){return this.state.hasError?e.jsxs("div",{className:"text-center text-red-400 p-8",children:["Errore: ",this.state.error.message]}):this.props.children}}const _e=({status:n})=>{const l={attivo:"bg-emerald-900/80 text-emerald-300 border border-emerald-500/30",rinnovato:"bg-amber-900/80 text-amber-300 border border-amber-500/30",non_rinnovato:"bg-red-900/80 text-red-400 border border-red-500/30",na:"bg-slate-700/80 text-slate-300 border border-slate-500/30"},t={attivo:"Attivo",rinnovato:"In Scadenza",non_rinnovato:"Scaduto",na:"N/D"};return e.jsx("span",{className:`px-2.5 py-1 text-xs font-medium rounded-full ${l[n]||l.na}`,children:t[n]||"N/D"})},Ge=({isOpen:n,onClose:l,imageUrl:t,alt:b})=>n?e.jsx(S.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:l,className:"fixed inset-0 bg-black/90 z-50 flex items-center justify-center p-4",children:e.jsxs(S.div,{initial:{scale:.8},animate:{scale:1},exit:{scale:.8},onClick:c=>c.stopPropagation(),className:"relative max-w-4xl max-h-full",children:[e.jsx("img",{src:t,alt:b,className:"w-full h-auto max-h-screen object-contain rounded-lg shadow-2xl"}),e.jsx("button",{onClick:l,className:"absolute top-4 right-4 p-2 bg-white/10 hover:bg-white/20 rounded-full text-white",children:e.jsx(B,{size:24})}),e.jsx("div",{className:"absolute bottom-4 left-4 text-white bg-black/60 px-3 py-1 rounded text-sm",children:b})]})}):null,Je=({isOpen:n,onClose:l,client:t,onSave:b})=>{const[c,h]=r.useState(3),[d,m]=r.useState(""),[u,N]=r.useState("bonifico"),[w,o]=r.useState(""),[a,j]=r.useState(""),I=async()=>{try{const p=C(t.scadenza)||new Date,A=a?new Date(a):new Date(p);a||A.setMonth(A.getMonth()+c);const F=u==="altro"?w:u,Q={amount:parseFloat(d)||0,duration:a?"Manuale":`${c} mesi`,paymentDate:new Date,paymentMethod:F},O=v(g,"clients",t.id);await P(O,{scadenza:A,payments:[...t.payments||[],Q]}),X(t.id),b(),l()}catch(p){console.error("Errore rinnovo:",p)}};return n?e.jsx(S.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs(S.div,{initial:{scale:.9},animate:{scale:1},exit:{scale:.9},className:"bg-slate-800/95 backdrop-blur-sm rounded-2xl border border-slate-700 p-6 w-full max-w-md",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-xl font-bold text-white",children:["Rinnovo ",t.name]}),e.jsx("button",{onClick:l,className:"text-white hover:text-rose-400",children:e.jsx(B,{size:24})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-300 mb-1",children:"Mesi di rinnovo"}),e.jsxs("select",{value:c,onChange:p=>h(parseInt(p.target.value)),className:"w-full p-2 bg-slate-700/50 border border-slate-600 rounded-lg text-white",children:[e.jsx("option",{value:1,children:"1 mese"}),e.jsx("option",{value:3,children:"3 mesi"}),e.jsx("option",{value:6,children:"6 mesi"}),e.jsx("option",{value:12,children:"12 mesi"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-300 mb-1",children:"Oppure data scadenza manuale"}),e.jsx("input",{type:"date",value:a,onChange:p=>j(p.target.value),className:"w-full p-2 bg-slate-700/50 border border-slate-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-300 mb-1",children:"Importo"}),e.jsx("input",{type:"number",value:d,onChange:p=>m(p.target.value),placeholder:"es. 150",className:"w-full p-2 bg-slate-700/50 border border-slate-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-300 mb-1",children:"Metodo"}),e.jsxs("select",{value:u,onChange:p=>N(p.target.value),className:"w-full p-2 bg-slate-700/50 border border-slate-600 rounded-lg text-white",children:[e.jsx("option",{value:"bonifico",children:"Bonifico"}),e.jsx("option",{value:"klarna",children:"Klarna 3 rate"}),e.jsx("option",{value:"paypal",children:"PayPal"}),e.jsx("option",{value:"cash",children:"Contanti"}),e.jsx("option",{value:"rateizzato",children:"Rateizzato"}),e.jsx("option",{value:"altro",children:"Altro"})]}),u==="altro"&&e.jsx("input",{type:"text",value:w,onChange:p=>o(p.target.value),placeholder:"Specifica metodo",className:"w-full mt-2 p-2 bg-slate-700/50 border border-slate-600 rounded-lg text-white"})]}),e.jsx("button",{onClick:I,className:"w-full py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-semibold",children:"Salva Rinnovo"})]})]})}):null},We=({isOpen:n,onClose:l,client:t,onSave:b})=>{const[c,h]=r.useState({name:t.name||"",email:t.email||"",phone:t.phone||""}),d=async()=>{try{const m=v(g,"clients",t.id);await P(m,c),b(),l()}catch(m){console.error("Errore modifica:",m)}};return n?e.jsx(S.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs(S.div,{initial:{scale:.9},animate:{scale:1},exit:{scale:.9},className:"bg-slate-800/95 backdrop-blur-sm rounded-2xl border border-slate-700 p-6 w-full max-w-md",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-xl font-bold text-white",children:["Modifica ",t.name]}),e.jsx("button",{onClick:l,className:"text-white hover:text-rose-400",children:e.jsx(B,{size:24})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{value:c.name,onChange:m=>h({...c,name:m.target.value}),placeholder:"Nome",className:"w-full p-2 bg-slate-700/50 border border-slate-600 rounded-lg text-white"}),e.jsx("input",{value:c.email,onChange:m=>h({...c,email:m.target.value}),placeholder:"Email",className:"w-full p-2 bg-slate-700/50 border border-slate-600 rounded-lg text-white"}),e.jsx("input",{value:c.phone,onChange:m=>h({...c,phone:m.target.value}),placeholder:"Telefono",className:"w-full p-2 bg-slate-700/50 border border-slate-600 rounded-lg text-white"}),e.jsx("button",{onClick:d,className:"w-full py-2 bg-rose-600 hover:bg-rose-700 text-white rounded-lg font-semibold",children:"Salva Modifiche"})]})]})}):null},Xe=({isOpen:n,onClose:l,client:t,onSave:b})=>{var o;const[c,h]=r.useState(7),[d,m]=r.useState(""),[u,N]=r.useState(!1),w=async()=>{try{const a=C(t.scadenza)||new Date,j=u&&d?new Date(d):new Date(a);u||j.setDate(j.getDate()+c);const I=v(g,"clients",t.id);await P(I,{scadenza:j}),X(t.id),b(),l()}catch(a){console.error("Errore prolungamento:",a)}};return n?e.jsx(S.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs(S.div,{initial:{scale:.9},animate:{scale:1},exit:{scale:.9},className:"bg-slate-800/95 backdrop-blur-sm rounded-2xl border border-slate-700 p-6 w-full max-w-md",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Prolunga Scadenza"}),e.jsx("button",{onClick:l,className:"text-white hover:text-rose-400",children:e.jsx(B,{size:24})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:u,onChange:a=>N(a.target.checked),className:"w-4 h-4 text-cyan-500"}),e.jsx("label",{className:"text-sm text-slate-300",children:"Scegli data manuale"})]}),u?e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-300 mb-1",children:"Nuova data scadenza"}),e.jsx("input",{type:"date",value:d,onChange:a=>m(a.target.value),className:"w-full p-2 bg-slate-700/50 border border-slate-600 rounded-lg text-white"})]}):e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-300 mb-1",children:"Aggiungi giorni"}),e.jsxs("select",{value:c,onChange:a=>h(parseInt(a.target.value)),className:"w-full p-2 bg-slate-700/50 border border-slate-600 rounded-lg text-white",children:[e.jsx("option",{value:1,children:"+1 giorno"}),e.jsx("option",{value:3,children:"+3 giorni"}),e.jsx("option",{value:7,children:"+7 giorni"}),e.jsx("option",{value:15,children:"+15 giorni"}),e.jsx("option",{value:30,children:"+30 giorni"}),e.jsx("option",{value:60,children:"+60 giorni"})]})]}),e.jsxs("div",{className:"text-xs text-slate-400 p-3 bg-slate-700/30 rounded-lg",children:[e.jsxs("p",{children:["Scadenza attuale: ",e.jsx("strong",{children:((o=C(t.scadenza))==null?void 0:o.toLocaleDateString("it-IT"))||"N/D"})]}),e.jsxs("p",{children:["Nuova scadenza: ",e.jsx("strong",{children:u&&d?new Date(d).toLocaleDateString("it-IT"):C(t.scadenza)?new Date(C(t.scadenza).getTime()+c*864e5).toLocaleDateString("it-IT"):"N/D"})]})]}),e.jsxs("button",{onClick:w,className:"w-full py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg font-semibold flex items-center justify-center gap-2",children:[e.jsx(xe,{size:18})," Prolunga Scadenza"]})]})]})}):null},x=({label:n,value:l})=>e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-400",children:n}),e.jsx("p",{className:"mt-1 p-3 bg-white/5 backdrop-blur-md rounded-lg min-h-[44px] text-white break-words whitespace-pre-wrap shadow-inner",children:l||"Non specificato"})]}),de=({rates:n,canEdit:l,onAdd:t,onUpdate:b,onDelete:c})=>{const[h,d]=r.useState({amount:"",dueDate:"",paid:!1}),[m,u]=r.useState(null),[N,w]=r.useState({amount:"",dueDate:""});return e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-bold text-slate-200 mb-2",children:"Rate"}),e.jsx("div",{className:"mobile-table-wrapper",children:e.jsxs("table",{className:"w-full text-xs sm:text-sm bg-slate-800/60 rounded-xl border border-slate-700 min-w-[500px]",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-900/50",children:[e.jsx("th",{className:"px-2 py-2",children:"Importo"}),e.jsx("th",{className:"px-2 py-2",children:"Scadenza"}),e.jsx("th",{className:"px-2 py-2",children:"Pagata"}),l&&e.jsx("th",{className:"px-2 py-2",children:"Modifica"}),l&&e.jsx("th",{className:"px-2 py-2",children:"Azioni"})]})}),e.jsx("tbody",{children:n&&n.length>0?n.map((o,a)=>e.jsxs("tr",{className:"border-b border-slate-700",children:[e.jsx("td",{className:"px-2 py-2",children:l&&m===a?e.jsx("input",{type:"number",value:N.amount,onChange:j=>w({...N,amount:j.target.value}),className:"p-1 rounded bg-slate-700/50 border border-slate-600 text-white w-20"}):`€${o.amount}`}),e.jsx("td",{className:"px-2 py-2",children:l&&m===a?e.jsx("input",{type:"date",value:N.dueDate,onChange:j=>w({...N,dueDate:j.target.value}),className:"p-1 rounded bg-slate-700/50 border border-slate-600 text-white"}):o.dueDate?new Date(o.dueDate).toLocaleDateString():"-"}),e.jsx("td",{className:"px-2 py-2",children:l?e.jsx("input",{type:"checkbox",checked:o.paid,onChange:()=>{const j={...o,paid:!o.paid};o.paid?j.paidDate=null:j.paidDate=new Date().toISOString(),b(a,j)}}):o.paid?e.jsxs("span",{className:"text-green-400",children:["Pagata",o.paidDate?` il ${new Date(o.paidDate).toLocaleDateString("it-IT")}`:""]}):e.jsx("span",{className:"text-red-400",children:"Da pagare"})}),l&&e.jsx("td",{className:"px-2 py-2",children:m===a?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>{b(a,{...o,...N}),u(null)},className:"text-emerald-400 px-2",children:"Salva"}),e.jsx("button",{onClick:()=>u(null),className:"text-slate-400 px-2",children:"Annulla"})]}):e.jsx("button",{onClick:()=>{u(a),w({amount:o.amount,dueDate:o.dueDate})},className:"text-cyan-400 px-2",children:"Modifica"})}),l&&e.jsx("td",{className:"px-2 py-2",children:e.jsx("button",{onClick:()=>c(a),className:"text-red-400 px-2",children:"Elimina"})})]},a)):e.jsx("tr",{children:e.jsx("td",{colSpan:l?5:3,className:"text-center py-2 text-slate-400",children:"Nessuna rata"})})})]})}),l&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mt-3",children:[e.jsx("input",{type:"number",placeholder:"Importo (€)",value:h.amount,onChange:o=>d({...h,amount:o.target.value}),className:"p-2 rounded bg-slate-700/50 border border-slate-600 text-white text-sm w-full sm:w-auto"}),e.jsx("input",{type:"date",value:h.dueDate,onChange:o=>d({...h,dueDate:o.target.value}),className:"p-2 rounded bg-slate-700/50 border border-slate-600 text-white text-sm w-full sm:w-auto"}),e.jsx("button",{onClick:()=>{h.amount&&h.dueDate&&(t(h),d({amount:"",dueDate:"",paid:!1}))},className:"bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 rounded text-sm whitespace-nowrap",children:"Aggiungi rata"})]})]})};function tt(){var se,ae;const{clientId:n}=ke(),l=Re(),[t,b]=r.useState(null),[c,h]=r.useState(!0),[d,m]=r.useState("info"),[u,N]=r.useState([]),[w,o]=r.useState([]),[a,j]=r.useState(null),[I,p]=r.useState(null),[A,F]=r.useState(!1),[Q,O]=r.useState(!1),[me,H]=r.useState(!1),[he,K]=r.useState(!1),[q,Z]=r.useState({open:!1,url:"",alt:""}),[k,$]=r.useState([]),[ue,pe]=r.useState(!1),[T,V]=r.useState(!1);let _=null;try{_=((se=JSON.parse(localStorage.getItem("user")))==null?void 0:se.role)||null}catch{}const G=_==="admin",J=_==="coach";r.useEffect(()=>{if(!n){p("ID cliente non valido."),setTimeout(()=>l("/clients"),3e3);return}const s=v(g,"clients",n),i=E(s,f=>{if(f.exists()){const y={id:f.id,...f.data()};b(y),X(n)}else p("Cliente non trovato."),setTimeout(()=>l("/clients"),3e3);h(!1)},f=>{p("Errore caricamento."),setTimeout(()=>l("/clients"),3e3),h(!1)}),D=v(g,"clients",n,"anamnesi","initial"),z=E(D,async f=>{if(f.exists()){let y=f.data();y.photoURLs&&(y.photoURLs=ce(y.photoURLs),console.debug("[ClientDetail] Anamnesi photoURLs normalized:",y.photoURLs)),j(y)}else j(null)}),W=ne(re(g,"clients",n,"checks"),ie("createdAt","desc")),we=E(W,async f=>{const ze=f.docs.map(R=>({id:R.id,...R.data()})).map(R=>(R.photoURLs&&(R.photoURLs=ce(R.photoURLs)),R));console.debug("[ClientDetail] Checks photoURLs normalized"),N(ze)},f=>{console.error("Errore caricamento checks:",f)}),ye=ne(re(g,"clients",n,"payments"),ie("paymentDate","desc")),De=E(ye,f=>{o(f.docs.map(y=>({id:y.id,...y.data()})))});return()=>{i(),z(),we(),De()}},[n,l]),r.useEffect(()=>{t&&t.rate&&$(t.rate),t&&typeof t.rateizzato=="boolean"&&V(t.rateizzato),pe(G||J)},[t,G,J]);const be=async()=>{if(window.confirm(`Eliminare ${t==null?void 0:t.name}?`))try{await Be(v(g,"clients",n)),l("/clients")}catch{alert("Errore eliminazione.")}},je=()=>{const s=`Ciao ${t.name},

Link: https://MentalFitApp.github.io/PtPro/#/login
Email: ${t.email}
Password: ${t.tempPassword||"Contatta admin"}`;navigator.clipboard.writeText(s),F(!0),setTimeout(()=>F(!1),2500)},ge=()=>{const s=v(g,"clients",n);E(s,i=>{i.exists()&&b({id:i.id,...i.data()})})},fe=()=>{const s=v(g,"clients",n);E(s,i=>{i.exists()&&b({id:i.id,...i.data()})})},ve=()=>{const s=v(g,"clients",n);E(s,i=>{i.exists()&&b({id:i.id,...i.data()})})},Y=async s=>{const i=[...k,s];$(i),await P(v(g,"clients",t.id),{rate:i})},ee=async(s,i)=>{const D=k.map((z,W)=>W===s?{...z,...i}:z);$(D),await P(v(g,"clients",t.id),{rate:D})},te=async s=>{const i=k.filter((D,z)=>z!==s);$(i),await P(v(g,"clients",t.id),{rate:i})},Ne=async s=>{V(s),await P(v(g,"clients",t.id),{rateizzato:s})};if(c)return e.jsx("div",{className:"text-center text-slate-400 p-8",children:"Caricamento..."});if(I)return e.jsx("div",{className:"text-center text-red-400 p-8",children:I});if(!t)return null;const L="bg-white/5 backdrop-blur-xl rounded-2xl border border-slate-700 p-6 shadow-lg border border-white/10",M="font-bold mb-4 text-lg text-cyan-300 border-b border-cyan-400/20 pb-2 flex items-center gap-2";return e.jsx(Ze,{children:e.jsxs(S.div,{initial:{opacity:0},animate:{opacity:1},className:"w-full max-w-5xl mx-auto p-4 sm:p-6",children:[e.jsxs("button",{onClick:()=>l("/clients"),className:"flex items-center gap-2 text-slate-400 hover:text-rose-400 mb-6",children:[e.jsx(Ee,{size:18})," Torna ai Clienti"]}),e.jsxs("div",{className:"bg-slate-800/60 backdrop-blur-sm rounded-2xl border border-slate-700 p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-50",children:t.name}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(qe,{userId:n,userName:t.name,userType:"client"}),e.jsxs("button",{onClick:()=>H(!0),className:"flex items-center gap-2 px-4 py-2 bg-rose-600 hover:bg-rose-700 text-white text-sm rounded-lg",children:[e.jsx(Pe,{size:16})," Modifica"]}),e.jsxs("button",{onClick:()=>O(!0),className:"flex items-center gap-2 px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white text-sm rounded-lg",children:[e.jsx(Ie,{size:16})," Rinnovo"]}),e.jsxs("button",{onClick:()=>K(!0),className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white text-sm rounded-lg",children:[e.jsx(xe,{size:16})," Prolunga"]}),e.jsxs("button",{onClick:be,className:"flex items-center gap-2 px-4 py-2 bg-red-600 hover:bg-red-700 text-white text-sm rounded-lg",children:[e.jsx(Ae,{size:16})," Elimina"]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-6 bg-slate-900/50 p-1 rounded-lg border border-slate-700",children:["info","check","payments","anamnesi"].map(s=>e.jsx("button",{onClick:()=>m(s),className:`px-4 py-2 text-sm rounded-md transition-colors ${d===s?"bg-rose-600 text-white":"text-slate-400 hover:bg-white/10"}`,children:s==="info"?"Informazioni":s==="check"?"Check":s==="payments"?"Pagamenti":"Anamnesi"},s))}),d==="info"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Te,{className:"text-slate-400",size:18}),e.jsxs("p",{children:["Nome: ",e.jsx("span",{className:"font-semibold",children:t.name})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Le,{className:"text-slate-400",size:18}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("p",{children:["Email: ",e.jsx("span",{className:"font-semibold",children:t.email})]}),e.jsx("button",{onClick:je,className:"p-2 text-slate-400 hover:text-emerald-400 min-w-[44px] min-h-[44px] flex items-center justify-center rounded-lg",children:A?e.jsx(Me,{size:18}):e.jsx(Ue,{size:18})})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Fe,{className:"text-slate-400",size:18}),e.jsxs("p",{children:["Telefono: ",e.jsx("span",{className:"font-semibold",children:t.phone||"N/D"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Oe,{className:"text-slate-400",size:18}),e.jsxs("p",{children:["Scadenza: ",e.jsx("span",{className:"font-semibold",children:((ae=C(t.scadenza))==null?void 0:ae.toLocaleDateString("it-IT"))||"N/D"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx($e,{className:"text-slate-400",size:18}),e.jsxs("p",{children:["Stato: ",e.jsx(_e,{status:t.statoPercorso})]})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsx("label",{className:"font-semibold text-slate-200 text-sm",children:"Rateizzato:"}),e.jsx("span",{className:T?"text-green-400":"text-red-400",children:T?"Sì":"No"})]})]}),d==="check"&&e.jsx("div",{className:"space-y-4",children:u.length>0?u.map(s=>{var i;return e.jsxs("div",{className:"p-5 bg-slate-700/50 rounded-xl border border-slate-600",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2 mb-3",children:[e.jsxs("p",{className:"text-sm font-medium text-slate-300",children:["Data: ",((i=C(s.createdAt))==null?void 0:i.toLocaleDateString("it-IT"))||"N/D"]}),e.jsxs("p",{className:"text-sm text-slate-300",children:["Peso: ",e.jsxs("span",{className:"font-semibold",children:[s.weight||"N/D"," kg"]})]})]}),s.notes&&e.jsxs("p",{className:"text-sm text-slate-400 mb-4 italic",children:['"',s.notes,'"']}),s.photoURLs&&Object.values(s.photoURLs).some(Boolean)&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400 mb-3",children:"Foto:"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3",children:Object.entries(s.photoURLs).map(([D,z])=>z?e.jsxs("button",{onClick:()=>Z({open:!0,url:z,alt:D}),className:"relative group overflow-hidden rounded-xl",children:[e.jsx("img",{src:z,alt:D,className:"w-full h-40 sm:h-48 object-cover transition-transform duration-300 group-hover:scale-110"}),e.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/40 transition-colors flex items-center justify-center",children:e.jsx(oe,{className:"text-white opacity-0 group-hover:opacity-100 transition-opacity",size:28})}),e.jsx("span",{className:"absolute bottom-1 left-1 text-xs bg-black/70 text-white px-2 py-0.5 rounded",children:D})]},D):null)})]})]},s.id)}):e.jsx("p",{className:"text-center text-slate-400 py-8",children:"Nessun check."})}),d==="payments"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"mb-6 p-4 bg-slate-900/60 rounded-xl border border-slate-700 flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("label",{className:"font-semibold text-slate-200 text-sm",children:"Rateizzato:"}),G||J?e.jsx("input",{type:"checkbox",checked:T,onChange:s=>Ne(s.target.checked)}):e.jsx("span",{className:T?"text-green-400":"text-red-400",children:T?"Sì":"No"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsx("div",{className:"flex-1",children:e.jsx(de,{rates:k,canEdit:!0,onAdd:Y,onUpdate:ee,onDelete:te})}),e.jsxs("div",{className:"flex flex-col gap-2 min-w-[180px]",children:[e.jsx("div",{className:"text-sm text-slate-300",children:"Totale rate pagate:"}),e.jsxs("div",{className:"text-lg font-bold text-emerald-400",children:["€",k.filter(s=>s.paid).reduce((s,i)=>s+Number(i.amount||0),0)]}),e.jsx("div",{className:"text-sm text-slate-300 mt-4",children:"Totale da pagare:"}),e.jsxs("div",{className:"text-lg font-bold text-rose-400",children:["€",k.reduce((s,i)=>s+Number(i.amount||0),0)]})]})]})]}),w.length>0?w.map(s=>{var i;return e.jsxs("div",{className:"p-4 bg-slate-700/50 rounded-lg border border-slate-600",children:[e.jsxs("p",{className:"text-sm text-slate-400",children:["Data: ",((i=C(s.paymentDate))==null?void 0:i.toLocaleDateString("it-IT"))||"N/D"]}),e.jsxs("p",{className:"text-sm text-slate-200",children:["Importo: ",new Intl.NumberFormat("it-IT",{style:"currency",currency:"EUR"}).format(s.amount||0)]}),e.jsxs("p",{className:"text-sm text-slate-200",children:["Durata: ",s.duration]}),e.jsxs("p",{className:"text-sm text-slate-200",children:["Metodo: ",s.paymentMethod]})]},s.id)}):e.jsx("p",{className:"text-center text-slate-400",children:"Nessun pagamento."})]}),d==="anamnesi"&&e.jsx("div",{className:"space-y-8",children:a?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:L,children:[e.jsxs("h4",{className:M,children:[e.jsx(U,{size:16})," Dati Anagrafici"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(x,{label:"Nome",value:a.firstName}),e.jsx(x,{label:"Cognome",value:a.lastName}),e.jsx(x,{label:"Data di Nascita",value:a.birthDate}),e.jsx(x,{label:"Lavoro",value:a.job}),e.jsx(x,{label:"Peso (kg)",value:a.weight}),e.jsx(x,{label:"Altezza (cm)",value:a.height})]})]}),e.jsxs("div",{className:L,children:[e.jsxs("h4",{className:M,children:[e.jsx(U,{size:16})," Abitudini Alimentari"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(x,{label:"Pasti al giorno",value:a.mealsPerDay}),e.jsx(x,{label:"Tipo Colazione",value:a.breakfastType}),e.jsx(x,{label:"Alimenti preferiti",value:a.desiredFoods}),e.jsx(x,{label:"Alimenti da evitare",value:a.dislikedFoods}),e.jsx(x,{label:"Allergie/Intolleranze",value:a.intolerances}),e.jsx(x,{label:"Problemi di digestione",value:a.digestionIssues})]})]}),e.jsxs("div",{className:L,children:[e.jsxs("h4",{className:M,children:[e.jsx(U,{size:16})," Allenamento"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(x,{label:"Allenamenti a settimana",value:a.workoutsPerWeek}),e.jsx(x,{label:"Dettagli Allenamento",value:a.trainingDetails}),e.jsx(x,{label:"Orario e Durata",value:a.trainingTime})]})]}),e.jsxs("div",{className:L,children:[e.jsxs("h4",{className:M,children:[e.jsx(U,{size:16})," Salute e Obiettivi"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(x,{label:"Infortuni o problematiche",value:a.injuries}),e.jsx(x,{label:"Farmaci",value:a.medications}),e.jsx(x,{label:"Integratori",value:a.supplements}),e.jsx(x,{label:"Obiettivo Principale",value:a.mainGoal}),e.jsx(x,{label:"Durata Percorso",value:a.programDuration})]})]}),e.jsxs("div",{className:L,children:[e.jsxs("h4",{className:M,children:[e.jsx(U,{size:16})," Foto Iniziali"]}),e.jsx("p",{className:"text-sm text-slate-400 mb-6",children:"Caricate dal cliente al momento dell'iscrizione."}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:["front","right","left","back"].map(s=>{var i;return e.jsxs("div",{className:"text-center",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-400 capitalize mb-2",children:s==="front"?"Frontale":s==="back"?"Posteriore":`Laterale ${s==="left"?"Sinistro":"Destro"}`}),(i=a.photoURLs)!=null&&i[s]?e.jsxs("button",{onClick:()=>Z({open:!0,url:a.photoURLs[s],alt:s}),className:"relative group overflow-hidden rounded-xl w-full h-48",children:[e.jsx("img",{src:a.photoURLs[s],alt:s,className:"w-full h-full object-cover transition-transform group-hover:scale-110"}),e.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/40 flex items-center justify-center transition-colors",children:e.jsx(oe,{className:"text-white opacity-0 group-hover:opacity-100",size:32})})]}):e.jsx("div",{className:"flex justify-center items-center w-full h-48 bg-white/5 backdrop-blur-md rounded-lg text-slate-500",children:e.jsx("span",{children:"Non caricata"})})]},s)})})]})]}):e.jsx("p",{className:"text-center text-slate-400 py-8",children:"Nessuna anamnesi compilata."})}),d==="rates"&&e.jsx("div",{className:"space-y-4",children:e.jsx(de,{rates:k,canEdit:ue,onAdd:Y,onUpdate:ee,onDelete:te})})]}),e.jsx(Je,{isOpen:Q,onClose:()=>O(!1),client:t,onSave:ge}),e.jsx(We,{isOpen:me,onClose:()=>H(!1),client:t,onSave:fe}),e.jsx(Xe,{isOpen:he,onClose:()=>K(!1),client:t,onSave:ve}),e.jsx(Ge,{isOpen:q.open,onClose:()=>Z({open:!1,url:"",alt:""}),imageUrl:q.url,alt:q.alt})]})})}export{tt as default};
