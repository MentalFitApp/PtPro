import{r as a,j as e}from"./react-CrXOBDSJ.js";import{d as w,a as S}from"./index-BoOldJoc.js";import{V as k,I as z,O as I}from"./@firebase-CuwLCerw.js";import{B as g,X as P,K as B}from"./lucide-react-CCY59hBS.js";import{A as T,m as h}from"./framer-motion-BAPjnw1b.js";const o={benvenuto:{icon:"ðŸ‘‹",title:"Benvenuto!",body:"Ciao {name}, benvenuto in MentalFit!"},check:{icon:"ðŸ“Š",title:"Tempo di Check",body:"Ciao {name}, Ã¨ ora di fare il check settimanale!"},motivazione:{icon:"ðŸ’ª",title:"Continua CosÃ¬!",body:"Ciao {name}, stai facendo un ottimo lavoro!"},appuntamento:{icon:"ðŸ“…",title:"Promemoria",body:"Ciao {name}, ti ricordo il nostro appuntamento!"},scadenza:{icon:"â°",title:"Scadenza Imminente",body:"Ciao {name}, il tuo abbonamento sta per scadere. Contattaci!"}};function D({userId:j,userName:r,userType:v="client"}){const[N,i]=a.useState(!1),[s,l]=a.useState(""),[m,x]=a.useState(""),[u,b]=a.useState(""),[p,f]=a.useState(!1),[c,n]=a.useState(""),y=async()=>{let t=m,d=u;if(s&&o[s]&&(t=o[s].title,d=o[s].body),!t||!d){n("Inserisci titolo e messaggio o seleziona un preset");return}f(!0);try{await k(z(w,"notifications"),{userId:j,userType:v,title:t.replace("{name}",r),body:d.replace("{name}",r),read:!1,sentAt:I(),sentBy:S.currentUser.uid,preset:s||null}),n("âœ… Notifica inviata!"),setTimeout(()=>{i(!1),n(""),l(""),x(""),b("")},1500)}catch(C){console.error("Errore invio notifica:",C),n("âŒ Errore durante l'invio")}finally{f(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>i(!0),className:"p-2 bg-rose-600 hover:bg-rose-700 text-white rounded-lg transition-colors",title:"Invia notifica",children:e.jsx(g,{size:20})}),e.jsx(T,{children:N&&e.jsx(h.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:()=>i(!1),children:e.jsxs(h.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:t=>t.stopPropagation(),className:"bg-slate-800 rounded-2xl border border-slate-700 p-6 w-full max-w-md shadow-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-xl font-bold text-slate-200 flex items-center gap-2",children:[e.jsx(g,{className:"text-rose-400",size:24}),"Invia Notifica"]}),e.jsx("button",{onClick:()=>i(!1),className:"p-1 hover:bg-white/10 rounded transition-colors",children:e.jsx(P,{size:20,className:"text-slate-400"})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm text-slate-400 mb-2",children:"Destinatario:"}),e.jsx("p",{className:"font-medium text-slate-200",children:r})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Preset Rapidi"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:Object.keys(o).map(t=>e.jsxs("button",{onClick:()=>l(t),className:`p-3 rounded-lg border transition-all ${s===t?"bg-rose-600/20 border-rose-500":"bg-slate-700/50 border-slate-600 hover:border-rose-500/50"}`,children:[e.jsx("div",{className:"text-2xl mb-1",children:o[t].icon}),e.jsx("div",{className:"text-xs text-slate-300 truncate",children:t})]},t))})]}),e.jsxs("div",{className:"border-t border-slate-700 pt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Messaggio Personalizzato"}),e.jsx("input",{type:"text",value:m,onChange:t=>{x(t.target.value),l("")},placeholder:"Titolo",className:"w-full p-2 mb-2 bg-slate-700/50 border border-slate-600 rounded-lg text-slate-200 placeholder:text-slate-500 focus:ring-2 focus:ring-rose-500 outline-none"}),e.jsx("textarea",{value:u,onChange:t=>{b(t.target.value),l("")},placeholder:"Messaggio...",rows:3,className:"w-full p-2 bg-slate-700/50 border border-slate-600 rounded-lg text-slate-200 placeholder:text-slate-500 focus:ring-2 focus:ring-rose-500 outline-none"})]}),c&&e.jsx("div",{className:`p-3 rounded-lg text-center text-sm ${c.includes("âœ…")?"bg-emerald-900/50 text-emerald-300":"bg-red-900/50 text-red-300"}`,children:c}),e.jsxs("button",{onClick:y,disabled:p,className:"w-full py-3 bg-rose-600 hover:bg-rose-700 text-white font-bold rounded-lg transition-colors disabled:opacity-50 flex items-center justify-center gap-2",children:[e.jsx(B,{size:18}),p?"Invio...":"Invia Notifica"]})]})]})})})]})}export{D as Q};
