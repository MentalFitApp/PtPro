const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MainLayout-CxR2ziYD.js","assets/react-CrXOBDSJ.js","assets/core-js-ChGsxLo2.js","assets/react-router-BxpCmtJ-.js","assets/@remix-run-CjG9tKj3.js","assets/framer-motion-BAPjnw1b.js","assets/motion-dom-C8PdgYBP.js","assets/motion-utils-DBsP9okC.js","assets/lucide-react-CCY59hBS.js","assets/ClientLayout-QuUaFbl0.js","assets/GuidaLayout-Yl6uYr9N.js","assets/Login-ufIdMMcm.js","assets/firebase-Bp3EI6Ad.js","assets/@firebase-CuwLCerw.js","assets/idb-Bn1DMRyg.js","assets/tslib-BGVaTf34.js","assets/react-dom-BpmKF3Ga.js","assets/scheduler-DYLXRpC5.js","assets/react-router-dom-9rcY47vU.js","assets/jspdf-7Jyqi_bl.js","assets/@babel-Cvov1XSu.js","assets/fflate-XZmX483V.js","assets/fast-png-CUrN0NP5.js","assets/iobuffer-DZ1zOcUT.js","assets/pako-B9FS3IR_.js","assets/Dashboard-CK5VTpgP.js","assets/react-chartjs-2-DgEolIMQ.js","assets/chart.js-m_wzuIQ6.js","assets/@kurkle-D8fDXNIl.js","assets/Clients-BCq3-vcE.js","assets/papaparse-rLJvb3Z-.js","assets/date-fns-K6w5eF5u.js","assets/ClientDetail-Dv0q-8Pu.js","assets/QuickNotifyButton-CJYiWe19.js","assets/EditClient-CUO7sFA1.js","assets/react-hook-form-yCRcHKQw.js","assets/Updates-DBOZ84kM.js","assets/AdminChat-BQDEe6hO.js","assets/FirstAccess-Bkk6Muow.js","assets/ClientDashboard-DxDaqqpT.js","assets/NotificationPanel-JiQhpcm6.js","assets/ClientAnamnesi-ByX6viIQ.js","assets/uuid-CtRu48qb.js","assets/ClientChecks-BFq5JH5x.js","assets/react-calendar-fvZi8T_s.js","assets/clsx-B-dksMZM.js","assets/get-user-locale-CTD1oYsn.js","assets/memoize-BZNdjcd3.js","assets/mimic-function-BIlJVoeO.js","assets/@wojtekmaj-CaFejNaN.js","assets/react-calendar-DDKpoaqD.css","assets/ClientPayments-B6IilcIA.js","assets/ClientChat-AbXPZTME.js","assets/ForgotPassword-CxujQLQj.js","assets/AdminAnamnesi-W42Fc8Ja.js","assets/CoachDashboard-DJECp6oc.js","assets/CoachAnamnesi-CsHWZ0Jm.js","assets/CoachUpdates-CYm6wKXH.js","assets/CoachClients-B2NxW0rK.js","assets/CoachChat-arWWlGYB.js","assets/CoachClientDetail-yhBmXnHM.js","assets/GuidaMentalFit-D1iZKz7X.js","assets/html2canvas-CBrSDip1.js","assets/BusinessHistory-B__LV6bR.js","assets/Collaboratori-CIxEaQxB.js","assets/CollaboratoreDashboard-L-C3oUKB.js","assets/CollaboratoreDetail-DBwkDXNv.js","assets/CalendarReport-BS_-WJtp.js","assets/NewClient-0GKLI7Ae.js","assets/Dipendenti-DrsO1jf5.js","assets/GuideCapture-CWpVUo7O.js","assets/GuideManager-DRtQLFvb.js","assets/Statistiche-BneI0LDH.js","assets/CalendarPage-CbCvGDPG.js","assets/Notifications-DfKusRoL.js"])))=>i.map(i=>d[i]);
import{R as s,r as E,j as e}from"./react-CrXOBDSJ.js";import{c as W}from"./react-dom-BpmKF3Ga.js";import{H as G}from"./react-router-dom-9rcY47vU.js";import{_ as i}from"./jspdf-7Jyqi_bl.js";import{g as M,o as H}from"./firebase-Bp3EI6Ad.js";import{v as k,w as F,x as B,y as K,z as X,A as b,B as y,D as U,G as q}from"./@firebase-CuwLCerw.js";import{a as J,b as Q,d as Y,e as a,f as D}from"./react-router-BxpCmtJ-.js";import"./core-js-ChGsxLo2.js";import"./scheduler-DYLXRpC5.js";import"./@remix-run-CjG9tKj3.js";import"./@babel-Cvov1XSu.js";import"./fflate-XZmX483V.js";import"./fast-png-CUrN0NP5.js";import"./iobuffer-DZ1zOcUT.js";import"./pako-B9FS3IR_.js";import"./tslib-BGVaTf34.js";import"./idb-Bn1DMRyg.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))c(n);new MutationObserver(n=>{for(const t of n)if(t.type==="childList")for(const u of t.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&c(u)}).observe(document,{childList:!0,subtree:!0});function l(n){const t={};return n.integrity&&(t.integrity=n.integrity),n.referrerPolicy&&(t.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?t.credentials="include":n.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function c(n){if(n.ep)return;n.ep=!0;const t=l(n);fetch(n.href,t)}})();const Z={apiKey:"AIzaSyDU4GmH6xLhrEd2jSkyATXJOasIyEfisXY",authDomain:"biondo-fitness-coach.firebaseapp.com",projectId:"biondo-fitness-coach",storageBucket:"biondo-fitness-coach.firebasestorage.app",messagingSenderId:"1086406111438",appId:"1:1086406111438:web:1c8c3d9e49f1ffdb77609f",measurementId:"G-869HQ5KGVX"},L=k(Z),$=M(L),A=F(L),at=B(L);typeof window<"u"&&K().then(o=>{o&&X(L)}).catch(o=>console.log("Messaging not supported:",o));const st=async o=>{try{const r=b(A,"clients",o),l=await y(r);if(!l.exists())return;const c=l.data().scadenza,n=ee(c);await U(r,{statoPercorso:n})}catch(r){console.error("Errore in updateStatoPercorso:",r)}},ee=o=>{if(!o)return"N/D";const r=te(o);if(!r)return"N/D";const l=new Date;l.setHours(0,0,0,0),r.setHours(0,0,0,0);const c=Math.ceil((r-l)/(1e3*60*60*24));return c<0?"Scaduto":c<=7?"In scadenza":"Attivo"},te=o=>{if(!o)return null;if(typeof(o==null?void 0:o.toDate)=="function")return o.toDate();if(o instanceof Date)return o;if(typeof o=="string")try{const r=new Date(o);return isNaN(r.getTime())?null:r}catch{return null}if(typeof o=="number"){const r=new Date(o);return isNaN(r.getTime())?null:r}return null},C=s.lazy(()=>i(()=>import("./MainLayout-CxR2ziYD.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),ae=s.lazy(()=>i(()=>import("./ClientLayout-QuUaFbl0.js"),__vite__mapDeps([9,1,2,3,4]))),se=s.lazy(()=>i(()=>import("./GuidaLayout-Yl6uYr9N.js"),__vite__mapDeps([10,1,2,3,4]))),oe=s.lazy(()=>i(()=>import("./Login-ufIdMMcm.js"),__vite__mapDeps([11,1,2,12,13,14,15,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24]))),ie=s.lazy(()=>i(()=>import("./Dashboard-CK5VTpgP.js"),__vite__mapDeps([25,1,2,13,14,12,15,26,27,28,3,4,8,5,6,7,16,17,18,19,20,21,22,23,24]))),re=s.lazy(()=>i(()=>import("./Clients-BCq3-vcE.js"),__vite__mapDeps([29,1,2,13,14,12,15,30,3,4,31,20,8,5,6,7,16,17,18,19,21,22,23,24]))),ne=s.lazy(()=>i(()=>import("./ClientDetail-Dv0q-8Pu.js"),__vite__mapDeps([32,1,2,13,14,33,8,5,6,7,3,4,16,17,18,19,20,21,22,23,24,12,15]))),le=s.lazy(()=>i(()=>import("./EditClient-CUO7sFA1.js"),__vite__mapDeps([34,1,2,35,13,14,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24,12,15]))),ce=s.lazy(()=>i(()=>import("./Updates-DBOZ84kM.js"),__vite__mapDeps([36,1,2,13,14,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24,12,15]))),de=s.lazy(()=>i(()=>import("./AdminChat-BQDEe6hO.js"),__vite__mapDeps([37,1,2,12,13,14,15,8,5,6,7,16,17,18,3,4,19,20,21,22,23,24]))),O=s.lazy(()=>i(()=>import("./FirstAccess-Bkk6Muow.js"),__vite__mapDeps([38,1,2,12,13,14,15,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24]))),me=s.lazy(()=>i(()=>import("./ClientDashboard-DxDaqqpT.js"),__vite__mapDeps([39,1,2,12,13,14,15,18,16,17,3,4,40,5,6,7,8,19,20,21,22,23,24]))),pe=s.lazy(()=>i(()=>import("./ClientAnamnesi-ByX6viIQ.js"),__vite__mapDeps([41,1,2,35,12,13,14,15,3,4,8,5,6,7,42,16,17,18,19,20,21,22,23,24]))),V=s.lazy(()=>i(()=>import("./ClientChecks-BFq5JH5x.js"),__vite__mapDeps([43,1,2,12,13,14,15,44,45,46,47,48,49,50,3,4,8,5,6,7,42,16,17,18,19,20,21,22,23,24]))),ue=s.lazy(()=>i(()=>import("./ClientPayments-B6IilcIA.js"),__vite__mapDeps([51,1,2,12,13,14,15,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24]))),_e=s.lazy(()=>i(()=>import("./ClientChat-AbXPZTME.js"),__vite__mapDeps([52,1,2,12,13,14,15,3,4,8,5,6,7,16,17,18,19,20,21,22,23,24]))),he=s.lazy(()=>i(()=>import("./ForgotPassword-CxujQLQj.js"),__vite__mapDeps([53,1,2,12,13,14,15,18,16,17,3,4,5,6,7,8]))),fe=s.lazy(()=>i(()=>import("./AdminAnamnesi-W42Fc8Ja.js"),__vite__mapDeps([54,1,2,13,14,3,4,8,5,6,7,16,17,18,19,20,21,22,23,24,12,15]))),xe=s.lazy(()=>i(()=>import("./CoachDashboard-DJECp6oc.js"),__vite__mapDeps([55,1,2,13,14,12,15,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24]))),je=s.lazy(()=>i(()=>import("./CoachAnamnesi-CsHWZ0Jm.js"),__vite__mapDeps([56,1,2,13,14,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24,12,15]))),ge=s.lazy(()=>i(()=>import("./CoachUpdates-CYm6wKXH.js"),__vite__mapDeps([57,1,2,13,14,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24,12,15]))),Ee=s.lazy(()=>i(()=>import("./CoachClients-B2NxW0rK.js"),__vite__mapDeps([58,1,2,13,14,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24,12,15]))),De=s.lazy(()=>i(()=>import("./CoachChat-arWWlGYB.js"),__vite__mapDeps([59,1,2,12,13,14,15,3,4,8,5,6,7,16,17,18,19,20,21,22,23,24]))),be=s.lazy(()=>i(()=>import("./CoachClientDetail-yhBmXnHM.js"),__vite__mapDeps([60,1,2,13,14,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24,12,15]))),ye=s.lazy(()=>i(()=>import("./GuidaMentalFit-D1iZKz7X.js"),__vite__mapDeps([61,1,2,62,19,20,21,22,23,24]))),Ae=s.lazy(()=>i(()=>import("./BusinessHistory-B__LV6bR.js"),__vite__mapDeps([63,1,2,13,14,3,4,8,5,6,7,16,17,18,19,20,21,22,23,24,12,15]))),ve=s.lazy(()=>i(()=>import("./Collaboratori-CIxEaQxB.js"),__vite__mapDeps([64,1,2,13,14,12,15,5,6,7,3,4,8,16,17,18,19,20,21,22,23,24]))),Ie=s.lazy(()=>i(()=>import("./CollaboratoreDashboard-L-C3oUKB.js"),__vite__mapDeps([65,1,2,13,14,12,15,40,5,6,7,8,27,28,26,3,4,16,17,18,19,20,21,22,23,24]))),Le=s.lazy(()=>i(()=>import("./CollaboratoreDetail-DBwkDXNv.js"),__vite__mapDeps([66,1,2,13,14,12,15,33,8,5,6,7,27,28,26,3,4,16,17,18,19,20,21,22,23,24]))),Pe=s.lazy(()=>i(()=>import("./CalendarReport-BS_-WJtp.js"),__vite__mapDeps([67,1,2,13,14,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24,12,15]))),Re=s.lazy(()=>i(()=>import("./NewClient-0GKLI7Ae.js"),__vite__mapDeps([68,1,2,35,12,13,14,15,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24]))),Ce=s.lazy(()=>i(()=>import("./Dipendenti-DrsO1jf5.js"),__vite__mapDeps([69,1,2,13,14,31,20,8,5,6,7,16,17,18,3,4,19,21,22,23,24,12,15]))),ze=s.lazy(()=>i(()=>import("./GuideCapture-CWpVUo7O.js"),__vite__mapDeps([70,1,2,13,14,5,6,7,3,4,8,16,17,18,19,20,21,22,23,24,12,15]))),Oe=s.lazy(()=>i(()=>import("./GuideManager-DRtQLFvb.js"),__vite__mapDeps([71,1,2,13,14,8,5,6,7,16,17,18,3,4,19,20,21,22,23,24,12,15]))),Ve=s.lazy(()=>i(()=>import("./Statistiche-BneI0LDH.js"),__vite__mapDeps([72,1,2,13,14,27,28,3,4,8,16,17,18,19,20,21,22,23,24,12,15]))),T=s.lazy(()=>i(()=>import("./CalendarPage-CbCvGDPG.js"),__vite__mapDeps([73,1,2,13,14,3,4,5,6,7,8,16,17,18,19,20,21,22,23,24,12,15]))),Te=s.lazy(()=>i(()=>import("./Notifications-DfKusRoL.js"),__vite__mapDeps([74,1,2,13,14,8,5,6,7,16,17,18,3,4,19,20,21,22,23,24,12,15]))),Se=()=>e.jsx("div",{className:"flex justify-center items-center h-screen w-full bg-slate-900",children:e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-rose-500"})}),we=()=>e.jsxs("div",{className:"flex flex-col justify-center items-center min-h-screen bg-slate-900 text-slate-200",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-rose-500"}),e.jsx("p",{className:"mt-4 text-sm",children:"Verifica autenticazione..."})]});function Ne(){const[o,r]=E.useState({isLoading:!0,user:null,isClient:!1,isCoach:!1,isAdmin:!1,isCollaboratore:!1,error:null}),[l,c]=E.useState(null),n=J(),t=Q();return E.useEffect(()=>{try{localStorage.setItem("last_path",t.pathname||"/")}catch{}},[t.pathname]),E.useEffect(()=>{if(t.pathname==="/guida"||t.pathname.startsWith("/guida/")){r(m=>({...m,isLoading:!1}));return}let u=!0;const S=H($,async m=>{if(u){if(sessionStorage.getItem("creating_collaboratore")==="true"){sessionStorage.removeItem("creating_collaboratore");return}try{if(m){const h=b(A,"clients",m.uid),v=b(A,"roles","admins"),p=b(A,"roles","coaches"),w=b(A,"collaboratori",m.uid),z=await y(w).catch(()=>({exists:()=>!1,data:()=>({})})),f=z.exists();let x=!1,j=!1,g=!1,P,R,I;f||([P,R,I]=await Promise.all([y(v).catch(()=>({exists:()=>!1,data:()=>({uids:[]})})),y(p).catch(()=>({exists:()=>!1,data:()=>({uids:[]})})),y(h).catch(()=>({exists:()=>!1,data:()=>({})}))]),x=P.exists()&&P.data().uids.includes(m.uid),j=R.exists()&&R.data().uids.includes(m.uid),g=I.exists()&&I.data().isClient===!0),!f&&(j||x)&&g&&await q(h).catch(()=>{});let _=null,d=null;x?(_="admin",d="/"):j?(_="coach",d="/coach"):g?(_="client",d=I.data().firstLogin?"/client/first-access":"/client/dashboard"):f?(_="collaboratore",d=z.data().firstLogin?"/collaboratore/first-access":"/collaboratore/dashboard"):(_=null,d="/login"),sessionStorage.setItem("app_role",_||""),!(x&&(t.pathname==="/"||t.pathname==="/clients"||t.pathname==="/new-client"||t.pathname.startsWith("/client/")||t.pathname.startsWith("/edit/")||t.pathname==="/updates"||t.pathname==="/chat"||t.pathname==="/collaboratori"||t.pathname.startsWith("/collaboratore/")||t.pathname.startsWith("/calendar-report/")||t.pathname==="/business-history"||t.pathname==="/guide-manager"||t.pathname==="/admin/dipendenti"||t.pathname==="/statistiche"||t.pathname==="/notifications")||j&&(t.pathname==="/coach"||t.pathname==="/coach/clients"||t.pathname.startsWith("/coach/client/")||t.pathname==="/coach/anamnesi"||t.pathname==="/coach/updates"||t.pathname==="/coach/chat"||t.pathname.startsWith("/coach/client/"))||g&&t.pathname.startsWith("/client/")||f&&t.pathname.startsWith("/collaboratore/"))&&t.pathname!==d&&l!==d&&(c(d),n(d,{replace:!0})),r({isLoading:!1,user:m,isClient:g,isCoach:j,isAdmin:x,isCollaboratore:f,error:null})}else if(sessionStorage.removeItem("app_role"),r({isLoading:!1,user:null,isClient:!1,isCoach:!1,isAdmin:!1,isCollaboratore:!1,error:null}),!["/login","/client/forgot-password","/guida","/guida/:guideId"].some(p=>t.pathname===p||t.pathname.startsWith("/guida/"))){const p="/login";l!==p&&(c(p),n(p,{replace:!0}))}}catch(h){console.error("Errore verifica ruolo:",h),r(v=>({...v,isLoading:!1,error:"Errore autenticazione."})),l!=="/login"&&(c("/login"),n("/login",{replace:!0}))}}});return()=>{u=!1,S()}},[t.pathname,n,l]),o.isLoading?e.jsx(we,{}):o.error?e.jsx("div",{className:"text-red-500 text-center p-4",children:o.error}):e.jsx(E.Suspense,{fallback:e.jsx(Se,{}),children:e.jsxs(Y,{children:[e.jsxs(a,{element:e.jsx(se,{}),children:[e.jsx(a,{path:"/guida",element:e.jsx(ye,{})}),e.jsx(a,{path:"/guida/:guideId",element:e.jsx(ze,{})})]}),e.jsx(a,{path:"/login",element:e.jsx(oe,{})}),e.jsx(a,{path:"/client/forgot-password",element:e.jsx(he,{})}),e.jsxs(a,{element:o.isAdmin?e.jsx(C,{}):e.jsx(D,{to:"/login",replace:!0}),children:[e.jsx(a,{path:"/",element:e.jsx(ie,{})}),e.jsx(a,{path:"/clients",element:e.jsx(re,{})}),e.jsx(a,{path:"/new-client",element:e.jsx(Re,{})}),e.jsx(a,{path:"/client/:clientId",element:e.jsx(ne,{})}),e.jsx(a,{path:"/edit/:id",element:e.jsx(le,{})}),e.jsx(a,{path:"/updates",element:e.jsx(ce,{})}),e.jsx(a,{path:"/chat",element:e.jsx(de,{})}),e.jsx(a,{path:"/client/:id/anamnesi",element:e.jsx(fe,{})}),e.jsx(a,{path:"/collaboratori",element:e.jsx(ve,{})}),e.jsx(a,{path:"/collaboratore-detail",element:e.jsx(Le,{})}),e.jsx(a,{path:"/calendar",element:e.jsx(T,{})}),e.jsx(a,{path:"/calendar-report/:date",element:e.jsx(Pe,{})}),e.jsx(a,{path:"/business-history",element:e.jsx(Ae,{})}),e.jsx(a,{path:"/guide-manager",element:e.jsx(Oe,{})}),e.jsx(a,{path:"/admin/dipendenti",element:e.jsx(Ce,{})}),e.jsx(a,{path:"/statistiche",element:e.jsx(Ve,{})}),e.jsx(a,{path:"/notifications",element:e.jsx(Te,{})})]}),e.jsxs(a,{element:o.isCoach?e.jsx(C,{}):e.jsx(D,{to:"/login",replace:!0}),children:[e.jsx(a,{path:"/coach",element:e.jsx(xe,{})}),e.jsx(a,{path:"/coach/clients",element:e.jsx(Ee,{})}),e.jsx(a,{path:"/coach/client/:id",element:e.jsx(be,{})}),e.jsx(a,{path:"/coach/anamnesi",element:e.jsx(je,{})}),e.jsx(a,{path:"/coach/updates",element:e.jsx(ge,{})}),e.jsx(a,{path:"/coach/chat",element:e.jsx(De,{})}),e.jsx(a,{path:"/coach/client/:clientId/checks",element:e.jsx(V,{})})]}),e.jsxs(a,{element:o.isClient?e.jsx(ae,{}):e.jsx(D,{to:"/login",replace:!0}),children:[e.jsx(a,{path:"/client/first-access",element:e.jsx(O,{})}),e.jsx(a,{path:"/client/dashboard",element:e.jsx(me,{})}),e.jsx(a,{path:"/client/anamnesi",element:e.jsx(pe,{})}),e.jsx(a,{path:"/client/checks",element:e.jsx(V,{})}),e.jsx(a,{path:"/client/payments",element:e.jsx(ue,{})}),e.jsx(a,{path:"/client/chat",element:e.jsx(_e,{})})]}),e.jsxs(a,{element:o.isCollaboratore?e.jsx(C,{}):e.jsx(D,{to:"/login",replace:!0}),children:[e.jsx(a,{path:"/collaboratore/first-access",element:e.jsx(O,{})}),e.jsx(a,{path:"/collaboratore/dashboard",element:e.jsx(Ie,{})}),e.jsx(a,{path:"/collaboratore/calendar",element:e.jsx(T,{})})]}),e.jsx(a,{path:"*",element:e.jsx(D,{to:o.user?o.isAdmin?"/":o.isCoach?"/coach":o.isCollaboratore?"/collaboratore/dashboard":"/login":"/login",replace:!0})})]})})}"serviceWorker"in navigator&&navigator.serviceWorker.register("/PtPro/firebase-messaging-sw.js").then(o=>{console.log("Service Worker registrato:",o)}).catch(o=>{console.error("Errore registrazione Service Worker:",o)});W.createRoot(document.getElementById("root")).render(e.jsx(s.StrictMode,{children:e.jsx(G,{children:e.jsx(Ne,{})})}));export{$ as a,ee as c,A as d,Z as f,at as s,te as t,st as u};
