import{m as f}from"./mimic-function-BIlJVoeO.js";const T=new WeakMap,l=new WeakMap;function w(o,{cacheKey:m,cache:r=new Map,maxAge:e}={}){if(e===0)return o;if(typeof e=="number"){if(e>2147483647)throw new TypeError("The `maxAge` option cannot exceed 2147483647.");if(e<0)throw new TypeError("The `maxAge` option should not be a negative number.")}const i=function(...n){var I;const s=m?m(n):n[0],u=r.get(s);if(u)return u.data;const p=o.apply(this,n),t=typeof e=="function"?e(...n):e;if(r.set(s,{data:p,maxAge:t?Date.now()+t:Number.POSITIVE_INFINITY}),t&&t>0&&t!==Number.POSITIVE_INFINITY){const a=setTimeout(()=>{r.delete(s)},t);(I=a.unref)==null||I.call(a);const c=l.get(o)??new Set;c.add(a),l.set(o,c)}return p};return f(i,o,{ignoreNonConfigurable:!0}),T.set(i,r),i}export{w as m};
