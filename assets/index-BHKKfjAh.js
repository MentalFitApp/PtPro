const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MainLayout-DHJRsv1G.js","assets/react-CrXOBDSJ.js","assets/core-js-ChGsxLo2.js","assets/react-router-BxpCmtJ-.js","assets/@remix-run-CjG9tKj3.js","assets/framer-motion-BAPjnw1b.js","assets/motion-dom-C8PdgYBP.js","assets/motion-utils-DBsP9okC.js","assets/lucide-react-7Eidy6wR.js","assets/ClientLayout-7T0p8bQs.js","assets/GuidaLayout-ClZhG-wP.js","assets/Login-BIARrRrn.js","assets/react-router-dom-9rcY47vU.js","assets/react-dom-BpmKF3Ga.js","assets/scheduler-DYLXRpC5.js","assets/firebase-BzWCke7W.js","assets/@firebase-Dy5qmm0I.js","assets/idb-Bn1DMRyg.js","assets/tslib-BGVaTf34.js","assets/jspdf-7Jyqi_bl.js","assets/@babel-Cvov1XSu.js","assets/fflate-XZmX483V.js","assets/fast-png-CUrN0NP5.js","assets/iobuffer-DZ1zOcUT.js","assets/pako-B9FS3IR_.js","assets/Dashboard-DeoWCZds.js","assets/react-chartjs-2-DgEolIMQ.js","assets/chart.js-m_wzuIQ6.js","assets/@kurkle-D8fDXNIl.js","assets/Clients-Cx8oZH_C.js","assets/papaparse-rLJvb3Z-.js","assets/date-fns-K6w5eF5u.js","assets/ClientDetail-B0OkG7lQ.js","assets/EditClient-C-yEz7Sk.js","assets/react-hook-form-yCRcHKQw.js","assets/Updates-C612oGUE.js","assets/AdminChat-DDH6zzYs.js","assets/ClientLogin-B6m2eg3Q.js","assets/FirstAccess-BMY1aeVh.js","assets/ClientDashboard-JMctThcb.js","assets/ClientAnamnesi-BSpu8Kun.js","assets/uuid-CtRu48qb.js","assets/ClientChecks-Bl3NlxjE.js","assets/react-calendar-fvZi8T_s.js","assets/clsx-B-dksMZM.js","assets/get-user-locale-CTD1oYsn.js","assets/memoize-BZNdjcd3.js","assets/mimic-function-BIlJVoeO.js","assets/@wojtekmaj-CaFejNaN.js","assets/react-calendar-DDKpoaqD.css","assets/ClientPayments-Cf70mGXI.js","assets/ClientChat-LT3_jk07.js","assets/ForgotPassword-sQ1f62xK.js","assets/AdminAnamnesi-Bwz5_CtG.js","assets/CoachDashboard-coucehNN.js","assets/CoachAnamnesi-BXorMME3.js","assets/CoachUpdates-C4srpCv5.js","assets/CoachClients-Bv1EaZ5J.js","assets/CoachChat-DO0se6y2.js","assets/CoachClientDetail-C9L_aSXI.js","assets/GuidaMentalFit-D1iZKz7X.js","assets/html2canvas-CBrSDip1.js","assets/BusinessHistory-BZILMVZ2.js","assets/Collaboratori-C0GQrE08.js","assets/CollaboratoreLogin-DGdqAcPF.js","assets/CollaboratoreDashboard-BuhvlJBG.js","assets/CollaboratoreDetail-Hx3147Bf.js","assets/CalendarReport-BnDM_FPd.js","assets/NewClient-CZ-1OJit.js","assets/Dipendenti-_JqcNsLV.js","assets/GuideCapture-PgmCOtX5.js","assets/GuideManager-DDORAqyd.js","assets/Statistiche-CHe_cjkC.js","assets/CalendarPage-kcAqsznM.js"])))=>i.map(i=>d[i]);
import{R as o,r as y,j as e}from"./react-CrXOBDSJ.js";import{c as G}from"./react-dom-BpmKF3Ga.js";import{H as M}from"./react-router-dom-9rcY47vU.js";import{_ as s}from"./jspdf-7Jyqi_bl.js";import{g as H,o as F}from"./firebase-BzWCke7W.js";import{v as B,w as K,x as X,y as A,z as L,A as U,B as k}from"./@firebase-Dy5qmm0I.js";import{a as q,b as J,d as Q,e as t,f as D}from"./react-router-BxpCmtJ-.js";import"./core-js-ChGsxLo2.js";import"./scheduler-DYLXRpC5.js";import"./@remix-run-CjG9tKj3.js";import"./@babel-Cvov1XSu.js";import"./fflate-XZmX483V.js";import"./fast-png-CUrN0NP5.js";import"./iobuffer-DZ1zOcUT.js";import"./pako-B9FS3IR_.js";import"./tslib-BGVaTf34.js";import"./idb-Bn1DMRyg.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))c(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&c(u)}).observe(document,{childList:!0,subtree:!0});function l(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function c(n){if(n.ep)return;n.ep=!0;const a=l(n);fetch(n.href,a)}})();const Y={apiKey:"AIzaSyDU4GmH6xLhrEd2jSkyATXJOasIyEfisXY",authDomain:"biondo-fitness-coach.firebaseapp.com",projectId:"biondo-fitness-coach",storageBucket:"biondo-fitness-coach.firebasestorage.app",messagingSenderId:"1086406111438",appId:"1:1086406111438:web:1c8c3d9e49f1ffdb77609f",measurementId:"G-869HQ5KGVX"},O=B(Y),Z=H(O),I=K(O),at=X(O),ot=async i=>{try{const r=A(I,"clients",i),l=await L(r);if(!l.exists())return;const c=l.data().scadenza,n=$(c);await U(r,{statoPercorso:n})}catch(r){console.error("Errore in updateStatoPercorso:",r)}},$=i=>{if(!i)return"N/D";const r=ee(i);if(!r)return"N/D";const l=new Date;l.setHours(0,0,0,0),r.setHours(0,0,0,0);const c=Math.ceil((r-l)/(1e3*60*60*24));return c<0?"Scaduto":c<=7?"In scadenza":"Attivo"},ee=i=>{if(!i)return null;if(typeof(i==null?void 0:i.toDate)=="function")return i.toDate();if(i instanceof Date)return i;if(typeof i=="string")try{const r=new Date(i);return isNaN(r.getTime())?null:r}catch{return null}if(typeof i=="number"){const r=new Date(i);return isNaN(r.getTime())?null:r}return null},z=o.lazy(()=>s(()=>import("./MainLayout-DHJRsv1G.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),te=o.lazy(()=>s(()=>import("./ClientLayout-7T0p8bQs.js"),__vite__mapDeps([9,1,2,3,4]))),ae=o.lazy(()=>s(()=>import("./GuidaLayout-ClZhG-wP.js"),__vite__mapDeps([10,1,2,3,4]))),oe=o.lazy(()=>s(()=>import("./Login-BIARrRrn.js"),__vite__mapDeps([11,1,2,12,13,14,3,4,15,16,17,18,5,6,7,8,19,20,21,22,23,24]))),se=o.lazy(()=>s(()=>import("./Dashboard-DeoWCZds.js"),__vite__mapDeps([25,1,2,16,17,15,18,26,27,28,3,4,8,5,6,7,13,14,12,19,20,21,22,23,24]))),ie=o.lazy(()=>s(()=>import("./Clients-Cx8oZH_C.js"),__vite__mapDeps([29,1,2,16,17,15,18,30,3,4,31,20,8,5,6,7,13,14,12,19,21,22,23,24]))),re=o.lazy(()=>s(()=>import("./ClientDetail-B0OkG7lQ.js"),__vite__mapDeps([32,1,2,16,17,3,4,5,6,7,8,13,14,12,19,20,21,22,23,24,15,18]))),ne=o.lazy(()=>s(()=>import("./EditClient-C-yEz7Sk.js"),__vite__mapDeps([33,1,2,34,16,17,3,4,5,6,7,8,13,14,12,19,20,21,22,23,24,15,18]))),le=o.lazy(()=>s(()=>import("./Updates-C612oGUE.js"),__vite__mapDeps([35,1,2,16,17,3,4,5,6,7,8,13,14,12,19,20,21,22,23,24,15,18]))),ce=o.lazy(()=>s(()=>import("./AdminChat-DDH6zzYs.js"),__vite__mapDeps([36,1,2,15,16,17,18,8,5,6,7,13,14,12,3,4,19,20,21,22,23,24]))),de=o.lazy(()=>s(()=>import("./ClientLogin-B6m2eg3Q.js"),__vite__mapDeps([37,1,2,12,13,14,3,4,15,16,17,18,5,6,7,8,19,20,21,22,23,24]))),T=o.lazy(()=>s(()=>import("./FirstAccess-BMY1aeVh.js"),__vite__mapDeps([38,1,2,15,16,17,18,3,4,5,6,7,8,13,14,12,19,20,21,22,23,24]))),me=o.lazy(()=>s(()=>import("./ClientDashboard-JMctThcb.js"),__vite__mapDeps([39,1,2,15,16,17,18,12,13,14,3,4,8,5,6,7,19,20,21,22,23,24]))),pe=o.lazy(()=>s(()=>import("./ClientAnamnesi-BSpu8Kun.js"),__vite__mapDeps([40,1,2,34,15,16,17,18,3,4,8,5,6,7,41,13,14,12,19,20,21,22,23,24]))),S=o.lazy(()=>s(()=>import("./ClientChecks-Bl3NlxjE.js"),__vite__mapDeps([42,1,2,15,16,17,18,43,44,45,46,47,48,49,3,4,8,5,6,7,41,13,14,12,19,20,21,22,23,24]))),ue=o.lazy(()=>s(()=>import("./ClientPayments-Cf70mGXI.js"),__vite__mapDeps([50,1,2,15,16,17,18,3,4,5,6,7,8,13,14,12,19,20,21,22,23,24]))),_e=o.lazy(()=>s(()=>import("./ClientChat-LT3_jk07.js"),__vite__mapDeps([51,1,2,15,16,17,18,3,4,8,5,6,7,13,14,12,19,20,21,22,23,24]))),he=o.lazy(()=>s(()=>import("./ForgotPassword-sQ1f62xK.js"),__vite__mapDeps([52,1,2,15,16,17,18,12,13,14,3,4,5,6,7,8]))),fe=o.lazy(()=>s(()=>import("./AdminAnamnesi-Bwz5_CtG.js"),__vite__mapDeps([53,1,2,16,17,3,4,8,5,6,7,13,14,12,19,20,21,22,23,24,15,18]))),xe=o.lazy(()=>s(()=>import("./CoachDashboard-coucehNN.js"),__vite__mapDeps([54,1,2,16,17,15,18,3,4,5,6,7,8,13,14,12,19,20,21,22,23,24]))),je=o.lazy(()=>s(()=>import("./CoachAnamnesi-BXorMME3.js"),__vite__mapDeps([55,1,2,16,17,3,4,5,6,7,8,13,14,12,19,20,21,22,23,24,15,18]))),ge=o.lazy(()=>s(()=>import("./CoachUpdates-C4srpCv5.js"),__vite__mapDeps([56,1,2,16,17,3,4,5,6,7,8,13,14,12,19,20,21,22,23,24,15,18]))),Ee=o.lazy(()=>s(()=>import("./CoachClients-Bv1EaZ5J.js"),__vite__mapDeps([57,1,2,16,17,3,4,5,6,7,8,13,14,12,19,20,21,22,23,24,15,18]))),be=o.lazy(()=>s(()=>import("./CoachChat-DO0se6y2.js"),__vite__mapDeps([58,1,2,15,16,17,18,3,4,8,5,6,7,13,14,12,19,20,21,22,23,24]))),ye=o.lazy(()=>s(()=>import("./CoachClientDetail-C9L_aSXI.js"),__vite__mapDeps([59,1,2,16,17,3,4,5,6,7,8,13,14,12,19,20,21,22,23,24,15,18]))),De=o.lazy(()=>s(()=>import("./GuidaMentalFit-D1iZKz7X.js"),__vite__mapDeps([60,1,2,61,19,20,21,22,23,24]))),Ae=o.lazy(()=>s(()=>import("./BusinessHistory-BZILMVZ2.js"),__vite__mapDeps([62,1,2,16,17,3,4,8,5,6,7,13,14,12,19,20,21,22,23,24,15,18]))),Le=o.lazy(()=>s(()=>import("./Collaboratori-C0GQrE08.js"),__vite__mapDeps([63,1,2,16,17,15,18,5,6,7,3,4,8,13,14,12,19,20,21,22,23,24]))),Ie=o.lazy(()=>s(()=>import("./CollaboratoreLogin-DGdqAcPF.js"),__vite__mapDeps([64,1,2,15,16,17,18,3,4,5,6,7,8,13,14,12,19,20,21,22,23,24]))),ve=o.lazy(()=>s(()=>import("./CollaboratoreDashboard-BuhvlJBG.js"),__vite__mapDeps([65,1,2,16,17,15,18,27,28,26,3,4,5,6,7,8,13,14,12,19,20,21,22,23,24]))),Pe=o.lazy(()=>s(()=>import("./CollaboratoreDetail-Hx3147Bf.js"),__vite__mapDeps([66,1,2,16,17,15,18,27,28,26,3,4,5,6,7,8,13,14,12,19,20,21,22,23,24]))),Ce=o.lazy(()=>s(()=>import("./CalendarReport-BnDM_FPd.js"),__vite__mapDeps([67,1,2,16,17,3,4,5,6,7,8,13,14,12,19,20,21,22,23,24,15,18]))),Re=o.lazy(()=>s(()=>import("./NewClient-CZ-1OJit.js"),__vite__mapDeps([68,1,2,34,15,16,17,18,3,4,5,6,7,8,13,14,12,19,20,21,22,23,24]))),ze=o.lazy(()=>s(()=>import("./Dipendenti-_JqcNsLV.js"),__vite__mapDeps([69,1,2,16,17,31,20,8,5,6,7,13,14,12,3,4,19,21,22,23,24,15,18]))),Oe=o.lazy(()=>s(()=>import("./GuideCapture-PgmCOtX5.js"),__vite__mapDeps([70,1,2,16,17,5,6,7,3,4,8,13,14,12,19,20,21,22,23,24,15,18]))),Ve=o.lazy(()=>s(()=>import("./GuideManager-DDORAqyd.js"),__vite__mapDeps([71,1,2,16,17,8,5,6,7,13,14,12,3,4,19,20,21,22,23,24,15,18]))),Te=o.lazy(()=>s(()=>import("./Statistiche-CHe_cjkC.js"),__vite__mapDeps([72,1,2,16,17,27,28,3,4,8,13,14,12,19,20,21,22,23,24,15,18]))),w=o.lazy(()=>s(()=>import("./CalendarPage-kcAqsznM.js"),__vite__mapDeps([73,1,2,16,17,3,4,5,6,7,8,13,14,12,19,20,21,22,23,24,15,18]))),Se=()=>e.jsx("div",{className:"flex justify-center items-center h-screen w-full bg-slate-900",children:e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-rose-500"})}),we=()=>e.jsxs("div",{className:"flex flex-col justify-center items-center min-h-screen bg-slate-900 text-slate-200",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-rose-500"}),e.jsx("p",{className:"mt-4 text-sm",children:"Verifica autenticazione..."})]});function Ne(){const[i,r]=y.useState({isLoading:!0,user:null,isClient:!1,isCoach:!1,isAdmin:!1,isCollaboratore:!1,error:null}),[l,c]=y.useState(null),n=q(),a=J();return y.useEffect(()=>{try{localStorage.setItem("last_path",a.pathname||"/")}catch{}},[a.pathname]),y.useEffect(()=>{if(a.pathname==="/guida"||a.pathname.startsWith("/guida/")){r(p=>({...p,isLoading:!1}));return}let u=!0;const N=F(Z,async p=>{var V;if(u){if(sessionStorage.getItem("creating_collaboratore")==="true"){sessionStorage.removeItem("creating_collaboratore");return}try{if(p){const h=A(I,"clients",p.uid),v=A(I,"roles","admins"),f=A(I,"roles","coaches"),d=A(I,"collaboratori",p.uid),x=await L(d).catch(()=>({exists:()=>!1,data:()=>({})})),j=x.exists();let g=!1,E=!1,b=!1,C,R,P;j||([C,R,P]=await Promise.all([L(v).catch(()=>({exists:()=>!1,data:()=>({uids:[]})})),L(f).catch(()=>({exists:()=>!1,data:()=>({uids:[]})})),L(h).catch(()=>({exists:()=>!1,data:()=>({})}))]),g=C.exists()&&C.data().uids.includes(p.uid),E=R.exists()&&R.data().uids.includes(p.uid),b=P.exists()&&P.data().isClient===!0),!j&&(E||g)&&b&&await k(h).catch(()=>{});let _=null,m=null;g?(_="admin",m="/"):E?(_="coach",m="/coach"):b?(_="client",m=P.data().firstLogin?"/client/first-access":"/client/dashboard"):j?(_="collaboratore",m=x.data().firstLogin?"/collaboratore/first-access":"/collaboratore/dashboard"):(_=null,m="/login"),sessionStorage.setItem("app_role",_||""),!(g&&(a.pathname==="/"||a.pathname==="/clients"||a.pathname==="/new-client"||a.pathname.startsWith("/client/")||a.pathname.startsWith("/edit/")||a.pathname==="/updates"||a.pathname==="/chat"||a.pathname==="/collaboratori"||a.pathname.startsWith("/collaboratore/")||a.pathname.startsWith("/calendar-report/")||a.pathname==="/business-history"||a.pathname==="/guide-manager"||a.pathname==="/admin/dipendenti"||a.pathname==="/statistiche")||E&&(a.pathname==="/coach"||a.pathname==="/coach/clients"||a.pathname.startsWith("/coach/client/")||a.pathname==="/coach/anamnesi"||a.pathname==="/coach/updates"||a.pathname==="/coach/chat"||a.pathname.startsWith("/coach/client/"))||b&&a.pathname.startsWith("/client/")||j&&a.pathname.startsWith("/collaboratore/"))&&a.pathname!==m&&l!==m&&(c(m),n(m,{replace:!0})),r({isLoading:!1,user:p,isClient:b,isCoach:E,isAdmin:g,isCollaboratore:j,error:null})}else if(sessionStorage.removeItem("app_role"),r({isLoading:!1,user:null,isClient:!1,isCoach:!1,isAdmin:!1,isCollaboratore:!1,error:null}),!["/login","/client-login","/collaboratore-login","/client/forgot-password","/guida","/guida/:guideId"].some(f=>a.pathname===f||a.pathname.startsWith("/guida/"))){const f=typeof window<"u"&&(((V=window.matchMedia)==null?void 0:V.call(window,"(display-mode: standalone)").matches)||window.navigator.standalone);let d="/login";if(f)try{const x=localStorage.getItem("last_path")||"";x.startsWith("/collaboratore")?d="/collaboratore-login":x.startsWith("/client")?d="/client-login":d="/login"}catch{d="/login"}l!==d&&(c(d),n(d,{replace:!0}))}}catch(h){console.error("Errore verifica ruolo:",h),r(v=>({...v,isLoading:!1,error:"Errore autenticazione."})),l!=="/login"&&(c("/login"),n("/login",{replace:!0}))}}});return()=>{u=!1,N()}},[a.pathname,n,l]),i.isLoading?e.jsx(we,{}):i.error?e.jsx("div",{className:"text-red-500 text-center p-4",children:i.error}):e.jsx(y.Suspense,{fallback:e.jsx(Se,{}),children:e.jsxs(Q,{children:[e.jsxs(t,{element:e.jsx(ae,{}),children:[e.jsx(t,{path:"/guida",element:e.jsx(De,{})}),e.jsx(t,{path:"/guida/:guideId",element:e.jsx(Oe,{})})]}),e.jsx(t,{path:"/login",element:e.jsx(oe,{})}),e.jsx(t,{path:"/client-login",element:e.jsx(de,{})}),e.jsx(t,{path:"/collaboratore-login",element:e.jsx(Ie,{})}),e.jsx(t,{path:"/client/forgot-password",element:e.jsx(he,{})}),e.jsxs(t,{element:i.isAdmin?e.jsx(z,{}):e.jsx(D,{to:"/login",replace:!0}),children:[e.jsx(t,{path:"/",element:e.jsx(se,{})}),e.jsx(t,{path:"/clients",element:e.jsx(ie,{})}),e.jsx(t,{path:"/new-client",element:e.jsx(Re,{})}),e.jsx(t,{path:"/client/:clientId",element:e.jsx(re,{})}),e.jsx(t,{path:"/edit/:id",element:e.jsx(ne,{})}),e.jsx(t,{path:"/updates",element:e.jsx(le,{})}),e.jsx(t,{path:"/chat",element:e.jsx(ce,{})}),e.jsx(t,{path:"/client/:id/anamnesi",element:e.jsx(fe,{})}),e.jsx(t,{path:"/collaboratori",element:e.jsx(Le,{})}),e.jsx(t,{path:"/collaboratore-detail",element:e.jsx(Pe,{})}),e.jsx(t,{path:"/calendar",element:e.jsx(w,{})}),e.jsx(t,{path:"/calendar-report/:date",element:e.jsx(Ce,{})}),e.jsx(t,{path:"/business-history",element:e.jsx(Ae,{})}),e.jsx(t,{path:"/guide-manager",element:e.jsx(Ve,{})}),e.jsx(t,{path:"/admin/dipendenti",element:e.jsx(ze,{})}),e.jsx(t,{path:"/statistiche",element:e.jsx(Te,{})})]}),e.jsxs(t,{element:i.isCoach?e.jsx(z,{}):e.jsx(D,{to:"/login",replace:!0}),children:[e.jsx(t,{path:"/coach",element:e.jsx(xe,{})}),e.jsx(t,{path:"/coach/clients",element:e.jsx(Ee,{})}),e.jsx(t,{path:"/coach/client/:id",element:e.jsx(ye,{})}),e.jsx(t,{path:"/coach/anamnesi",element:e.jsx(je,{})}),e.jsx(t,{path:"/coach/updates",element:e.jsx(ge,{})}),e.jsx(t,{path:"/coach/chat",element:e.jsx(be,{})}),e.jsx(t,{path:"/coach/client/:clientId/checks",element:e.jsx(S,{})})]}),e.jsxs(t,{element:i.isClient?e.jsx(te,{}):e.jsx(D,{to:"/client-login",replace:!0}),children:[e.jsx(t,{path:"/client/first-access",element:e.jsx(T,{})}),e.jsx(t,{path:"/client/dashboard",element:e.jsx(me,{})}),e.jsx(t,{path:"/client/anamnesi",element:e.jsx(pe,{})}),e.jsx(t,{path:"/client/checks",element:e.jsx(S,{})}),e.jsx(t,{path:"/client/payments",element:e.jsx(ue,{})}),e.jsx(t,{path:"/client/chat",element:e.jsx(_e,{})})]}),e.jsxs(t,{element:i.isCollaboratore?e.jsx(z,{}):e.jsx(D,{to:"/collaboratore-login",replace:!0}),children:[e.jsx(t,{path:"/collaboratore/first-access",element:e.jsx(T,{})}),e.jsx(t,{path:"/collaboratore/dashboard",element:e.jsx(ve,{})}),e.jsx(t,{path:"/collaboratore/calendar",element:e.jsx(w,{})})]}),e.jsx(t,{path:"*",element:e.jsx(D,{to:i.user?i.isAdmin?"/":i.isCoach?"/coach":i.isCollaboratore?"/collaboratore/dashboard":"/login":"/login",replace:!0})})]})})}G.createRoot(document.getElementById("root")).render(e.jsx(o.StrictMode,{children:e.jsx(M,{children:e.jsx(Ne,{})})}));export{Z as a,$ as c,I as d,Y as f,at as s,ee as t,ot as u};
