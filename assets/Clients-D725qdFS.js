import{r as o,j as e}from"./react-CrXOBDSJ.js";import{t as i,a as te,d as A,c as pe,u as Ee}from"./index-BqQ4SUJN.js";import{I as se,H as Fe,B as Oe,A as ae,P as Ge,G as Ve}from"./@firebase-CuwLCerw.js";import{s as re}from"./firebase-Bp3EI6Ad.js";import{P as Re}from"./papaparse-rLJvb3Z-.js";import{a as Be}from"./react-router-BxpCmtJ-.js";import{e as Ue,s as le,a as qe,b as ne,f as ie,i as oe}from"./date-fns-K6w5eF5u.js";import{k as I,l as de,m as ce,h as U,j as xe,n as G,b as E,a as Qe,C as Xe,o as F,p as O,X as he,g as _e,q as He,F as Je,r as Ke,s as We,A as Ye,t as Ze}from"./lucide-react-CCY59hBS.js";import{m as C,A as Q}from"./framer-motion-BAPjnw1b.js";import"./core-js-ChGsxLo2.js";import"./react-dom-BpmKF3Ga.js";import"./scheduler-DYLXRpC5.js";import"./react-router-dom-9rcY47vU.js";import"./@remix-run-CjG9tKj3.js";import"./jspdf-7Jyqi_bl.js";import"./@babel-Cvov1XSu.js";import"./fflate-XZmX483V.js";import"./fast-png-CUrN0NP5.js";import"./iobuffer-DZ1zOcUT.js";import"./pako-B9FS3IR_.js";import"./tslib-BGVaTf34.js";import"./idb-Bn1DMRyg.js";import"./motion-dom-C8PdgYBP.js";import"./motion-utils-DBsP9okC.js";const et=({message:n,type:p,onDismiss:g})=>e.jsx(Q,{children:n&&e.jsxs(C.div,{initial:{opacity:0,y:-50},animate:{opacity:1,y:0},exit:{opacity:0,y:-50},className:`fixed top-5 right-5 z-50 flex items-center gap-4 p-4 rounded-lg border ${p==="error"?"bg-red-900/80 text-red-300 border-red-500/30":"bg-emerald-900/80 text-emerald-300 border-emerald-500/30"} backdrop-blur-md shadow-lg`,children:[e.jsx(G,{className:p==="error"?"text-red-400":"text-emerald-400"}),e.jsx("p",{children:n}),e.jsx("button",{onClick:g,className:"p-1 rounded-full hover:bg-white/10",children:e.jsx(he,{size:16})})]})}),me=n=>{const p=n.map(d=>{var u,j;return{Nome:d.name||"N/D",Email:d.email||"N/D",Telefono:d.phone||"N/D",Scadenza:((u=i(d.scadenza))==null?void 0:u.toLocaleDateString("it-IT"))||"N/D",Stato:d.statoPercorso||pe(d.scadenza),Pagamenti:d.payments?d.payments.reduce((S,c)=>S+(c.amount||0),0):0,"Data Inizio":((j=i(d.startDate))==null?void 0:j.toLocaleDateString("it-IT"))||"N/D"}}),g=Re.unparse(p),k=new Blob([g],{type:"text/csv;charset=utf-8;"}),b=document.createElement("a");b.href=URL.createObjectURL(k),b.download="clienti.csv",b.click()},q=({hasAnamnesi:n})=>e.jsxs("span",{className:`px-2.5 py-1 text-xs font-medium rounded-full flex items-center gap-1 border transition-all ${n?"bg-emerald-900/40 text-emerald-300 border-emerald-600/50 hover:bg-emerald-900/60":"bg-slate-800/50 text-slate-400 border-slate-700 hover:bg-slate-700/70"}`,children:[e.jsx(Je,{size:12})," ",n?"Inviata":"Non Inviata"]}),tt=({isOpen:n,onClose:p,onConfirm:g,clientName:k})=>e.jsx(Q,{children:n&&e.jsx(C.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:p,className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex justify-center items-center z-50 p-4",children:e.jsxs(C.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:b=>b.stopPropagation(),className:"w-full max-w-md bg-slate-800/60 backdrop-blur-sm rounded-xl border border-slate-700 p-6 text-center shadow-xl",children:[e.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-900/40 mb-4",children:e.jsx(G,{className:"h-6 w-6 text-red-400"})}),e.jsx("h3",{className:"text-lg font-bold text-slate-100",children:"Conferma Eliminazione"}),e.jsxs("p",{className:"text-sm text-slate-400 mt-2",children:["Sei sicuro di voler eliminare il cliente ",e.jsx("strong",{className:"text-rose-400",children:k}),"? L'operazione è irreversibile."]}),e.jsxs("div",{className:"mt-6 flex justify-center gap-4",children:[e.jsx("button",{onClick:p,className:"px-6 py-2 text-sm font-semibold text-slate-300 bg-slate-700/50 hover:bg-slate-700/70 rounded-lg transition-colors border border-slate-600",children:"Annulla"}),e.jsx("button",{onClick:g,className:"px-6 py-2 text-sm font-semibold text-white bg-rose-600 hover:bg-rose-700 rounded-lg transition-colors",children:"Elimina"})]})]})})});function Dt(){const n=Be(),[p,g]=o.useState([]),[k,b]=o.useState(!0),[d,u]=o.useState(null),[j,S]=o.useState(""),[c,h]=o.useState("all"),[f,X]=o.useState("startDate"),[$,V]=o.useState("desc"),[N,be]=o.useState({}),[L,_]=o.useState("list"),[H,R]=o.useState({message:"",type:""}),[w,J]=o.useState(new Date),[D,K]=o.useState(!0),[M,ue]=o.useState({}),[ge,B]=o.useState(!1),[W,je]=o.useState(null),[Y,fe]=o.useState([]),Ne=t=>{const s=p.filter(a=>{const l=i(a.createdAt),r=i(a.startDate),v=l||r;return v&&oe(v,t)});je(t),fe(s),B(!0)},ye=e.jsxs("button",{onClick:()=>K(t=>!t),className:`flex items-center gap-2 px-3 py-1.5 text-sm rounded-lg transition-colors ${D?"bg-rose-600 text-white":"bg-slate-700 text-slate-300"}`,children:[e.jsx(E,{size:14})," Calendario"]}),z=(t,s="error")=>{R({message:t,type:s}),setTimeout(()=>R({message:"",type:""}),6e3)},ve=async()=>{try{await re(te),n("/login")}catch(t){z(`Errore logout: ${t.message}`,"error")}};o.useEffect(()=>{if(sessionStorage.getItem("app_role")!=="admin"){re(te).then(()=>n("/login"));return}const s=se(A,"clients"),a=Fe(s,async l=>{try{const r=l.docs.map(m=>{const x=m.data();return{id:m.id,name:x.name,email:x.email,phone:x.phone,scadenza:x.scadenza,startDate:x.startDate,createdAt:x.createdAt,statoPercorso:x.statoPercorso||pe(x.scadenza),payments:x.payments||[]}}),v=r.map(m=>Oe(ae(A,`clients/${m.id}/anamnesi`,"initial")).catch(()=>({exists:()=>!1}))),Le=await Promise.all(v),Z={};r.forEach((m,x)=>{Z[m.id]=Le[x].exists()}),be(Z);const Me=r.map(async m=>{try{const Pe=(await Ge(se(A,"clients",m.id,"payments"))).docs.reduce((Ae,Ie)=>Ae+(Ie.data().amount||0),0);return{id:m.id,sum:Pe}}catch{return{id:m.id,sum:0}}}),Te=await Promise.all(Me),ee={};Te.forEach(({id:m,sum:x})=>{ee[m]=x}),ue(ee),r.forEach(m=>Ee(m.id)),g(r),b(!1)}catch{z("Errore caricamento clienti","error"),b(!1)}},l=>{z("Errore connessione","error"),b(!1)});return()=>a()},[n]);const we=async()=>{if(d)try{await Ve(ae(A,"clients",d.id)),g(t=>t.filter(s=>s.id!==d.id)),z("Cliente eliminato!","success")}catch(t){z(`Errore: ${t.message}`,"error")}finally{u(null)}},T=t=>{f===t?V(s=>s==="desc"?"asc":"desc"):(X(t),V("desc"))},P=t=>f!==t?null:$==="desc"?e.jsx(Ye,{size:14}):e.jsx(Ze,{size:14}),y=o.useMemo(()=>{let t=p.filter(s=>{if(!((s.name||"").toLowerCase().includes(j.toLowerCase())||(s.email||"").toLowerCase().includes(j.toLowerCase())))return!1;const l=new Date,r=i(s.scadenza),v=r?Math.ceil((r-l)/(1e3*60*60*24)):null;switch(c){case"active":return r&&r>l;case"expiring":return r&&v<=15&&v>0;case"expired":return r&&r<l;case"no-check":return!N[s.id];case"has-check":return N[s.id];case"recent":return!0;default:return!0}});return t.sort((s,a)=>{let l,r;switch(f){case"name":l=s.name||"",r=a.name||"";break;case"startDate":l=i(s.startDate)||new Date(0),r=i(a.startDate)||new Date(0);break;case"expiry":l=i(s.scadenza)||new Date(0),r=i(a.scadenza)||new Date(0);break;case"lastCheck":l=N[s.id]?1:0,r=N[a.id]?1:0;break;case"recent":l=i(s.startDate)||new Date(0),r=i(a.startDate)||new Date(0);break;default:l=0,r=0}return l<r?$==="desc"?1:-1:l>r?$==="desc"?-1:1:0}),t},[p,j,c,f,$,N]),Ce=Ue({start:le(w),end:qe(w)}),ke=t=>y.filter(s=>{const a=i(s.createdAt),l=i(s.startDate),r=a||l;return r&&oe(r,t)}),De=e.jsxs("div",{className:"flex items-center gap-1 bg-slate-700/50 border border-slate-600 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>_("list"),className:`p-2 rounded-md transition-colors ${L==="list"?"bg-rose-600 text-white":"text-slate-400 hover:text-slate-200"}`,title:"Lista",children:e.jsx(Ke,{size:16})}),e.jsx("button",{onClick:()=>_("card"),className:`p-2 rounded-md transition-colors ${L==="card"?"bg-rose-600 text-white":"text-slate-400 hover:text-slate-200"}`,title:"Schede",children:e.jsx(We,{size:16})})]}),ze=e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative",children:[e.jsx(I,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18}),e.jsx("input",{value:j,onChange:t=>S(t.target.value),className:"bg-slate-700/50 border border-slate-600 rounded-lg px-3 py-2 pl-10 w-full min-w-48 outline-none focus:ring-2 focus:ring-rose-500 text-sm text-slate-200 placeholder:text-slate-500",placeholder:"Cerca..."})]}),e.jsxs("button",{onClick:()=>n("/new-client"),className:"flex items-center gap-2 px-3 py-2 bg-rose-600 hover:bg-rose-700 text-white text-sm font-medium rounded-lg transition-colors",children:[e.jsx(de,{size:16})," Nuovo"]}),e.jsxs("button",{onClick:()=>me(p),className:"flex items-center gap-2 px-3 py-2 bg-cyan-600 hover:bg-cyan-700 text-white text-sm font-medium rounded-lg transition-colors",children:[e.jsx(ce,{size:16})," CSV"]}),e.jsxs("button",{onClick:ve,className:"flex items-center gap-2 px-4 py-2 bg-rose-600 hover:bg-rose-700 text-white text-sm font-medium rounded-lg transition-colors",children:[e.jsx(_e,{size:16})," Logout"]}),e.jsxs("div",{className:"flex gap-2 ml-2",children:[ye,De]})]}),Se=e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>h("all"),className:`px-3 py-1.5 text-sm rounded-lg transition-colors ${c==="all"?"bg-rose-600 text-white":"text-slate-400 hover:bg-white/10"}`,children:"Tutti"}),e.jsxs("button",{onClick:()=>h("active"),className:`px-3 py-1.5 text-sm rounded-lg flex items-center gap-1 transition-colors ${c==="active"?"bg-emerald-600 text-white":"text-emerald-400 hover:bg-emerald-900/30"}`,children:[e.jsx(U,{size:14})," Attivi"]}),e.jsxs("button",{onClick:()=>h("expiring"),className:`px-3 py-1.5 text-sm rounded-lg flex items-center gap-1 transition-colors ${c==="expiring"?"bg-amber-600 text-white":"text-amber-400 hover:bg-amber-900/30"}`,children:[e.jsx(xe,{size:14})," In Scadenza"]}),e.jsxs("button",{onClick:()=>h("expired"),className:`px-3 py-1.5 text-sm rounded-lg flex items-center gap-1 transition-colors ${c==="expired"?"bg-red-600 text-white":"text-red-400 hover:bg-red-900/30"}`,children:[e.jsx(G,{size:14})," Scaduti"]}),e.jsxs("button",{onClick:()=>h("has-check"),className:`px-3 py-1.5 text-sm rounded-lg flex items-center gap-1 transition-colors ${c==="has-check"?"bg-cyan-600 text-white":"text-cyan-400 hover:bg-cyan-900/30"}`,children:[e.jsx(U,{size:14})," Con Anamnesi"]}),e.jsxs("button",{onClick:()=>h("no-check"),className:`px-3 py-1.5 text-sm rounded-lg flex items-center gap-1 transition-colors ${c==="no-check"?"bg-gray-600 text-white":"text-gray-400 hover:bg-gray-900/30"}`,children:[e.jsx(He,{size:14})," Senza Anamnesi"]}),e.jsxs("button",{onClick:()=>{h("recent"),X("recent"),V("desc")},className:`px-3 py-1.5 text-sm rounded-lg flex items-center gap-1 transition-colors ${c==="recent"?"bg-purple-600 text-white":"text-purple-400 hover:bg-purple-900/30"}`,children:[e.jsx(E,{size:14})," Più Recenti"]})]}),$e=e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>T("name"),className:`px-3 py-1.5 text-sm rounded-lg flex items-center gap-1 transition-colors ${f==="name"?"bg-rose-600 text-white":"text-slate-400 hover:bg-white/10"}`,children:["Nome ",P("name")]}),e.jsxs("button",{onClick:()=>T("startDate"),className:`px-3 py-1.5 text-sm rounded-lg flex items-center gap-1 transition-colors ${f==="startDate"?"bg-rose-600 text-white":"text-slate-400 hover:bg-white/10"}`,children:["Inizio ",P("startDate")]}),e.jsxs("button",{onClick:()=>T("expiry"),className:`px-3 py-1.5 text-sm rounded-lg flex items-center gap-1 transition-colors ${f==="expiry"?"bg-rose-600 text-white":"text-slate-400 hover:bg-white/10"}`,children:["Scadenza ",P("expiry")]}),e.jsxs("button",{onClick:()=>T("lastCheck"),className:`px-3 py-1.5 text-sm rounded-lg flex items-center gap-1 transition-colors ${f==="lastCheck"?"bg-rose-600 text-white":"text-slate-400 hover:bg-white/10"}`,children:["Anamnesi ",P("lastCheck")]})]});return k?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-b from-[#1b2735] to-[#090a0f]",children:e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-rose-500"})}):e.jsxs(e.Fragment,{children:[e.jsx(et,{message:H.message,type:H.type,onDismiss:()=>R({message:"",type:""})}),e.jsx(tt,{isOpen:!!d,onClose:()=>u(null),onConfirm:we,clientName:d==null?void 0:d.name}),e.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 max-w-7xl mx-auto space-y-6 pb-24 md:pb-8",children:[e.jsxs("div",{className:"md:hidden bg-slate-800/60 backdrop-blur-sm border border-slate-700 rounded-2xl p-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-100 mb-4",children:"Clienti"}),e.jsxs("div",{className:"relative mb-3",children:[e.jsx(I,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18}),e.jsx("input",{value:j,onChange:t=>S(t.target.value),className:"bg-slate-700/50 border border-slate-600 rounded-lg px-3 py-2.5 pl-10 w-full outline-none focus:ring-2 focus:ring-rose-500 text-sm text-slate-200 placeholder:text-slate-500",placeholder:"Cerca clienti..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{onClick:()=>n("/new-client"),className:"flex items-center justify-center gap-2 px-3 py-2.5 bg-rose-600 hover:bg-rose-700 text-white text-sm font-medium rounded-lg transition-colors",children:[e.jsx(de,{size:16})," Nuovo"]}),e.jsxs("button",{onClick:()=>me(p),className:"flex items-center justify-center gap-2 px-3 py-2.5 bg-cyan-600 hover:bg-cyan-700 text-white text-sm font-medium rounded-lg transition-colors",children:[e.jsx(ce,{size:16})," CSV"]})]}),e.jsxs("div",{className:"mt-3 flex gap-2 overflow-x-auto pb-2 scrollbar-hidden",children:[e.jsx("button",{onClick:()=>h("all"),className:`px-3 py-1.5 text-xs rounded-full whitespace-nowrap transition-colors ${c==="all"?"bg-rose-600 text-white":"bg-slate-700 text-slate-300"}`,children:"Tutti"}),e.jsxs("button",{onClick:()=>h("active"),className:`px-3 py-1.5 text-xs rounded-full whitespace-nowrap transition-colors flex items-center gap-1 ${c==="active"?"bg-emerald-600 text-white":"bg-slate-700 text-emerald-400"}`,children:[e.jsx(U,{size:12})," Attivi"]}),e.jsxs("button",{onClick:()=>h("expiring"),className:`px-3 py-1.5 text-xs rounded-full whitespace-nowrap transition-colors flex items-center gap-1 ${c==="expiring"?"bg-amber-600 text-white":"bg-slate-700 text-amber-400"}`,children:[e.jsx(xe,{size:12})," Scadenza"]}),e.jsxs("button",{onClick:()=>h("expired"),className:`px-3 py-1.5 text-xs rounded-full whitespace-nowrap transition-colors flex items-center gap-1 ${c==="expired"?"bg-red-600 text-white":"bg-slate-700 text-red-400"}`,children:[e.jsx(G,{size:12})," Scaduti"]})]})]}),e.jsxs("div",{className:"hidden md:block bg-slate-800/60 backdrop-blur-sm border border-slate-700 rounded-2xl p-5 space-y-5",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-100",children:"Gestione Clienti"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:ze})]}),e.jsx("div",{className:"border-t border-white/10"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-semibold text-slate-400 uppercase mb-3",children:"Filtri"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Se})]}),e.jsx("div",{className:"border-t border-white/10"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-semibold text-slate-400 uppercase mb-3",children:"Ordinamento"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:$e})]})]}),e.jsx("div",{className:"md:hidden",children:e.jsxs("button",{onClick:()=>K(!D),className:`w-full flex items-center justify-center gap-2 px-4 py-2.5 rounded-lg text-sm font-medium transition-colors ${D?"bg-rose-600 text-white":"bg-slate-700 text-slate-300"}`,children:[e.jsx(E,{size:16})," ",D?"Nascondi":"Mostra"," Calendario"]})}),D&&e.jsxs("div",{className:"bg-slate-800/60 backdrop-blur-sm rounded-xl p-4 md:p-6 border border-slate-700 shadow-xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("button",{onClick:()=>J(ne(w,-1)),className:"p-2 hover:bg-slate-700 rounded-lg transition",children:e.jsx(Qe,{size:18,className:"text-slate-400"})}),e.jsxs("h3",{className:"text-base md:text-lg font-bold text-slate-100 flex items-center gap-2",children:[e.jsx(E,{size:18,className:"md:block hidden"})," ",ie(w,"MMMM yyyy")]}),e.jsx("button",{onClick:()=>J(ne(w,1)),className:"p-2 hover:bg-slate-700 rounded-lg transition",children:e.jsx(Xe,{size:18,className:"text-slate-400"})})]}),e.jsxs("div",{className:"grid grid-cols-7 gap-1 md:gap-3 text-center text-xs md:text-sm",children:[["D","L","M","M","G","V","S"].map((t,s)=>e.jsxs("div",{className:"font-bold text-slate-400 py-2",children:[e.jsx("span",{className:"md:hidden",children:t}),e.jsx("span",{className:"hidden md:inline",children:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"][s]})]},t)),Array.from({length:le(w).getDay()},(t,s)=>e.jsx("div",{},`empty-${s}`)),Ce.map(t=>{const s=ke(t);return e.jsxs("div",{onClick:()=>Ne(t),className:`min-h-16 md:min-h-28 p-1 md:p-3 rounded-lg md:rounded-xl border transition-all cursor-pointer
                      ${s.length>0?"bg-rose-900/40 border-rose-600 hover:bg-rose-900/60":"bg-slate-800/50 border-slate-700 hover:bg-slate-700/70"}`,children:[e.jsx("p",{className:"text-xs md:text-sm font-bold text-slate-300 mb-0.5 md:mb-1",children:ie(t,"d")}),e.jsxs("div",{className:"space-y-1 md:space-y-1.5 max-h-12 md:max-h-20 overflow-y-auto",children:[s.slice(0,2).map(a=>{var l;return e.jsxs("div",{className:"hidden md:flex bg-gradient-to-r from-rose-600/30 to-purple-600/30 p-2 rounded-lg text-xs justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-rose-300",children:a.name}),e.jsx("p",{className:"text-cyan-300",children:(l=i(a.scadenza))==null?void 0:l.toLocaleDateString("it-IT")})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:r=>{r.stopPropagation(),n(`/edit/${a.id}`)},className:"text-cyan-400 hover:text-cyan-300",children:e.jsx(F,{size:14})}),e.jsx("button",{onClick:r=>{r.stopPropagation(),u(a)},className:"text-red-400 hover:text-red-300",children:e.jsx(O,{size:14})})]})]},a.id)}),s.length>0&&e.jsx("div",{className:"md:hidden w-2 h-2 bg-rose-500 rounded-full mx-auto"})]}),s.length===0&&e.jsx("p",{className:"hidden md:block text-xs text-slate-500 italic mt-2",children:"Nessuna scadenza"})]},t.toISOString())})]})]}),L==="list"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"md:hidden space-y-3",children:[y.map(t=>{var r;const s=i(t.scadenza),a=s?Math.ceil((s-new Date)/(1e3*60*60*24)):null,l=M[t.id]??0;return e.jsxs(C.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-slate-800/60 backdrop-blur-sm rounded-xl p-4 border border-slate-700",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("button",{onClick:()=>n(`/client/${t.id}`),className:"text-left font-semibold text-slate-100 hover:text-rose-400 transition-colors text-base",children:t.name||"-"}),e.jsx("p",{className:"text-xs text-slate-400 mt-0.5",children:t.email})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>n(`/edit/${t.id}`),className:"p-2 text-amber-400 hover:bg-white/10 rounded-lg transition-all",children:e.jsx(F,{size:16})}),e.jsx("button",{onClick:()=>u(t),className:"p-2 text-red-400 hover:bg-white/10 rounded-lg transition-all",children:e.jsx(O,{size:16})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs mb-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Inizio:"}),e.jsx("p",{className:"text-slate-300 font-medium",children:((r=i(t.startDate))==null?void 0:r.toLocaleDateString("it-IT"))||"N/D"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Scadenza:"}),e.jsx("p",{className:`font-medium ${a<0?"text-red-400":a<=7?"text-amber-400":"text-emerald-400"}`,children:(s==null?void 0:s.toLocaleDateString("it-IT"))||"N/D"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex gap-2",children:[a!==null&&e.jsx("span",{className:`text-xs px-2 py-1 rounded-full font-medium ${a<0?"bg-red-900/40 text-red-300 border border-red-600/50":a<=7?"bg-amber-900/40 text-amber-300 border border-amber-600/50":"bg-emerald-900/40 text-emerald-300 border border-emerald-600/50"}`,children:a<0?"Scaduto":`${a} gg`}),e.jsx(q,{hasAnamnesi:N[t.id]})]}),e.jsxs("span",{className:"text-xs px-2 py-1 rounded-full bg-cyan-900/40 text-cyan-300 border border-cyan-600/50 font-medium",children:["€",l.toFixed(2)]})]})]},t.id)}),y.length===0&&e.jsxs("div",{className:"text-center py-12 text-slate-500",children:[e.jsx(I,{size:48,className:"mx-auto mb-3 opacity-50"}),e.jsx("p",{className:"text-sm",children:"Nessun cliente trovato"})]})]}),e.jsx("div",{className:"hidden md:block bg-slate-800/60 backdrop-blur-sm rounded-xl p-3 md:p-6 border border-slate-700 shadow-xl",children:e.jsx("div",{className:"overflow-x-auto -mx-3 md:mx-0",children:e.jsxs("table",{className:"w-full min-w-[800px] text-xs md:text-sm text-left text-slate-300",children:[e.jsx("thead",{className:"text-slate-400 uppercase text-[10px] md:text-xs",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 md:p-4 min-w-[150px] md:min-w-[180px] font-bold",children:"Nome"}),e.jsx("th",{className:"p-2 md:p-4 min-w-[100px] md:min-w-[140px] font-bold",children:"Inizio"}),e.jsx("th",{className:"p-2 md:p-4 min-w-[120px] md:min-w-[160px] font-bold",children:"Scadenza"}),e.jsx("th",{className:"p-2 md:p-4 min-w-[120px] md:min-w-[160px] font-bold",children:"Anamnesi"}),e.jsx("th",{className:"p-2 md:p-4 text-right min-w-[100px] md:min-w-[120px] font-bold",children:"Azioni"})]})}),e.jsxs("tbody",{children:[y.map(t=>{var r;const s=i(t.scadenza),a=s?Math.ceil((s-new Date)/(1e3*60*60*24)):null,l=M[t.id]??0;return e.jsxs("tr",{className:"border-t border-white/10 hover:bg-white/10 transition-all",children:[e.jsx("td",{className:"p-2 md:p-4 font-medium min-w-[150px] md:min-w-[180px]",children:e.jsxs("div",{className:"flex items-center justify-between gap-2 md:gap-3",children:[e.jsx("button",{onClick:()=>n(`/client/${t.id}`),className:"text-left hover:text-rose-400 transition-colors truncate",children:t.name||"-"}),e.jsxs("span",{className:"text-[10px] md:text-xs px-1.5 md:px-2 py-0.5 md:py-1 rounded-full bg-cyan-900/40 text-cyan-300 border border-cyan-600/50 whitespace-nowrap",children:["€",l.toFixed(2)]})]})}),e.jsx("td",{className:"p-2 md:p-4 min-w-[100px] md:min-w-[140px] text-[10px] md:text-xs",children:((r=i(t.startDate))==null?void 0:r.toLocaleDateString("it-IT"))||"N/D"}),e.jsx("td",{className:"p-2 md:p-4 min-w-[120px] md:min-w-[160px]",children:s?e.jsxs("div",{className:"flex items-center gap-1 md:gap-2",children:[e.jsx("span",{className:"text-[10px] md:text-xs",children:s.toLocaleDateString("it-IT")}),a!==null&&e.jsx("span",{className:`text-[9px] md:text-xs px-1.5 md:px-2 py-0.5 md:py-1 rounded-full font-medium transition-all whitespace-nowrap ${a<0?"bg-red-900/40 text-red-300 border border-red-600/50 hover:bg-red-900/60":a<=7?"bg-amber-900/40 text-amber-300 border border-amber-600/50 hover:bg-amber-900/60":"bg-emerald-900/40 text-emerald-300 border border-emerald-600/50 hover:bg-emerald-900/60"}`,children:a<0?"Scaduto":`${a} gg`})]}):"N/D"}),e.jsx("td",{className:"p-2 md:p-4 min-w-[120px] md:min-w-[160px]",children:e.jsx(q,{hasAnamnesi:N[t.id]})}),e.jsx("td",{className:"p-2 md:p-4 text-right min-w-[100px] md:min-w-[120px]",children:e.jsxs("div",{className:"flex items-center gap-0.5 md:gap-1 justify-end",children:[e.jsxs("button",{onClick:()=>n(`/edit/${t.id}`),className:"p-1 md:p-2 text-slate-400 hover:text-amber-400 hover:bg-white/10 rounded-lg transition-all",title:"Modifica",children:[e.jsx(F,{size:14,className:"md:hidden"}),e.jsx(F,{size:16,className:"hidden md:block"})]}),e.jsxs("button",{onClick:()=>u(t),className:"p-1 md:p-2 text-slate-400 hover:text-red-400 hover:bg-white/10 rounded-lg transition-all",title:"Elimina",children:[e.jsx(O,{size:14,className:"md:hidden"}),e.jsx(O,{size:16,className:"hidden md:block"})]})]})})]},t.id)}),y.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center p-8 text-slate-500 italic",children:"Nessun cliente trovato con i filtri selezionati."})})]})]})})})]}),L==="card"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:[y.map(t=>{var r;const s=i(t.scadenza),a=s?Math.ceil((s-new Date)/(1e3*60*60*24)):null,l=M[t.id]??0;return e.jsxs("div",{className:"bg-slate-800/60 backdrop-blur-sm rounded-xl p-5 border border-slate-700 hover:border-slate-600 transition-all",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:t.name}),e.jsx("p",{className:"text-xs text-rose-400",children:t.email}),e.jsx("p",{className:"text-xs text-slate-500",children:t.phone||"N/D"})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>n(`/client/${t.id}`),className:"text-xs text-cyan-400 hover:text-cyan-300",children:"Dettagli"}),e.jsx("button",{onClick:()=>u(t),className:"text-xs text-red-400 hover:text-red-300",children:"Elimina"})]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Inizio"}),e.jsx("span",{className:"text-slate-300",children:((r=i(t.startDate))==null?void 0:r.toLocaleDateString("it-IT"))||"N/D"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Scadenza"}),e.jsx("span",{className:`font-medium ${a<0?"text-red-400":a<=7?"text-amber-400":"text-emerald-400"}`,children:(s==null?void 0:s.toLocaleDateString("it-IT"))||"N/D"})]}),a!==null&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Giorni"}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full font-medium ${a<0?"bg-red-900/40 text-red-300 border border-red-600/50":a<=7?"bg-amber-900/40 text-amber-300 border border-amber-600/50":"bg-emerald-900/40 text-emerald-300 border border-emerald-600/50"}`,children:a<0?"Scaduto":`${a} gg`})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Pagamenti"}),e.jsxs("span",{className:"font-medium text-cyan-400",children:["€",l.toFixed(2)]})]})]}),e.jsx("div",{className:"mt-4 pt-3 border-t border-white/10",children:e.jsx(q,{hasAnamnesi:N[t.id]})}),e.jsx("div",{className:"mt-4 flex gap-2",children:e.jsx("button",{onClick:()=>n(`/edit/${t.id}`),className:"flex-1 py-2 bg-rose-600 text-white text-xs rounded-lg hover:bg-rose-700 transition font-medium",children:"Modifica"})})]},t.id)}),y.length===0&&e.jsxs("div",{className:"col-span-full text-center py-12 text-slate-500",children:[e.jsx(I,{size:48,className:"mx-auto mb-3 opacity-50"}),e.jsx("p",{className:"text-sm",children:"Nessun cliente trovato"})]})]})]}),e.jsx(Q,{children:ge&&e.jsx(C.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>B(!1),className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex justify-center items-center z-50 p-4",children:e.jsxs(C.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},onClick:t=>t.stopPropagation(),className:"w-full max-w-2xl bg-slate-800/60 backdrop-blur-sm rounded-xl border border-slate-700 p-6 shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-100",children:["Clienti aggiunti il ",W?new Date(W).toLocaleDateString("it-IT"):""]}),e.jsx("button",{onClick:()=>B(!1),className:"p-1.5 rounded-full hover:bg-white/10",children:e.jsx(he,{size:18,className:"text-slate-300"})})]}),Y.length>0?e.jsx("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto",children:Y.map(t=>{var s,a;return e.jsxs("div",{className:"bg-slate-800/60 border border-slate-700 rounded-xl p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-slate-100 font-semibold",children:t.name}),e.jsx("p",{className:"text-xs text-rose-300",children:t.email}),e.jsxs("div",{className:"flex gap-3 text-xs text-slate-400",children:[e.jsxs("span",{children:["Inizio: ",((s=i(t.startDate))==null?void 0:s.toLocaleDateString("it-IT"))||"N/D"]}),e.jsxs("span",{children:["Scadenza: ",((a=i(t.scadenza))==null?void 0:a.toLocaleDateString("it-IT"))||"N/D"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs px-2 py-1 rounded-full bg-cyan-900/40 text-cyan-300 border border-cyan-600/50",children:["€",(M[t.id]??0).toFixed(2)]}),e.jsx("button",{onClick:()=>n(`/client/${t.id}`),className:"px-3 py-1.5 text-xs rounded-lg bg-rose-600 hover:bg-rose-700 text-white transition-colors",children:"Dettagli"})]})]},t.id)})}):e.jsx("p",{className:"text-slate-400 text-sm",children:"Nessun cliente aggiunto in questa data."})]})})}),e.jsx("button",{onClick:()=>n("/new-client"),className:"hidden md:flex fixed bottom-6 right-6 w-14 h-14 bg-rose-600 text-white rounded-full shadow-lg hover:bg-rose-700 transition items-center justify-center text-3xl font-bold z-40",children:"+"})]})}export{Dt as default};
