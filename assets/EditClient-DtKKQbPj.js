import{r as m,j as e}from"./react-FJB7Hj_2.js";import{u as N}from"./react-hook-form-CR94GzZN.js";import{d as u}from"./index-C1w-7Ivh.js";import{y as f,z as y,A as S}from"./@firebase-D5dUFubL.js";import{a as z,g as w}from"./react-router-DF4cN2Hx.js";import{m as D}from"./framer-motion-Bo7GrDk8.js";import{A as C,r as E}from"./lucide-react-BYK_Rxhn.js";import"./papaparse-BHXrM2Hc.js";import"./react-dom-BrtcLnxQ.js";import"./scheduler-DYLXRpC5.js";import"./react-router-dom-udQfSOCw.js";import"./@remix-run-CjG9tKj3.js";import"./firebase-CiybzbB3.js";import"./tslib-BGVaTf34.js";import"./idb-BXWtuYvb.js";import"./motion-dom-C8PdgYBP.js";import"./motion-utils-DBsP9okC.js";const A=s=>{if(!s)return"";const t=typeof s.toDate=="function"?s.toDate():new Date(s);if(isNaN(t))return"";const a=t.getFullYear(),c=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${a}-${c}-${r}`};function Q(){const s=z(),{clientId:t}=w(),{register:a,handleSubmit:c,reset:r,formState:{isSubmitting:p}}=N(),[b,h]=m.useState(""),[g,j]=m.useState(!0);m.useEffect(()=>{(async()=>{try{const i=f(u,"clients",t),x=await y(i);if(x.exists()){const d=x.data();h(d.name),r({...d,scadenza:A(d.scadenza)})}else s("/clients")}catch(i){console.error("Errore nel caricamento del cliente:",i)}finally{j(!1)}})()},[t,r,s]);const v=async l=>{try{const i=f(u,"clients",t);await S(i,{...l,scadenza:l.scadenza?new Date(l.scadenza):null}),s(`/client/${t}`)}catch(i){console.error("Errore nell'aggiornamento del cliente: ",i)}},o="w-full p-2.5 bg-zinc-900/70 border border-white/10 rounded-lg outline-none focus:ring-2 focus:ring-rose-500 transition-all text-slate-200",n="block mb-1.5 text-sm font-medium text-slate-400";return g?e.jsx("div",{className:"text-center p-8 text-slate-400",children:"Caricamento dati cliente..."}):e.jsxs(D.div,{className:"w-full max-w-2xl mx-auto bg-zinc-950/60 backdrop-blur-xl rounded-xl gradient-border p-6 sm:p-8",initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-50",children:"Modifica Cliente"}),e.jsx("p",{className:"text-rose-500 font-semibold",children:b})]}),e.jsxs("button",{onClick:()=>s(`/client/${t}`),className:"flex items-center gap-2 px-3 py-1.5 bg-zinc-800/80 hover:bg-zinc-700/80 rounded-lg text-sm text-slate-300 transition-colors",children:[e.jsx(C,{size:16})," Annulla"]})]}),e.jsxs("form",{onSubmit:c(v),className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:n,children:"Nome e Cognome"}),e.jsx("input",{...a("name",{required:"Il nome è obbligatorio"}),className:o})]}),e.jsxs("div",{children:[e.jsx("label",{className:n,children:"Email"}),e.jsx("input",{type:"email",...a("email",{required:"L'email è obbligatoria"}),className:o})]}),e.jsxs("div",{children:[e.jsx("label",{className:n,children:"Telefono (Opzionale)"}),e.jsx("input",{...a("phone"),className:o})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5 pt-5 border-t border-white/10",children:[e.jsxs("div",{children:[e.jsx("label",{className:n,children:"Stato Cliente"}),e.jsxs("select",{...a("status"),className:o,children:[e.jsx("option",{value:"attivo",children:"Attivo"}),e.jsx("option",{value:"in prova",children:"In Prova"}),e.jsx("option",{value:"sospeso",children:"Sospeso"}),e.jsx("option",{value:"scaduto",children:"Scaduto"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:n,children:"Data Scadenza"}),e.jsx("input",{type:"date",...a("scadenza"),className:o})]})]}),e.jsx("div",{className:"flex justify-end pt-5",children:e.jsxs("button",{type:"submit",disabled:p,className:"flex items-center gap-2 px-6 py-2.5 bg-rose-600 hover:bg-rose-700 text-white font-semibold rounded-lg transition-colors disabled:bg-rose-900 disabled:cursor-not-allowed",children:[e.jsx(E,{size:18})," ",p?"Salvataggio...":"Salva Modifiche"]})})]})]})}export{Q as default};
