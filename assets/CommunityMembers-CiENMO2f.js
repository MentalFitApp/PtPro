import{h as V,r as a,W as N,V as L,ax as y,j as e,aC as $,bW as C,bV as k,M as w,al as B,q as W,bO as O}from"./.pnpm-C04Ba0Xq.js";import{d as S}from"./index-DdCoIfwr.js";const g=[{id:1,name:"Start",minLikes:0,maxLikes:1,color:"slate",borderColor:"border-slate-500"},{id:2,name:"Intermedio",minLikes:2,maxLikes:15,color:"blue",borderColor:"border-blue-500"},{id:3,name:"Pro",minLikes:16,maxLikes:49,color:"purple",borderColor:"border-purple-500"},{id:4,name:"Elite",minLikes:50,maxLikes:99,color:"orange",borderColor:"border-orange-500"},{id:5,name:"MentalFit",minLikes:100,maxLikes:999999,color:"rose",borderColor:"border-rose-500"}],M=i=>g.find(r=>i>=r.minLikes&&i<=r.maxLikes)||g[0],P=({totalLikes:i,size:r="md"})=>{const n=M(i),m={sm:"w-8 h-8 text-xs",md:"w-12 h-12 text-sm",lg:"w-16 h-16 text-base"};return e.jsxs("div",{className:`relative ${m[r]} flex items-center justify-center rounded-full bg-slate-800 border-2 ${n.borderColor} font-bold text-${n.color}-400`,children:[e.jsx("span",{children:n.id}),n.id===5&&e.jsx(O,{className:"absolute -top-1 -right-1 w-4 h-4 text-rose-400"})]})};function H(){const i=V(),[r,n]=a.useState([]),[m,z]=a.useState([]),[E,v]=a.useState(!0),[u,U]=a.useState(""),[p,I]=a.useState("all"),[b,A]=a.useState({totalMembers:0,averageLevel:0,topContributors:0});a.useEffect(()=>{D()},[]),a.useEffect(()=>{R()},[r,u,p]);const D=async()=>{try{const s=N(L(S,"users")),o=await y(s),d=N(L(S,"community_posts")),F=await y(d),x={};F.docs.forEach(l=>{const t=l.data();x[t.authorId]||(x[t.authorId]={posts:0,totalLikes:0}),x[t.authorId].posts+=1,x[t.authorId].totalLikes+=t.likesCount||0});const c=o.docs.map(l=>{var h,f;const t=l.data(),q=x[l.id]||{posts:0,totalLikes:0},j=t.totalLikes||0;return{id:l.id,name:t.name||t.displayName||"Utente",photoURL:t.photoURL||"",totalLikes:j,level:M(j),postsCount:q.posts,joinedAt:((f=(h=t.createdAt)==null?void 0:h.toDate)==null?void 0:f.call(h))||new Date}});c.sort((l,t)=>l.level.id!==t.level.id?t.level.id-l.level.id:t.totalLikes-l.totalLikes),n(c);const Q=c.reduce((l,t)=>l+t.level.id,0)/c.length||0,T=c.filter(l=>l.level.id>=3).length;A({totalMembers:c.length,averageLevel:Q.toFixed(1),topContributors:T}),v(!1)}catch(s){console.error("Error loading members:",s),v(!1)}},R=()=>{let s=[...r];if(u&&(s=s.filter(o=>o.name.toLowerCase().includes(u.toLowerCase()))),p!=="all"){const o=parseInt(p);s=s.filter(d=>d.level.id===o)}z(s)};return E?e.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-rose-500"})}):e.jsxs("div",{className:"min-h-screen bg-slate-900",children:[e.jsx("div",{className:"bg-gradient-to-r from-slate-800 to-slate-900 border-b border-slate-700",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("button",{onClick:()=>i("/community"),className:"p-2 hover:bg-slate-700 rounded-lg transition-colors",children:e.jsx($,{size:24,className:"text-slate-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-100",children:"Membri Community"}),e.jsx("p",{className:"text-slate-400 mt-1",children:"Scopri gli altri membri e i loro livelli"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"bg-slate-800/50 rounded-lg p-4 border border-slate-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-cyan-600/20 rounded-lg",children:e.jsx(C,{size:24,className:"text-cyan-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-slate-100",children:b.totalMembers}),e.jsx("p",{className:"text-sm text-slate-400",children:"Membri Totali"})]})]})}),e.jsx("div",{className:"bg-slate-800/50 rounded-lg p-4 border border-slate-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-600/20 rounded-lg",children:e.jsx(k,{size:24,className:"text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-slate-100",children:b.averageLevel}),e.jsx("p",{className:"text-sm text-slate-400",children:"Livello Medio"})]})]})}),e.jsx("div",{className:"bg-slate-800/50 rounded-lg p-4 border border-slate-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-rose-600/20 rounded-lg",children:e.jsx(w,{size:24,className:"text-rose-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-slate-100",children:b.topContributors}),e.jsx("p",{className:"text-sm text-slate-400",children:"Top Contributors"})]})]})})]})]})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(B,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:20}),e.jsx("input",{type:"text",placeholder:"Cerca membro...",value:u,onChange:s=>U(s.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-slate-800 border border-slate-700 rounded-lg text-slate-200 placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-rose-500"})]}),e.jsxs("select",{value:p,onChange:s=>I(s.target.value),className:"px-4 py-2.5 bg-slate-800 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:ring-2 focus:ring-rose-500",children:[e.jsx("option",{value:"all",children:"Tutti i Livelli"}),g.map(s=>e.jsxs("option",{value:s.id,children:["Livello ",s.id," - ",s.name]},s.id))]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:m.map((s,o)=>{var d;return e.jsx(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:o*.05},className:"bg-slate-800 border border-slate-700 rounded-xl p-4 hover:border-rose-500/50 transition-all cursor-pointer",onClick:()=>{},children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsxs("div",{className:"relative flex-shrink-0",children:[s.photoURL?e.jsx("img",{src:s.photoURL,alt:s.name,className:"w-16 h-16 rounded-full object-cover"}):e.jsx("div",{className:"w-16 h-16 rounded-full bg-slate-700 flex items-center justify-center",children:e.jsx("span",{className:"text-2xl text-slate-400",children:(d=s.name[0])==null?void 0:d.toUpperCase()})}),e.jsx("div",{className:"absolute -bottom-2 -right-2",children:e.jsx(P,{totalLikes:s.totalLikes,size:"sm"})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-100 truncate",children:s.name}),e.jsxs("p",{className:"text-sm text-slate-400 mb-2",children:["Livello ",s.level.id," - ",s.level.name]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(w,{size:12}),e.jsxs("span",{children:[s.postsCount," post"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(k,{size:12}),e.jsxs("span",{children:[s.totalLikes," likes"]})]})]})]})]})},s.id)})}),m.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(C,{size:48,className:"text-slate-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"Nessun membro trovato"})]})]})]})}export{H as default};
